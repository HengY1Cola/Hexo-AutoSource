<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Gin+Fail2ban+Cloudfareå®ç°é˜²çˆ†ç ´æ‰«æ</title>
      <link href="/article/a637161.html"/>
      <url>/article/a637161.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€ï¼š">å‰è¨€ï¼š</h2><p>æœ€è¿‘å—æŸå­¦é•¿åˆºæ¿€ï¼Œæˆæƒçˆ†ç ´ä»–çš„ç½‘ç«™ï¼ŒçŸ­æ—¶é—´å†…å°±è¢«ä»–çš„ç½‘ç«™é˜²ä½äº†ï½</p><p>å¥½æ»´ï½ æœ€è¿‘åˆå¼€å§‹æ£é¼“æœåŠ¡å™¨äº†ï¼Œæˆ‘ä¹Ÿæƒ³æï½ æ‰€ä»¥æˆ‘å°±ç®€å•è¯´ä¸€ä¸‹æˆ‘çš„å®ç°ã€‚</p><div class="note green icon flat"><i class="note-icon fas fa-bullhorn"></i><p>ä»¥ä¸‹æˆ‘ç®€å•è¯´ä¸‹æˆ‘çš„æ€è·¯æ¥<strong>å®ç°é˜²çˆ†ç ´ä¸CCç­‰æ”»å‡»</strong>ï¼šğŸ‘‡</p><ol><li>é€šè¿‡Cloudfareè·å–åˆ°åŸå§‹IP</li><li>Fail2banè¯»å–æ—¥å¿—</li><li>å›è°ƒé€šçŸ¥Cloudfareè¿›è¡Œé˜²å¾¡</li></ol><p>è¦ç”¨åˆ°çš„æœ‰ï¼š<code>Ginæ¡†æ¶</code>ä¸<code> nginxæœåŠ¡å™¨</code>ä¸<code>cloudfareå…è´¹ç‰ˆ</code>ä¸<code>Fail2ban</code>å·¥å…·</p></div><h2 id="è·å–åˆ°åŸå§‹IP">è·å–åˆ°åŸå§‹IP</h2><p>å…¶å®æœ‰ä¸ªæ€è·¯æ˜¯å·²ç»<strong>æœ‰æ¨¡å—ä¸nginxè¿›è¡ŒäºŒè¿›åˆ¶ç¼–è¯‘å</strong></p><p><code>accessæ—¥å¿—</code>å°±å·²ç»æ˜¯åŸå§‹IPäº†ï¼Œä½†æ˜¯åˆšå¥½æˆ‘æ˜¯åç«¯æ¥å£æ€¼çš„CF</p><p>é‚£ä¹ˆæˆ‘ä¸ºä»€ä¹ˆä¸å†™ä¸ªä¸­é—´ä»¶ç„¶åæ¨¡æ‹ŸNginxæ—¥å¿—ç»“æ„ï¼ŒåŒæ ·å®ç°æ—¥å¿—ã€‚</p><p>è¯´å¹²å°±å¹²ï¼Œä¸‹é¢ç›´æ¥è´´ä»£ç ï¼š ï¼ˆ<strong>å®ç°äº†é«˜å¹¶å‘ä¸‹çš„è¯»å†™</strong>ï¼‰</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> middleware</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;GoBackEnd/common&quot;</span> <span class="comment">// è¿™é‡Œè‡ªå·±æ”¹ä¸‹</span></span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line"><span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line"><span class="string">&quot;io&quot;</span></span><br><span class="line"><span class="string">&quot;io/ioutil&quot;</span></span><br><span class="line"><span class="string">&quot;os&quot;</span></span><br><span class="line"><span class="string">&quot;sync&quot;</span></span><br><span class="line"><span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// NginxLogMiddleware ä¸ºè®°å½•CFåŸå§‹IP</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NginxLogMiddleware</span><span class="params">()</span> <span class="title">gin</span>.<span class="title">HandlerFunc</span></span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line"><span class="keyword">var</span> bodySize <span class="keyword">int</span></span><br><span class="line"><span class="comment">// todo æ‹¿åˆ°ç›®å½•è·¯å¾„</span></span><br><span class="line">nginxPath := common.Path(<span class="string">&quot;access.log&quot;</span>) <span class="comment">// è‡ªå·±å†™ä¸ªå‡½æ•°è·å–å“ˆï½</span></span><br><span class="line"><span class="comment">// todo æ‹¿åˆ°å°†è¦åˆæˆçš„ä¿¡æ¯</span></span><br><span class="line">ip := c.ClientIP()</span><br><span class="line">utcTimeStr := time.Now().Format(<span class="string">&quot;02/Jan/2006:15:04:05&quot;</span>)</span><br><span class="line">url := c.Request.URL</span><br><span class="line">method := c.Request.Method</span><br><span class="line">status := c.Writer.Status()</span><br><span class="line">body, err := ioutil.ReadAll(c.Request.Body)</span><br><span class="line">http := c.Request.Proto</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">bodySize = <span class="number">-1</span></span><br><span class="line">&#125;</span><br><span class="line">bodySize = <span class="built_in">len</span>(body)</span><br><span class="line">header := c.Request.UserAgent()</span><br><span class="line"><span class="comment">// todo å†™å…¥æ ‡å‡†æ ¼å¼</span></span><br><span class="line">res := fmt.Sprintf(<span class="string">&quot;%v - - [%v +8000] \&quot;%v %v %v\&quot; %v %v \&quot;-\&quot; \&quot;%v\&quot;&quot;</span>, ip, utcTimeStr, method, url, http, status, bodySize, header) <span class="comment">// å› ä¸ºæ˜¯ä¸œå…«åŒºæˆ‘å°±å†™æ­»äº†</span></span><br><span class="line"><span class="comment">// todo å†™å…¥æ–‡ä»¶</span></span><br><span class="line">file, _ := os.OpenFile(nginxPath, os.O_WRONLY|os.O_APPEND, <span class="number">0666</span>)</span><br><span class="line"><span class="keyword">defer</span> file.Close()</span><br><span class="line">wr := &amp;SyncWriter&#123;sync.Mutex&#123;&#125;, file&#125; <span class="comment">// æ·»åŠ ä¸Šé”</span></span><br><span class="line">wg := sync.WaitGroup&#123;&#125;</span><br><span class="line">wg.Add(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">(content <span class="keyword">string</span>)</span></span> &#123; <span class="comment">// forkå­åç¨‹å»å†™</span></span><br><span class="line">fmt.Fprintln(wr, content)</span><br><span class="line">wg.Done()</span><br><span class="line">&#125;(res)</span><br><span class="line">wg.Wait()</span><br><span class="line">c.Next()</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> SyncWriter <span class="keyword">struct</span> &#123;</span><br><span class="line">m      sync.Mutex</span><br><span class="line">Writer io.Writer</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(w *SyncWriter)</span> <span class="title">Write</span><span class="params">(b []<span class="keyword">byte</span>)</span> <span class="params">(n <span class="keyword">int</span>, err error)</span></span> &#123;</span><br><span class="line">w.m.Lock()</span><br><span class="line"><span class="keyword">defer</span> w.m.Unlock()</span><br><span class="line"><span class="keyword">return</span> w.Writer.Write(b)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><img src="/img/mics/image-20220225101411647.webp" alt="" style="zoom:67%;" /><p>ç„¶åç›´æ¥æ”¾åˆ°é»˜è®¤è·¯ç”±é‡Œé¢ï¼Œæ‰€æœ‰æµé‡éƒ½è¦èµ°ï½</p><img src="/img/mics/image-20220225101614873.webp" alt="" style="zoom:67%;" /><img src="/img/mics/image-20220225101648740.webp" alt="" style="zoom:67%;" /><h2 id="Fail2bançš„å®‰è£…ä¸è®¾ç½®">Fail2bançš„å®‰è£…ä¸è®¾ç½®</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt install fail2ban</span><br><span class="line">$ systemctl stop fail2ban</span><br><span class="line">$ <span class="built_in">cd</span> /etc/fail2ban</span><br></pre></td></tr></table></figure><p>è¿™é‡Œè¯´ä¸‹Fail2bançš„åŠ è½½æ–‡ä»¶è§„åˆ™ï¼šä¾æ¬¡è¿›è¡Œ</p><ul><li><code>/etc/fail2ban/jail.conf</code></li><li><code>/etc/fail2ban/jail.d/*.conf</code></li><li><code>/etc/fail2ban/jail.local</code></li><li><code>/etc/fail2ban/jail.d/*.local</code></li></ul><p>æˆ‘ä»¬éœ€è¦åšçš„å°±æ˜¯: åˆ†åˆ«å†™å…¥åŒ¹é…è§„åˆ™ä¸æ‹‰é»‘è®¾ç½®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> /etc/fail2ban/jail.d</span><br><span class="line">$ vim nginxcc.conf <span class="comment"># å¼€å§‹å†™å…¥</span></span><br><span class="line"><span class="comment">##############################</span></span><br><span class="line">[nginxcc]                                                                                                             </span><br><span class="line">enabled = <span class="literal">true</span>                                                                                                        </span><br><span class="line">port = http,https  <span class="comment"># ç¦æ­¢80 443                                                                                                   </span></span><br><span class="line">filter = nginxcc      <span class="comment"># ä½¿ç”¨çš„æ˜¯å“ªä¸ª                                                                                                </span></span><br><span class="line">logpath = /home/ubuntu/HengY1Service/access.log <span class="comment"># æ¡†æ¶é‡Œé¢é…ç½®çš„æ—¥å¿—                                                       </span></span><br><span class="line">bantime = 1200    <span class="comment"># è¢«ç¦æ­¢å¤šä¹…                                                                                   </span></span><br><span class="line">findtime = 30     <span class="comment"># æ‰«æå¤šé•¿æ—¶é—´çš„                                                                                   </span></span><br><span class="line">maxretry = 10     <span class="comment"># å•ä½æ—¶é—´å†…æ¬¡æ•°                                                                                      </span></span><br><span class="line">action = %(action_mwl)s   <span class="comment"># è°ƒç”¨cloudfareå†…ç½®è„šæœ¬                                                                                      </span></span><br><span class="line">         custom-cloudflare   <span class="comment"># custom-cloudflareæ˜¯åé¢è¦è‡ªå·±å†™çš„</span></span><br><span class="line">         </span><br><span class="line">:wq</span><br><span class="line"><span class="comment">##############################</span></span><br><span class="line">$ <span class="built_in">cd</span> /etc/fail2ban/filter.d</span><br><span class="line">$ vim nginxcc.conf</span><br><span class="line"><span class="comment">##############################</span></span><br><span class="line">[Definition]</span><br><span class="line">failregex =(?i)^&lt;HOST&gt; .* <span class="string">&quot;(GET|POST|HEAD).*HTTP.*&quot;</span> (404|503) .*$</span><br><span class="line">ignoreregex =.*(robots.txt|favicon.ico|jpg|png|webp|js|css)</span><br><span class="line"></span><br><span class="line">:wq</span><br><span class="line"><span class="comment">##############################</span></span><br></pre></td></tr></table></figure><p>ç„¶åéªŒè¯ä¸‹è‡ªå·±å†™å¯¹æ²¡ï¼šaccess.logæœ€å¥½æœ‰ç‚¹ä¸œè¥¿</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ fail2ban-regex /home/ubuntu/HengY1Service/access.log /etc/fail2ban/filter.d/nginxcc.conf</span><br><span class="line">$ systemctl restart fail2ban</span><br><span class="line">$ fail2ban-client status <span class="comment"># çœ‹ä¸‹nginxCCå¼€å¯æ²¡</span></span><br><span class="line">$ fail2ban-client status nginxcc</span><br><span class="line">$ fail2ban-client <span class="built_in">set</span> nginxcc unbanip 1.1.1.1 <span class="comment"># è§£å°ä½ è¦çš„IP</span></span><br></pre></td></tr></table></figure><img src="/img/mics/image-20220225102817422.webp" alt="" style="zoom:80%;" /><h2 id="é€šçŸ¥Cloudfareè¿›è¡Œé˜²å¾¡">é€šçŸ¥Cloudfareè¿›è¡Œé˜²å¾¡</h2><p>åˆ°è¿™é‡Œçš„è¯è¿˜æ˜¯ä¸è¡Œçš„ï¼Œå› ä¸ºä½ è™½ç„¶æ‹¿åˆ°äº†æºIPï¼Œä½†æ˜¯æ˜¯è¿‡CDNè¿‡æ¥çš„IPä½ æ²¡æœ‰å°</p><p>ä½†æ˜¯Fail2banå·²ç»è€ƒè™‘åˆ°äº†ï¼Œæä¾›äº†è„šæœ¬ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆè¦è®¾ç½®<code>action</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> /etc/fail2ban/action.d</span><br><span class="line">$ cp cloudflare.conf custom-cloudflare.conf</span><br><span class="line">$ vim custom-cloudflare.conf <span class="comment"># ç¿»çœ‹åˆ°æœ€ä¸‹é¢</span></span><br><span class="line"><span class="comment"># å¡«å†™ cftoken ä¸ cfuser cfuserå°±æ˜¯ä½ æ³¨å†Œçš„é‚®ä»¶ cftoken æ˜¯GlobalToken</span></span><br><span class="line">$ systemctl restart fail2ban</span><br></pre></td></tr></table></figure><img src="/img/mics/image-20220225103713641.webp" alt="" style="zoom:67%;" /><p>ç„¶åå¯ä»¥è‡ªå·±è¯•è¯•æ•ˆæœäº†ï½  ï¼ˆæˆ‘çš„æ˜¯ï¼šapi.hengy1.topï¼‰ å¯ä»¥æ¥è¯•è¯•æ•ˆæœ</p><img src="/img/mics/image-20220225103819706.webp" alt="" style="zoom:67%;" /><img src="/img/mics/image-20220225104523559.webp" alt="" style="zoom:67%;" /><h2 id="æ€»ç»“ï¼š">æ€»ç»“ï¼š</h2><p>é€¼é€¼ä¸¤å¥ï¼š</p><ol><li>æ„é€ æ—¥å¿—å‚æ•°ä¸é«˜å¹¶å‘è¯»å†™è¦æ³¨æ„</li><li>æ­£åˆ™åŒ¹é…å¿…é¡»æœ‰&lt;HOST&gt;ï¼Œæ­£åˆ™æµ‹è¯•https://regex101.com/</li><li>ä¸€å®šè¦CFæ¥é˜²å¾¡ï¼Œæ€è·¯å¾—å…ˆä¸²é€š</li><li>Fail2banæœ‰ç‚¹ååº”å»¶è¿Ÿ</li></ol>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Pythonæµ…è°ˆå¤šçº¿ç¨‹</title>
      <link href="/article/6e07425f.html"/>
      <url>/article/6e07425f.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€ï¼š-5">å‰è¨€ï¼š</h2><p>åªè¦ç©è¿‡<strong>çˆ¬è™«</strong>çš„ï¼Œå°±çŸ¥é“çº¿ç¨‹çš„å¿…è¦æ€§ã€‚ä½†æ˜¯æˆ‘å­¦ä¹ çº¿ç¨‹çš„è·¯å­æ¯”è¾ƒé‡ï½</p><p>æ‰€ä»¥å­¦çš„ä¸æ˜¯é‚£ä¹ˆ<strong>ç³»ç»Ÿ</strong>ï¼Œæœ€è¿‘æ²¡äº‹æ¥çœ‹çœ‹æŠŠé‡è¦çš„éƒ¨åˆ†éƒ½æ¥æŒæ¡ä¸‹ã€‚</p><p>ç„¶åä¹Ÿå°±â€œ<strong>ç®€ç®€å•å•</strong>â€æ°´ä¸€ç¯‡é‡ç‚¹éƒ¨åˆ†ï¼ˆä¸»è¦æˆ‘æ€•åé¢å¿˜è®°äº†QAQï¼‰</p><h2 id="å¼•å…¥ï¼š">å¼•å…¥ï¼š</h2><p><code>ä»€ä¹ˆæ˜¯GIL?</code>  åœ¨å®ç°Pythonè§£æå™¨(CPython)æ—¶æ‰€å¼•å…¥çš„ä¸€ä¸ªæ¦‚å¿µï¼ŒGILè¿™æŠŠè¶…çº§å¤§é”ï¼Œæ˜¯åŠ åœ¨å…¨å±€ä¸Šçš„</p><p>åŒä¸€ä¸ªæ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨ä¸€ä¸ªcpuä¸Šæ‰§è¡Œå­—èŠ‚ç , æ— æ³•å°†å¤šä¸ªçº¿ç¨‹æ˜ å°„åˆ°å¤šä¸ªcpuä¸Šæ‰§è¡Œ</p><p>ä½†æ˜¯GILä¼šä¸»åŠ¨é‡Šæ”¾ï¼š1. æ ¹æ®æ‰§è¡Œçš„å­—èŠ‚ç è¡Œæ•°ä»¥åŠæ—¶é—´ç‰‡é‡Šæ”¾ï¼›2. åœ¨é‡åˆ°ioçš„æ“ä½œæ—¶å€™ä¸»åŠ¨é‡Šæ”¾</p><blockquote><p><em>In CPython, the global interpreter lock, or GIL, is a mutex that prevents multiple native threads from executing Python bytecodes at once. This lock is necessary mainly because CPythonâ€™s memory management is not thread-safe. (However, since the GIL exists, other features have grown to depend on the guarantees that it enforces.)</em></p></blockquote><p>çœ‹ä¸ªä¾‹å­ï¼šè¿™ä¸ªæ€ä¹ˆéƒ½ä¸ä¼šå®ç°ä¸º0ã€‚å…·ä½“å¦‚ä½•è§£å†³çœ‹åé¢</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line">total = <span class="number">0</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>():</span></span><br><span class="line">    <span class="keyword">global</span> total</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000000</span>):</span><br><span class="line">        total += <span class="number">1</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">desc</span>():</span></span><br><span class="line">    <span class="keyword">global</span> total</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000000</span>):</span><br><span class="line">        total -= <span class="number">1</span></span><br><span class="line"></span><br><span class="line">thread1 = threading.Thread(target=add)</span><br><span class="line">thread2 = threading.Thread(target=desc)</span><br><span class="line">thread1.start()</span><br><span class="line">thread2.start()</span><br><span class="line"><span class="built_in">print</span>(total)</span><br></pre></td></tr></table></figure><h2 id="Threadçš„åŸºç¡€">Threadçš„åŸºç¡€</h2><p>è¿™é‡Œé¢çš„å‡ ä¸ªç‚¹ï¼š</p><ol><li>é™¤äº†æœ€åŸºç¡€çš„å†™æ³•ï¼Œè¿˜å¯ä»¥ç»§æ‰¿<code>threading.Thread</code>é‡æ„æ–¹æ³•ï¼šä¾‹å¦‚Runæ–¹æ³•ï¼Œå°†é€»è¾‘å†™åœ¨é‡Œé¢</li><li>ä½¿ç”¨å¤šçº¿ç¨‹çš„åŸºæœ¬APIçš„æŒæ¡ï¼Œè¿™é‡Œå°±ä¸è´´æ¯ä¸ªAPIä»€ä¹ˆæ„æ€ã€‚ç¿»ç¿»æ–‡æ¡£å°±å¥½å•¦</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GetDetailHtml</span>(<span class="params">threading.Thread</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        <span class="built_in">super</span>().__init__(name=name)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;get detail html started&quot;</span>)</span><br><span class="line">        time.sleep(<span class="number">2</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;get detail html end&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GetDetailUrl</span>(<span class="params">threading.Thread</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, name</span>):</span></span><br><span class="line">        <span class="built_in">super</span>().__init__(name=name)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;get detail url started&quot;</span>)</span><br><span class="line">        time.sleep(<span class="number">4</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;get detail url end&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    thread1 = GetDetailHtml(<span class="string">&quot;get_detail_html&quot;</span>)</span><br><span class="line">    thread2 = GetDetailUrl(<span class="string">&quot;get_detail_url&quot;</span>)</span><br><span class="line">    start_time = time.time()</span><br><span class="line">    thread1.start()</span><br><span class="line">    thread2.start()</span><br><span class="line">    thread1.join()</span><br><span class="line">    thread2.join()</span><br><span class="line">    <span class="comment"># å½“ä¸»çº¿ç¨‹é€€å‡ºçš„æ—¶å€™ï¼Œ å­çº¿ç¨‹killæ‰</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;last time: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(time.time() - start_time))</span><br></pre></td></tr></table></figure><h2 id="å¤šä¸ªçº¿ç¨‹ä¹‹é—´çš„å˜é‡">å¤šä¸ªçº¿ç¨‹ä¹‹é—´çš„å˜é‡</h2><blockquote><p>ä¼šäº§ç”Ÿéœ€æ±‚å°±æ˜¯ï¼Œå¤§å®¶åŒæ—¶æ“ä½œä¸€ä¸ªå˜é‡ã€‚è¿™ä¸ªå˜é‡å¯ä»¥ç©¿æ¢­åœ¨å„ä¸ªçº¿ç¨‹ä¹‹é—´</p></blockquote><p>å½“ç„¶è¿™é‡Œæœ‰ä¸ªå¾ˆå¤§çš„BUGï¼Œæˆ‘å½“æ—¶å°±å¾ˆç–‘æƒ‘ğŸ¤”.</p><p>å°±æ˜¯åŠ å…¥ç°åœ¨æœ‰2ä¸ªæ–‡ä»¶ï¼Œå…¶ä¸­ä¸€ä¸ªæ˜¯<code>utils.py</code>æ–‡ä»¶ä¸­çš„ä¸€ä¸ªå˜é‡test</p><p>å¦‚æœä½ æ˜¯ <code>import utils</code>ç„¶åä½¿ç”¨çš„æ˜¯<code>utils.test</code>è¿™ä¸ªçš„è¯æ˜¯å¯ä»¥çš„</p><p>ä½†æ˜¯ä½ æ˜¯<code>from utils import test</code>ä½¿ç”¨<code>test</code>çš„è¯ï¼Œä¸ç®¡ä½ æ€ä¹ˆæ”¹å˜ï¼Œä»–å°±ç®—ä¸€ä¸ªå®šå€¼äº†</p><p>æˆ‘å½“æ—¶å°±å¾ˆç–‘æƒ‘ä¸ºä»€ä¹ˆ<code>flag</code>å˜é‡æ— æ³•æ˜¯<code>while</code>é€€å‡ºï¼Œç°åœ¨çŸ¥é“é¿å‘äº†ã€‚</p><p>è¯´äº†è¿™ä¹ˆå¤šï¼Œå…¶å®å°±æ˜¯2ä¸ªæ–¹å¼</p><ol><li>ä½¿ç”¨<code>gloablå…¨å±€å˜é‡</code></li><li>ä½¿ç”¨<code>queue</code>ï¼ˆæ¨èï¼‰,å…·ä½“çš„APIç¿»ç¿»æ–‡æ¡£/æºç éƒ½è¡Œï¼Œä¸å¤šèµ˜è¿°</li></ol><h2 id="èŠ±é‡Œèƒ¡å“¨çš„é”">èŠ±é‡Œèƒ¡å“¨çš„é”</h2><h3 id="Lockã€RLock">Lockã€RLock</h3><blockquote><p>ä½¿ç”¨é”å°±å¾ˆå¥½è§£å†³äº†ä¸Šé¢çš„é—®é¢˜ï¼Œå°±å¯ä»¥å¾—åˆ°ç­”æ¡ˆä¸º0</p></blockquote><p><code>Lock</code>ä¸<code>RLock</code>çš„å”¯ä¸€åŒºåˆ«å°±æ˜¯æœ‰æ•ˆå‡å°‘æ­»é”çš„å‘ç”Ÿ</p><p>ä»–ä»¬éƒ½æœ‰å…±åŒçš„<code>.acquire()</code>ä¸<code>.release()</code>è¿™ä¸ªä¸¤ä¸ªæ–¹å¼</p><p>ä½†æ˜¯<code>lock.acquire()</code>åœ¨ä¸ç»æ„ä¹‹é—´ä½¿ç”¨äº†2æ¬¡ï¼Œåˆ™ä¼šäº’ç›¸ç­‰å¾…å‘ç”Ÿæ­»é”ï¼Œéƒ½ä¸ä¼šåŠ¨äº†</p><p>è€Œ<code>RLock.acquire()</code>å¯ä»¥ä½¿ç”¨å¤šæ¬¡å¹¶ä¸”å¤šæ¬¡é‡Šæ”¾ï¼Œå‡å°‘æ­»é”ç«äº‰çš„æƒ…å†µã€‚</p><h3 id="condition-ä½¿ç”¨">condition ä½¿ç”¨</h3><blockquote><p>è¿™ä¸ªä½¿ç”¨çš„æƒ…å†µæ˜¯ï¼šå‡è®¾ç°åœ¨æœ‰2ä¸ªçº¿ç¨‹ï¼Œçº¿ç¨‹aæ‰§è¡Œå®Œæ¯•ä¹‹åå‘¢çº¿ç¨‹bå†æ‰§è¡Œï¼Œçº¿ç¨‹bæ‰§è¡Œå®Œæ¯•ä¹‹åå‘¢å†æ‰§è¡Œçº¿ç¨‹a</p><p>äº’ç›¸é€šçŸ¥å¯¹æ–¹ï¼Œå¤šçº¿æ‰§è¡Œï¼Œä½†å¯ä»¥å®ç°äº¤æ›¿</p></blockquote><p>ç‰¹åˆ«æ³¨æ„ï¼š å¯åŠ¨çš„é¡ºåºå¾ˆé‡è¦â€¼ï¸</p><p>æŒæ¡2ä¸ªAPIï¼š <code>.notify()</code>ä¸<code>.wait()</code>é¡¾åæ€ä¹‰ï¼šä¸€ä¸ªé€šçŸ¥ä¸€ä¸ªç­‰å¾…</p><p><code>é€šçŸ¥</code>å°±æ˜¯é€šçŸ¥ç­‰å¾…çš„å¯¹æ–¹ä½ å¯ä»¥å¼€å§‹æ‰§è¡Œäº†ï¼Œ<code>ç­‰å¾…</code>å°±æ˜¯ç­‰å¾…å¯¹æ–¹æ¥é€šçŸ¥æˆ‘</p><h3 id="Semaphore-ä½¿ç”¨">Semaphore ä½¿ç”¨</h3><blockquote><p>è¿™ä¸ªä½¿ç”¨çš„æƒ…å†µå°±æ˜¯ï¼šforå¾ªç¯çš„è¯ä¸€ä¸‹å­å¯åŠ¨20ä¸ªå¾ªç¯ï¼Œè®¾å¤‡é¡¶ä¸ä½ã€‚</p><p>ä½¿ç”¨Semaphoreå°±å¯ä»¥å†³å®šä¸€æ¬¡æ€§å¼€å¯å¤šå°‘ä¸ª</p></blockquote><p>è¯¾ä¸Šè¿™ä¸ªä¾‹å­æ¯”è¾ƒç»å…¸ï¼š</p><p>æ³¨æ„<code>.release()</code>ä¸<code>sem.acquire()</code>çš„ä½ç½®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HtmlSpider</span>(<span class="params">threading.Thread</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, url, sem</span>):</span></span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        self.url = url</span><br><span class="line">        self.sem = sem</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span>(<span class="params">self</span>):</span></span><br><span class="line">        time.sleep(<span class="number">2</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;got html text success&quot;</span>)</span><br><span class="line">        self.sem.release()</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UrlProducer</span>(<span class="params">threading.Thread</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, sem</span>):</span></span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        self.sem = sem</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">            self.sem.acquire()</span><br><span class="line">            html_thread = HtmlSpider(<span class="string">&quot;https://baidu.com/&#123;&#125;&quot;</span>.<span class="built_in">format</span>(i), self.sem)</span><br><span class="line">            html_thread.start()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    sem = threading.Semaphore(<span class="number">3</span>)</span><br><span class="line">    url_producer = UrlProducer(sem)</span><br><span class="line">    url_producer.start()</span><br></pre></td></tr></table></figure><h2 id="çº¿ç¨‹æ± çš„ä½¿ç”¨">çº¿ç¨‹æ± çš„ä½¿ç”¨</h2><blockquote><p>çº¿ç¨‹æ± ç›¸æ¯”è¾ƒäºå¤šçº¿ç¨‹ï¼Œæ›´åŠ å…·æœ‰æ™ºèƒ½åŒ–ï¼Œè¯´ç™½äº†å°±æ˜¯æ›´åŠ çœå¿ƒ</p></blockquote><p>ä¸ºä»€ä¹ˆè¦çº¿ç¨‹æ±  ?</p><ol><li>ä¸»çº¿ç¨‹ä¸­å¯ä»¥è·å–æŸä¸€ä¸ªçº¿ç¨‹çš„çŠ¶æ€æˆ–è€…æŸä¸€ä¸ªä»»åŠ¡çš„çŠ¶æ€ï¼Œä»¥åŠè¿”å›å€¼</li><li>å½“ä¸€ä¸ªçº¿ç¨‹å®Œæˆçš„æ—¶å€™æˆ‘ä»¬ä¸»çº¿ç¨‹èƒ½ç«‹å³çŸ¥é“</li><li><code>from concurrent.futures import Future</code>çš„futureså’Œå¤šè¿›ç¨‹ç¼–ç æ¥å£ä¸€è‡´</li></ol><p>æœ€å¥½è‡ªå·±æ”¹ä¸€ä¸‹ä½¿ç”¨withä¸Šä¸‹æ–‡<code>with ThreadPoolExecutor(3) as executor:</code>ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸€ä¸ªä¸ªæäº¤</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> concurrent.futures <span class="keyword">import</span> ThreadPoolExecutor</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_html</span>(<span class="params">times</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;start sleep &#123;&#125;&quot;</span>.<span class="built_in">format</span>(times))</span><br><span class="line">    time.sleep(times)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;get page &#123;&#125; success&quot;</span>.<span class="built_in">format</span>(times))</span><br><span class="line">    <span class="keyword">return</span> times</span><br><span class="line"></span><br><span class="line">executor = ThreadPoolExecutor(max_workers=<span class="number">1</span>)</span><br><span class="line">task = executor.submit(get_html, <span class="number">3</span>)  <span class="comment"># submit æ˜¯ç«‹å³è¿”å›</span></span><br><span class="line">task2 = executor.submit(get_html, <span class="number">2</span>)  <span class="comment"># submit æ˜¯ç«‹å³è¿”å›</span></span><br><span class="line"><span class="built_in">print</span>(task.done())  <span class="comment"># æ‰§è¡Œå®Œæˆæ²¡</span></span><br><span class="line"><span class="built_in">print</span>(task2.cancel())  <span class="comment"># å› ä¸ºæ€»çš„çº¿ç¨‹ä¸º1 task2æ²¡æœ‰æ‰§è¡Œ æ‰€ä»¥å¯ä»¥å–æ¶ˆ</span></span><br><span class="line">time.sleep(<span class="number">4</span>)</span><br><span class="line"><span class="built_in">print</span>(task.done())</span><br><span class="line"><span class="built_in">print</span>(task.result())</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰¹é‡æäº¤</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> concurrent.futures <span class="keyword">import</span> ThreadPoolExecutor, as_completed, wait</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_html</span>(<span class="params">times</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;start sleep &#123;&#125;&quot;</span>.<span class="built_in">format</span>(times))</span><br><span class="line">    time.sleep(times)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;get page &#123;&#125; success&quot;</span>.<span class="built_in">format</span>(times))</span><br><span class="line">    <span class="keyword">return</span> times</span><br><span class="line"></span><br><span class="line">oneList = [<span class="number">2</span>, <span class="number">4</span>, <span class="number">3</span>]</span><br><span class="line">executor = ThreadPoolExecutor(max_workers=<span class="number">2</span>)</span><br><span class="line"><span class="comment"># allTask = [executor.submit(get_html, each) for each in oneList]</span></span><br><span class="line"><span class="comment"># wait(allTask)  # æ‰€æœ‰çº¿ç¨‹æ‰§è¡Œå®Œæ¯•å†èµ°</span></span><br><span class="line"><span class="comment"># # ä¸€æ—¦æœ‰å®Œæˆçš„äº†å°±èƒ½è·å–åˆ°(è°å…ˆå®Œæˆ)</span></span><br><span class="line"><span class="comment"># for future in as_completed(allTask):  # è·å–åˆ°å·²ç»å®Œæˆçš„äº†</span></span><br><span class="line"><span class="comment">#     data = future.result()</span></span><br><span class="line"><span class="comment">#     print(&quot;! get &#123;&#125;&quot;.format(str(data)))</span></span><br><span class="line"><span class="comment"># æ¢ä¸ªå†™æ³• (ä½†æ˜¯ä¼šæŒ‰ç…§oneListçš„é¡ºåºï¼‰</span></span><br><span class="line"><span class="keyword">for</span> data <span class="keyword">in</span> executor.<span class="built_in">map</span>(get_html, oneList):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;! get &#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">str</span>(data)))</span><br></pre></td></tr></table></figure><h2 id="å¤šè¿›ç¨‹ç¼–ç¨‹">å¤šè¿›ç¨‹ç¼–ç¨‹</h2><blockquote><ul><li><p>è€—cpuçš„æ“ä½œï¼Œç”¨å¤šè¿›ç¨‹ç¼–ç¨‹ï¼Œ</p></li><li><p>å¯¹äºioæ“ä½œæ¥è¯´ï¼Œ ä½¿ç”¨å¤šçº¿ç¨‹ç¼–ç¨‹</p></li><li><p>è¿›ç¨‹åˆ‡æ¢ä»£ä»·è¦é«˜äºçº¿ç¨‹</p></li></ul></blockquote><p>ä¸€èˆ¬éƒ½æ˜¯ç”¨å¤šçº¿ç¨‹ï¼Œå¤šè¿›ç¨‹ä¸å¤šçº¿ç¨‹çš„åº“ä½¿ç”¨å·®ä¸å¤šï½</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> concurrent.futures <span class="keyword">import</span> ProcessPoolExecutor, as_completed</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">random_sleep</span>(<span class="params">n</span>):</span></span><br><span class="line">    time.sleep(n)</span><br><span class="line">    <span class="keyword">return</span> n</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">with</span> ProcessPoolExecutor(<span class="number">3</span>) <span class="keyword">as</span> executor:</span><br><span class="line">        all_task = [executor.submit(random_sleep, (num)) <span class="keyword">for</span> num <span class="keyword">in</span> [<span class="number">2</span>] * <span class="number">30</span>]</span><br><span class="line">        start_time = time.time()</span><br><span class="line">        <span class="keyword">for</span> future <span class="keyword">in</span> as_completed(all_task):</span><br><span class="line">            data = future.result()</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;exe result: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(data))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;last time is: &#123;&#125;&quot;</span>.<span class="built_in">format</span>(time.time() - start_time))</span><br></pre></td></tr></table></figure><hr><ol><li>å…±äº«å…¨å±€å˜é‡åœ¨å¤šè¿›ç¨‹ä¸­æ˜¯ä¸ä½¿ç”¨çš„</li><li>multiprocessingä¸­çš„queueä¸èƒ½ç”¨äºpoolè¿›ç¨‹æ± </li><li>poolä¸­çš„è¿›ç¨‹é—´é€šä¿¡éœ€è¦ä½¿ç”¨managerä¸­çš„queue</li><li>ä½¿ç”¨Pipeé€šä¿¡ï¼Œä½†æ˜¯åªèƒ½é€‚ç”¨äº2ä¸ªè¿›ç¨‹</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> queue <span class="keyword">import</span> Queue <span class="comment"># å¤šè¿›ç¨‹ä¸èƒ½ç”¨</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Queue <span class="comment"># æ­£å¸¸çš„å¤šè¿›ç¨‹ä½¿ç”¨</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Manager <span class="comment"># poolé‡Œé¢ä½¿ç”¨</span></span><br><span class="line">Manager().Queue() </span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Pipe</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Goå®ç°åŸºç¡€å¯†ç åŠ å¯†è§£å¯†</title>
      <link href="/article/9f3d09de.html"/>
      <url>/article/9f3d09de.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€ï¼š-2">å‰è¨€ï¼š</h2><p>è‡ªå·±æ²¡äº‹æŸ¥è¯¢èµ„æ–™å¼„äº†ä¸ªGoåŠ å¯†è§£å¯†çš„æ–‡ä»¶ï¼Œæ–¹ä¾¿åœ¨æ—¥å¸¸ä¸­ç›´æ¥è°ƒç”¨</p><div class="note green icon flat"><i class="note-icon fas fa-bullhorn"></i><p>å†™è¿™ä¸ªæ˜¯ä¸ºäº†æ–¹ä¾¿å¼€æ–°é¡¹ç›®æ‡’å¾—å»æ‰¾ç°æˆçš„ä»£ç ï¼Œç›´æ¥å¤åˆ¶è¿‡å»åšä»“åº“æ–‡ä»¶<br>å…·ä½“æ€ä¹ˆç”¨æˆ‘ä¹Ÿå†™äº†è°ƒç”¨ä¾‹å­ï¼Œå³ä½¿ä¸æ‡‚åŠ å¯†è§„åˆ™è‡³å°‘ä¼šç”¨å˜›ï½<br>è‡³äºå…·ä½“çš„åŠ å¯†è§„åˆ™ï¼Œå»ºè®®ç½‘ä¸Š(Bç«™)æœæœã€Šç”µå­ç§‘æŠ€å¤§å­¦å¯†ç å­¦ã€‹æ¯”è¾ƒåŸºç¡€è¯¦ç»†</p></div><h2 id="æ–‡ä»¶">æ–‡ä»¶</h2><p>åŒ…å« :</p><ul><li>AES-CBC</li><li>Base64/58</li><li>å“ˆå¸Œ</li><li>DES/3DES</li><li>RSA</li><li>æ•°å­—ç­¾å</li></ul><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> public</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;bytes&quot;</span></span><br><span class="line"><span class="string">&quot;crypto&quot;</span></span><br><span class="line"><span class="string">&quot;crypto/aes&quot;</span></span><br><span class="line"><span class="string">&quot;crypto/cipher&quot;</span></span><br><span class="line"><span class="string">&quot;crypto/des&quot;</span></span><br><span class="line"><span class="string">&quot;crypto/md5&quot;</span></span><br><span class="line"><span class="string">&quot;crypto/rand&quot;</span></span><br><span class="line"><span class="string">&quot;crypto/rsa&quot;</span></span><br><span class="line"><span class="string">&quot;crypto/sha256&quot;</span></span><br><span class="line"><span class="string">&quot;crypto/x509&quot;</span></span><br><span class="line"><span class="string">&quot;encoding/base64&quot;</span></span><br><span class="line"><span class="string">&quot;encoding/hex&quot;</span></span><br><span class="line"><span class="string">&quot;encoding/pem&quot;</span></span><br><span class="line"><span class="string">&quot;errors&quot;</span></span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line"><span class="string">&quot;golang.org/x/crypto/md4&quot;</span></span><br><span class="line"><span class="string">&quot;math/big&quot;</span></span><br><span class="line"><span class="string">&quot;os&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">//  ----------------------- AES-CBC -----------------------</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">CBCEncrypt</span><span class="params">(text []<span class="keyword">byte</span>, key []<span class="keyword">byte</span>, iv []<span class="keyword">byte</span>)</span> []<span class="title">byte</span></span> &#123;</span><br><span class="line">block, err := aes.NewCipher(key)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(err)</span><br><span class="line">&#125;</span><br><span class="line">padText := PKCS7Padding(text, block.BlockSize()) <span class="comment">// å¡«å……</span></span><br><span class="line">blockMode := cipher.NewCBCEncrypter(block, iv)</span><br><span class="line">result := <span class="built_in">make</span>([]<span class="keyword">byte</span>, <span class="built_in">len</span>(padText)) <span class="comment">// åŠ å¯†</span></span><br><span class="line">blockMode.CryptBlocks(result, padText)</span><br><span class="line"><span class="keyword">return</span> result</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">CBCDecrypt</span><span class="params">(encrypt []<span class="keyword">byte</span>, key []<span class="keyword">byte</span>, iv []<span class="keyword">byte</span>)</span> []<span class="title">byte</span></span> &#123;</span><br><span class="line">block, err := aes.NewCipher(key)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(err)</span><br><span class="line">&#125;</span><br><span class="line">blockMode := cipher.NewCBCDecrypter(block, iv)</span><br><span class="line">result := <span class="built_in">make</span>([]<span class="keyword">byte</span>, <span class="built_in">len</span>(encrypt))</span><br><span class="line">blockMode.CryptBlocks(result, encrypt)</span><br><span class="line"><span class="comment">// å»é™¤å¡«å……</span></span><br><span class="line">result = UnPKCS7Padding(result)</span><br><span class="line"><span class="keyword">return</span> result</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// PKCS7Padding è®¡ç®—å¾…å¡«å……çš„é•¿åº¦</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">PKCS7Padding</span><span class="params">(text []<span class="keyword">byte</span>, blockSize <span class="keyword">int</span>)</span> []<span class="title">byte</span></span> &#123;</span><br><span class="line">padding := blockSize - <span class="built_in">len</span>(text)%blockSize</span><br><span class="line"><span class="keyword">var</span> paddingText []<span class="keyword">byte</span></span><br><span class="line"><span class="keyword">if</span> padding == <span class="number">0</span> &#123;</span><br><span class="line">paddingText = bytes.Repeat([]<span class="keyword">byte</span>&#123;<span class="keyword">byte</span>(blockSize)&#125;, blockSize) <span class="comment">// å·²å¯¹é½ï¼Œå¡«å……ä¸€æ•´å—æ•°æ®ï¼Œæ¯ä¸ªæ•°æ®ä¸º blockSize</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">paddingText = bytes.Repeat([]<span class="keyword">byte</span>&#123;<span class="keyword">byte</span>(padding)&#125;, padding) <span class="comment">// æœªå¯¹é½ å¡«å…… padding ä¸ªæ•°æ®ï¼Œæ¯ä¸ªæ•°æ®ä¸º padding</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">append</span>(text, paddingText...)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// UnPKCS7Padding å–å‡ºå¡«å……çš„æ•°æ® ä»¥æ­¤æ¥è·å¾—å¡«å……æ•°æ®é•¿åº¦</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">UnPKCS7Padding</span><span class="params">(text []<span class="keyword">byte</span>)</span> []<span class="title">byte</span></span> &#123;</span><br><span class="line">unPadding := <span class="keyword">int</span>(text[<span class="built_in">len</span>(text)<span class="number">-1</span>])</span><br><span class="line"><span class="keyword">return</span> text[:(<span class="built_in">len</span>(text) - unPadding)]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  ----------------------- BASE64 -----------------------</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Base64Encoding</span><span class="params">(input []<span class="keyword">byte</span>)</span> <span class="title">string</span></span> &#123;</span><br><span class="line"><span class="keyword">return</span> base64.StdEncoding.EncodeToString(input)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Base64Decoding</span><span class="params">(encodeString <span class="keyword">string</span>)</span> <span class="title">string</span></span> &#123;</span><br><span class="line">decodeBytes, err := base64.StdEncoding.DecodeString(encodeString)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">string</span>(decodeBytes)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Base64UrlEncoding</span><span class="params">(input []<span class="keyword">byte</span>)</span> <span class="title">string</span></span> &#123;</span><br><span class="line"><span class="keyword">return</span> base64.URLEncoding.EncodeToString(input)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Base64UrlDecoding</span><span class="params">(encodeUrl <span class="keyword">string</span>)</span> <span class="title">string</span></span> &#123;</span><br><span class="line">uDec, err := base64.URLEncoding.DecodeString(encodeUrl)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">string</span>(uDec)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  ----------------------- BASE58 -----------------------</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> b58 = []<span class="keyword">byte</span>(<span class="string">&quot;123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Base58Encoding base58ç¼–ç </span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Base58Encoding</span><span class="params">(src <span class="keyword">string</span>)</span> <span class="title">string</span></span> &#123;</span><br><span class="line">srcByte := []<span class="keyword">byte</span>(src)</span><br><span class="line"><span class="comment">// todo è½¬æˆåè¿›åˆ¶</span></span><br><span class="line">i := big.NewInt(<span class="number">0</span>).SetBytes(srcByte)</span><br><span class="line"><span class="comment">// todo å¾ªç¯å–ä½™</span></span><br><span class="line"><span class="keyword">var</span> modSlice []<span class="keyword">byte</span></span><br><span class="line"><span class="keyword">for</span> i.Cmp(big.NewInt(<span class="number">0</span>)) &gt; <span class="number">0</span> &#123;</span><br><span class="line">mod := big.NewInt(<span class="number">0</span>)</span><br><span class="line">i58 := big.NewInt(<span class="number">58</span>)</span><br><span class="line">i.DivMod(i, i58, mod)                         <span class="comment">// å–ä½™</span></span><br><span class="line">modSlice = <span class="built_in">append</span>(modSlice, b58[mod.Int64()]) <span class="comment">// å°†ä½™æ•°æ·»åŠ åˆ°æ•°ç»„ä¸­</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// todo æŠŠ0ä½¿ç”¨å­—èŠ‚&#x27;1&#x27;ä»£æ›¿</span></span><br><span class="line"><span class="keyword">for</span> _, s := <span class="keyword">range</span> srcByte &#123;</span><br><span class="line"><span class="keyword">if</span> s != <span class="number">0</span> &#123;</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">&#125;</span><br><span class="line">modSlice = <span class="built_in">append</span>(modSlice, <span class="keyword">byte</span>(<span class="string">&#x27;1&#x27;</span>))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// todo åè½¬byteæ•°ç»„</span></span><br><span class="line">retModSlice := ReverseByteArr(modSlice)</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">string</span>(retModSlice)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Base58Decoding base58è§£ç </span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Base58Decoding</span><span class="params">(src <span class="keyword">string</span>)</span> <span class="title">string</span></span> &#123;</span><br><span class="line"><span class="comment">// è½¬æˆbyteæ•°ç»„</span></span><br><span class="line">srcByte := []<span class="keyword">byte</span>(src)</span><br><span class="line"><span class="comment">// è¿™é‡Œå¾—åˆ°çš„æ˜¯åè¿›åˆ¶</span></span><br><span class="line">ret := big.NewInt(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">for</span> _, b := <span class="keyword">range</span> srcByte &#123;</span><br><span class="line">i := bytes.IndexByte(b58, b)</span><br><span class="line">ret.Mul(ret, big.NewInt(<span class="number">58</span>))       <span class="comment">// ä¹˜å›å»</span></span><br><span class="line">ret.Add(ret, big.NewInt(<span class="keyword">int64</span>(i))) <span class="comment">// ç›¸åŠ </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="keyword">string</span>(ret.Bytes())</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ReverseByteArr byteæ•°ç»„è¿›è¡Œåè½¬æ–¹å¼2</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ReverseByteArr</span><span class="params">(b []<span class="keyword">byte</span>)</span> []<span class="title">byte</span></span> &#123;</span><br><span class="line"><span class="keyword">for</span> i, j := <span class="number">0</span>, <span class="built_in">len</span>(b)<span class="number">-1</span>; i &lt; j; i, j = i+<span class="number">1</span>, j<span class="number">-1</span> &#123;</span><br><span class="line">b[i], b[j] = b[j], b[i]</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> b</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  ----------------------- å“ˆå¸Œç®—æ³• -----------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// HashMD4Encoding MD4å“ˆå¸ŒåŠ å¯†</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">HashMD4Encoding</span><span class="params">(src <span class="keyword">string</span>)</span> <span class="title">string</span></span> &#123;</span><br><span class="line">srcByte := []<span class="keyword">byte</span>(src)</span><br><span class="line">md4New := md4.New()</span><br><span class="line">md4Bytes := md4New.Sum(srcByte)</span><br><span class="line"><span class="keyword">return</span> hex.EncodeToString(md4Bytes)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// HashMD5Encoding MD5å“ˆå¸ŒåŠ å¯†</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">HashMD5Encoding</span><span class="params">(src <span class="keyword">string</span>)</span> <span class="title">string</span></span> &#123;</span><br><span class="line">srcByte := []<span class="keyword">byte</span>(src)</span><br><span class="line">md5New := md5.New()</span><br><span class="line">md5Bytes := md5New.Sum(srcByte)</span><br><span class="line"><span class="keyword">return</span> hex.EncodeToString(md5Bytes)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// HashSHA256Encoding SHA256å“ˆå¸ŒåŠ å¯†</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">HashSHA256Encoding</span><span class="params">(src <span class="keyword">string</span>)</span> <span class="title">string</span></span> &#123;</span><br><span class="line">sha256Bytes := sha256.Sum256([]<span class="keyword">byte</span>(src))</span><br><span class="line"><span class="keyword">return</span> hex.EncodeToString(sha256Bytes[:])</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  ----------------------- DES -----------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// DesEncoding åŠ å¯†</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">DesEncoding</span><span class="params">(src <span class="keyword">string</span>, desKey []<span class="keyword">byte</span>)</span> <span class="params">(<span class="keyword">string</span>, error)</span></span> &#123;</span><br><span class="line"><span class="comment">// todo desKeyåªæ”¯æŒ8å­—èŠ‚çš„é•¿åº¦</span></span><br><span class="line">srcByte := []<span class="keyword">byte</span>(src)</span><br><span class="line">block, err := des.NewCipher(desKey)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> src, err</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// todo å¯†ç å¡«å……</span></span><br><span class="line">newSrcByte := PadPwd(srcByte, block.BlockSize())</span><br><span class="line">dst := <span class="built_in">make</span>([]<span class="keyword">byte</span>, <span class="built_in">len</span>(newSrcByte))</span><br><span class="line">block.Encrypt(dst, newSrcByte)</span><br><span class="line"><span class="comment">// todo base64ç¼–ç </span></span><br><span class="line">pwd := base64.StdEncoding.EncodeToString(dst)</span><br><span class="line"><span class="keyword">return</span> pwd, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// DesDecoding è§£å¯†</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">DesDecoding</span><span class="params">(pwd <span class="keyword">string</span>, desKey []<span class="keyword">byte</span>)</span> <span class="params">(<span class="keyword">string</span>, error)</span></span> &#123;</span><br><span class="line">pwdByte, err := base64.StdEncoding.DecodeString(pwd)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> pwd, err</span><br><span class="line">&#125;</span><br><span class="line">block, errBlock := des.NewCipher(desKey)</span><br><span class="line"><span class="keyword">if</span> errBlock != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> pwd, errBlock</span><br><span class="line">&#125;</span><br><span class="line">dst := <span class="built_in">make</span>([]<span class="keyword">byte</span>, <span class="built_in">len</span>(pwdByte))</span><br><span class="line">block.Decrypt(dst, pwdByte)</span><br><span class="line">dst, _ = UnPadPwd(dst)</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">string</span>(dst), <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// PadPwd å¡«å……å¯†ç é•¿åº¦</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">PadPwd</span><span class="params">(srcByte []<span class="keyword">byte</span>, blockSize <span class="keyword">int</span>)</span> []<span class="title">byte</span></span> &#123;</span><br><span class="line">padNum := blockSize - <span class="built_in">len</span>(srcByte)%blockSize</span><br><span class="line">ret := bytes.Repeat([]<span class="keyword">byte</span>&#123;<span class="keyword">byte</span>(padNum)&#125;, padNum)</span><br><span class="line">srcByte = <span class="built_in">append</span>(srcByte, ret...)</span><br><span class="line"><span class="keyword">return</span> srcByte</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// UnPadPwd å»æ‰å¡«å……çš„éƒ¨åˆ†</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">UnPadPwd</span><span class="params">(dst []<span class="keyword">byte</span>)</span> <span class="params">([]<span class="keyword">byte</span>, error)</span></span> &#123;</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(dst) &lt;= <span class="number">0</span> &#123;</span><br><span class="line"><span class="keyword">return</span> dst, errors.New(<span class="string">&quot;é•¿åº¦æœ‰è¯¯&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line">unPadNum := <span class="keyword">int</span>(dst[<span class="built_in">len</span>(dst)<span class="number">-1</span>])</span><br><span class="line"><span class="keyword">return</span> dst[:(<span class="built_in">len</span>(dst) - unPadNum)], <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  ----------------------- 3DES-CBC -----------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// TDesEncoding 3desåŠ å¯†</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TDesEncoding</span><span class="params">(src <span class="keyword">string</span>, desKey []<span class="keyword">byte</span>)</span> <span class="params">(<span class="keyword">string</span>, error)</span></span> &#123;</span><br><span class="line"><span class="comment">// todo key 24ä½æ•°</span></span><br><span class="line">srcByte := []<span class="keyword">byte</span>(src)</span><br><span class="line">block, err := des.NewTripleDESCipher(desKey) <span class="comment">// å’Œdesçš„åŒºåˆ«</span></span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> src, err</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// todo å¯†ç å¡«å……</span></span><br><span class="line">newSrcByte := PadPwd(srcByte, block.BlockSize())</span><br><span class="line">dst := <span class="built_in">make</span>([]<span class="keyword">byte</span>, <span class="built_in">len</span>(newSrcByte))</span><br><span class="line">block.Encrypt(dst, newSrcByte)</span><br><span class="line"><span class="comment">// todo base64ç¼–ç </span></span><br><span class="line">pwd := base64.StdEncoding.EncodeToString(dst)</span><br><span class="line"><span class="keyword">return</span> pwd, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// TDesDecoding 3desè§£å¯†</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TDesDecoding</span><span class="params">(pwd <span class="keyword">string</span>, desKey []<span class="keyword">byte</span>)</span> <span class="params">(<span class="keyword">string</span>, error)</span></span> &#123;</span><br><span class="line">pwdByte, err := base64.StdEncoding.DecodeString(pwd)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> pwd, err</span><br><span class="line">&#125;</span><br><span class="line">block, errBlock := des.NewTripleDESCipher(desKey) <span class="comment">// å’Œdesçš„åŒºåˆ«</span></span><br><span class="line"><span class="keyword">if</span> errBlock != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> pwd, errBlock</span><br><span class="line">&#125;</span><br><span class="line">dst := <span class="built_in">make</span>([]<span class="keyword">byte</span>, <span class="built_in">len</span>(pwdByte))</span><br><span class="line">block.Decrypt(dst, pwdByte)</span><br><span class="line">dst, _ = UnPadPwd(dst)</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">string</span>(dst), <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  ----------------------- RSA -----------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// SaveRsaKey ç”ŸæˆRsaå…¬é’¥ç§é’¥å¹¶ä¿å­˜</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">SaveRsaKey</span><span class="params">(bits <span class="keyword">int</span>)</span> <span class="title">error</span></span> &#123;</span><br><span class="line"><span class="comment">// todo å¤„ç†é’¥åŒ™</span></span><br><span class="line">privateKey, err := rsa.GenerateKey(rand.Reader, bits)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(err)</span><br><span class="line"><span class="keyword">return</span> err</span><br><span class="line">&#125;</span><br><span class="line">publicKey := privateKey.PublicKey</span><br><span class="line">x509Private := x509.MarshalPKCS1PrivateKey(privateKey)             <span class="comment">// ä½¿ç”¨x509æ ‡å‡†å¯¹ç§é’¥è¿›è¡Œç¼–ç ï¼ŒAsN.1ç¼–ç å­—ç¬¦ä¸²</span></span><br><span class="line">x509Public := x509.MarshalPKCS1PublicKey(&amp;publicKey)               <span class="comment">// ä½¿ç”¨x509æ ‡å‡†å¯¹å…¬é’¥è¿›è¡Œç¼–ç ï¼ŒAsN.1ç¼–ç å­—ç¬¦ä¸²</span></span><br><span class="line">blockPrivate := pem.Block&#123;Type: <span class="string">&quot;private key&quot;</span>, Bytes: x509Private&#125; <span class="comment">// å¯¹ç§é’¥å°è£…block ç»“æ„æ•°æ®</span></span><br><span class="line">blockPublic := pem.Block&#123;Type: <span class="string">&quot;public key&quot;</span>, Bytes: x509Public&#125;    <span class="comment">// å¯¹å…¬é’¥å°è£…block ç»“æ„æ•°æ®</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// todo åˆ›å»ºå­˜æ”¾ç§é’¥çš„æ–‡ä»¶</span></span><br><span class="line">privateFile, errPri := os.Create(<span class="string">&quot;privateKey.pem&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> errPri != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> errPri</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">defer</span> privateFile.Close()</span><br><span class="line">pem.Encode(privateFile, &amp;blockPrivate)</span><br><span class="line"><span class="comment">// todo åˆ›å»ºå­˜æ”¾å…¬é’¥çš„æ–‡ä»¶</span></span><br><span class="line">publicFile, errPub := os.Create(<span class="string">&quot;publicKey.pem&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> errPub != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> errPub</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">defer</span> publicFile.Close()</span><br><span class="line">pem.Encode(publicFile, &amp;blockPublic)</span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// RsaEncoding åŠ å¯†</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">RsaEncoding</span><span class="params">(src, filePath <span class="keyword">string</span>)</span> <span class="params">([]<span class="keyword">byte</span>, error)</span></span> &#123;</span><br><span class="line">srcByte := []<span class="keyword">byte</span>(src)</span><br><span class="line"><span class="comment">// todo æ‰“å¼€æ–‡ä»¶</span></span><br><span class="line">file, err := os.Open(filePath)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> srcByte, err</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// todo è·å–æ–‡ä»¶ä¿¡æ¯</span></span><br><span class="line">fileInfo, errInfo := file.Stat()</span><br><span class="line"><span class="keyword">if</span> errInfo != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> srcByte, errInfo</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// todo è¯»å–æ–‡ä»¶å†…å®¹</span></span><br><span class="line">keyBytes := <span class="built_in">make</span>([]<span class="keyword">byte</span>, fileInfo.Size())</span><br><span class="line">file.Read(keyBytes)                                       <span class="comment">// è¯»å–å†…å®¹åˆ°å®¹å™¨é‡Œé¢</span></span><br><span class="line">block, _ := pem.Decode(keyBytes)                          <span class="comment">// pemè§£ç </span></span><br><span class="line">publicKey, errPb := x509.ParsePKCS1PublicKey(block.Bytes) <span class="comment">// x509è§£ç </span></span><br><span class="line"><span class="keyword">if</span> errPb != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> srcByte, errPb</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// todo ä½¿ç”¨å…¬é’¥å¯¹æ˜æ–‡è¿›è¡ŒåŠ å¯†</span></span><br><span class="line">retByte, errRet := rsa.EncryptPKCS1v15(rand.Reader, publicKey, srcByte)</span><br><span class="line"><span class="keyword">if</span> errRet != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> srcByte, errRet</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> retByte, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// RsaDecoding è§£å¯†</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">RsaDecoding</span><span class="params">(srcByte []<span class="keyword">byte</span>, filePath <span class="keyword">string</span>)</span> <span class="params">([]<span class="keyword">byte</span>, error)</span></span> &#123;</span><br><span class="line"><span class="comment">// todo æ‰“å¼€æ–‡ä»¶</span></span><br><span class="line">file, err := os.Open(filePath)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> srcByte, err</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// todo è·å–æ–‡ä»¶ä¿¡æ¯</span></span><br><span class="line">fileInfo, errInfo := file.Stat()</span><br><span class="line"><span class="keyword">if</span> errInfo != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> srcByte, errInfo</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// todo è¯»å–æ–‡ä»¶å†…å®¹</span></span><br><span class="line">keyBytes := <span class="built_in">make</span>([]<span class="keyword">byte</span>, fileInfo.Size())</span><br><span class="line"><span class="comment">// è¯»å–å†…å®¹åˆ°å®¹å™¨é‡Œé¢</span></span><br><span class="line">file.Read(keyBytes)</span><br><span class="line">block, _ := pem.Decode(keyBytes)                            <span class="comment">// pemè§£ç </span></span><br><span class="line">privateKey, errPb := x509.ParsePKCS1PrivateKey(block.Bytes) <span class="comment">// x509è§£ç </span></span><br><span class="line"><span class="keyword">if</span> errPb != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> srcByte, errPb</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// todo è¿›è¡Œè§£å¯†</span></span><br><span class="line">retByte, errRet := rsa.DecryptPKCS1v15(rand.Reader, privateKey, srcByte)</span><br><span class="line"><span class="keyword">if</span> errRet != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> srcByte, errRet</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> retByte, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  ----------------------- æ•°å­—ç­¾å -----------------------</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetPrivateKey</span><span class="params">(filePath <span class="keyword">string</span>)</span> <span class="params">(*rsa.PrivateKey, error)</span></span> &#123;</span><br><span class="line"><span class="comment">// todo æ‰“å¼€æ–‡ä»¶</span></span><br><span class="line">file, err := os.Open(filePath)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> &amp;rsa.PrivateKey&#123;&#125;, err</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// todo è·å–æ–‡ä»¶ä¿¡æ¯</span></span><br><span class="line">fileInfo, errInfo := file.Stat()</span><br><span class="line"><span class="keyword">if</span> errInfo != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> &amp;rsa.PrivateKey&#123;&#125;, errInfo</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// todo è¯»å–æ–‡ä»¶å†…å®¹</span></span><br><span class="line">keyBytes := <span class="built_in">make</span>([]<span class="keyword">byte</span>, fileInfo.Size())</span><br><span class="line">file.Read(keyBytes)                                         <span class="comment">// è¯»å–å†…å®¹åˆ°å®¹å™¨é‡Œé¢</span></span><br><span class="line">block, _ := pem.Decode(keyBytes)                            <span class="comment">// pemè§£ç </span></span><br><span class="line">PrivateKey, errPb := x509.ParsePKCS1PrivateKey(block.Bytes) <span class="comment">// x509è§£ç </span></span><br><span class="line"><span class="keyword">if</span> errPb != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> &amp;rsa.PrivateKey&#123;&#125;, errPb</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> PrivateKey, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetPublicKey</span><span class="params">(filePath <span class="keyword">string</span>)</span> <span class="params">(*rsa.PublicKey, error)</span></span> &#123;</span><br><span class="line"><span class="comment">// todo æ‰“å¼€æ–‡ä»¶</span></span><br><span class="line">file, err := os.Open(filePath)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> &amp;rsa.PublicKey&#123;&#125;, err</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// todo è·å–æ–‡ä»¶ä¿¡æ¯</span></span><br><span class="line">fileInfo, errInfo := file.Stat()</span><br><span class="line"><span class="keyword">if</span> errInfo != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> &amp;rsa.PublicKey&#123;&#125;, errInfo</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// todo è¯»å–æ–‡ä»¶å†…å®¹</span></span><br><span class="line">keyBytes := <span class="built_in">make</span>([]<span class="keyword">byte</span>, fileInfo.Size())</span><br><span class="line">file.Read(keyBytes)                                       <span class="comment">// è¯»å–å†…å®¹åˆ°å®¹å™¨é‡Œé¢</span></span><br><span class="line">block, _ := pem.Decode(keyBytes)                          <span class="comment">// pemè§£ç </span></span><br><span class="line">publicKey, errPb := x509.ParsePKCS1PublicKey(block.Bytes) <span class="comment">// x509è§£ç </span></span><br><span class="line"><span class="keyword">if</span> errPb != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> &amp;rsa.PublicKey&#123;&#125;, errPb</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> publicKey, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// RsaSign æ•°å­—ç­¾å</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">RsaSign</span><span class="params">(filePath <span class="keyword">string</span>, src <span class="keyword">string</span>)</span> <span class="params">([]<span class="keyword">byte</span>, error)</span></span> &#123;</span><br><span class="line"><span class="comment">// todo è·å–ç§é’¥</span></span><br><span class="line">private, err := GetPrivateKey(filePath)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> []<span class="keyword">byte</span>&#123;&#125;, err</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// todo ç­¾å</span></span><br><span class="line">shaNew := sha256.New()</span><br><span class="line">srcByte := []<span class="keyword">byte</span>(src)</span><br><span class="line">shaNew.Write(srcByte)</span><br><span class="line">shaByte := shaNew.Sum(<span class="literal">nil</span>)</span><br><span class="line">v15, err := rsa.SignPKCS1v15(rand.Reader, private, crypto.SHA256, shaByte)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> []<span class="keyword">byte</span>&#123;&#125;, err</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> v15, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// RsaVerify éªŒè¯ç­¾å</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">RsaVerify</span><span class="params">(sign []<span class="keyword">byte</span>, src <span class="keyword">string</span>, filePath <span class="keyword">string</span>)</span> <span class="params">(<span class="keyword">bool</span>, error)</span></span> &#123;</span><br><span class="line"><span class="comment">// todo æ‹¿åˆ°å…¬é’¥</span></span><br><span class="line">public, err := GetPublicKey(filePath)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>, err</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// todo éªŒè¯ç­¾å</span></span><br><span class="line">shaNew := sha256.New()</span><br><span class="line">srcByte := []<span class="keyword">byte</span>(src)</span><br><span class="line">shaNew.Write(srcByte)</span><br><span class="line">shaByte := shaNew.Sum(<span class="literal">nil</span>)</span><br><span class="line">err = rsa.VerifyPKCS1v15(public, crypto.SHA256, shaByte, sign)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>, err</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä»£ç å®ç°">ä»£ç å®ç°</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;GoBackEnd/public&quot;</span></span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line"><span class="string">&quot;log&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">// AES-CBC</span></span><br><span class="line">iv := []<span class="keyword">byte</span>&#123;<span class="number">0x19</span>, <span class="number">0x34</span>, <span class="number">0x57</span>, <span class="number">0x72</span>, <span class="number">0x90</span>, <span class="number">0xAB</span>, <span class="number">0xCD</span>, <span class="number">0xEF</span>, <span class="number">0x12</span>, <span class="number">0x64</span>, <span class="number">0x14</span>, <span class="number">0x78</span>, <span class="number">0x90</span>, <span class="number">0xAC</span>, <span class="number">0xAE</span>, <span class="number">0x45</span>&#125;</span><br><span class="line">key := []<span class="keyword">byte</span>(<span class="string">&quot;1111111111111111&quot;</span>)</span><br><span class="line">AesCbc := public.CBCEncrypt([]<span class="keyword">byte</span>(<span class="string">&quot;hello&quot;</span>), key, iv)</span><br><span class="line">fmt.Println(AesCbc)</span><br><span class="line">content := public.CBCDecrypt(AesCbc, key, iv)</span><br><span class="line">fmt.Println(<span class="keyword">string</span>(content))</span><br><span class="line"><span class="comment">// BASE64</span></span><br><span class="line">encode := public.Base64Encoding([]<span class="keyword">byte</span>(<span class="string">&quot;Hello&quot;</span>))</span><br><span class="line">fmt.Println(encode)</span><br><span class="line">decode := public.Base64Decoding(encode)</span><br><span class="line">fmt.Println(decode)</span><br><span class="line"><span class="comment">// BASE58</span></span><br><span class="line">encode = public.Base58Encoding(<span class="string">&quot;Hello&quot;</span>)</span><br><span class="line">fmt.Println(encode)</span><br><span class="line">decode = public.Base58Decoding(encode)</span><br><span class="line">fmt.Println(decode)</span><br><span class="line"><span class="comment">// å“ˆå¸Œç®—æ³•</span></span><br><span class="line">md4 := public.HashMD4Encoding(<span class="string">&quot;hello&quot;</span>)</span><br><span class="line">fmt.Println(md4)</span><br><span class="line">md5 := public.HashMD5Encoding(<span class="string">&quot;hello&quot;</span>)</span><br><span class="line">fmt.Println(md5)</span><br><span class="line">sha := public.HashSHA256Encoding(<span class="string">&quot;hello&quot;</span>)</span><br><span class="line">fmt.Println(sha)</span><br><span class="line"><span class="comment">// DES</span></span><br><span class="line">encode, _ = public.DesEncoding(<span class="string">&quot;hello&quot;</span>, []<span class="keyword">byte</span>(<span class="string">&quot;11111111&quot;</span>)) <span class="comment">// 8ä½æ•°</span></span><br><span class="line">fmt.Println(<span class="string">&quot;Des:&quot;</span>, encode)</span><br><span class="line">decode, _ = public.DesDecoding(encode, []<span class="keyword">byte</span>(<span class="string">&quot;11111111&quot;</span>))</span><br><span class="line">fmt.Println(<span class="string">&quot;Des:&quot;</span>, decode)</span><br><span class="line">encode, _ = public.TDesEncoding(<span class="string">&quot;hello&quot;</span>, []<span class="keyword">byte</span>(<span class="string">&quot;111111111111111111111111&quot;</span>)) <span class="comment">// 24ä½æ•°</span></span><br><span class="line">fmt.Println(encode)</span><br><span class="line">decode, _ = public.TDesDecoding(encode, []<span class="keyword">byte</span>(<span class="string">&quot;111111111111111111111111&quot;</span>))</span><br><span class="line">fmt.Println(decode)</span><br><span class="line"><span class="comment">// RSA</span></span><br><span class="line">err := public.SaveRsaKey(<span class="number">2048</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">log.Println(err)</span><br><span class="line">&#125;</span><br><span class="line">encoding, _ := public.RsaEncoding(<span class="string">&quot;hello&quot;</span>, <span class="string">&quot;publicKey.pem&quot;</span>)</span><br><span class="line">log.Println(public.Base64Encoding(encoding))</span><br><span class="line">decoding, _ := public.RsaDecoding(encoding, <span class="string">&quot;privateKey.pem&quot;</span>)</span><br><span class="line">log.Println(<span class="keyword">string</span>(decoding))</span><br><span class="line"><span class="comment">// æ•°å­—ç­¾å</span></span><br><span class="line">encoding, _ = public.RsaSign(<span class="string">&quot;privateKey.pem&quot;</span>, <span class="string">&quot;hello&quot;</span>)</span><br><span class="line">log.Println(encoding)</span><br><span class="line">isTrue, _ := public.RsaVerify(encoding, <span class="string">&quot;hello&quot;</span>, <span class="string">&quot;publicKey.pem&quot;</span>)</span><br><span class="line">log.Println(isTrue)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Ubuntuçº¯å‘½ä»¤è¡Œèµ°Clashç»ˆç«¯ä»£ç†(LinuxåŒç†)</title>
      <link href="/article/3dadfa74.html"/>
      <url>/article/3dadfa74.html</url>
      
        <content type="html"><![CDATA[<h2 id="Ubuntuçº¯å‘½ä»¤è¡Œèµ°Clashä»£ç†-LinuxåŒç†">Ubuntuçº¯å‘½ä»¤è¡Œèµ°Clashä»£ç†(LinuxåŒç†)</h2><div class="note green icon flat"><i class="note-icon fas fa-bullhorn"></i><p>å¹¿å‘Š ï¼š<a href="https://hengy1.top/article/567e1422.html">https://hengy1.top/article/567e1422.html</a></p></div><h2 id="å¸ƒç½®ç¯å¢ƒ">å¸ƒç½®ç¯å¢ƒ</h2><p>åˆ° <a href="https://github.com/Dreamacro/clash/releases">https://github.com/Dreamacro/clash/releases</a> æ‰¾åˆ°æœ€æ–°ç‰ˆæœ¬</p><blockquote><p>è¿™é‡Œåæ§½ä¸‹ï¼šå¯èƒ½ä¸€ç›´æ‹‰ä¸ä¸‹æ¥ï¼Œæ‰‹åŠ¨ä¸‹è½½ç„¶åftpä¼ ä¸Šæ¥</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºç¯å¢ƒ</span></span><br><span class="line">$ mkdir clash</span><br><span class="line">$ <span class="built_in">cd</span> clash</span><br><span class="line"><span class="comment"># æ‹‰å–ä¸‹æ¥</span></span><br><span class="line">$ wget https://github.com/Dreamacro/clash/releases/download/v1.9.0/clash-linux-amd64-v1.9.0.gz</span><br><span class="line">$ gzip -d clash-linux-amd64-v1.9.0.gz</span><br><span class="line">$ mv clash-linux-amd64-v1.9.0.gz clash</span><br><span class="line"><span class="comment"># è¿™é‡Œclashä¸ºäºŒè¿›åˆ¶å¯ä»¥è¿è¡Œæ–‡ä»¶äº†</span></span><br><span class="line">$ chomd 755 clash</span><br></pre></td></tr></table></figure><h2 id="ä¼ å…¥é…ç½®">ä¼ å…¥é…ç½®</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç”Ÿæˆé»˜è®¤é…ç½®</span></span><br><span class="line">$ ./clash -d .  <span class="comment"># é»˜è®¤é…ç½®</span></span><br><span class="line"><span class="comment"># æ‹‰å–æœºåœºé…ç½®</span></span><br><span class="line">$ wget xxxx <span class="comment"># è¦ä¹ˆæ‹‰ä¸‹æ¥ è¦ä¹ˆè‡ªå·±æ‹·è´ä¸Šæ¥</span></span><br><span class="line"><span class="comment"># æ³¨æ„ï¼š åç§°ä¸ºï¼šconfig.yaml</span></span><br><span class="line">$ ./clash -d . <span class="comment"># å°±å¼€å§‹åŠ è½½ä½ çš„é…ç½®äº†</span></span><br></pre></td></tr></table></figure><img src="/img/mics/image-20220222194004626.webp" alt="image-20220222194004626" style="zoom:85%;" /><h2 id="æ—¥å¸¸ä½¿ç”¨">æ—¥å¸¸ä½¿ç”¨</h2><p>ä½ ä¼šå‘ç°è¿™ä¸ªå·²å–æ¶ˆå°±å¤±æ•ˆäº†ï¼Œä¸‹é¢æˆ‘ä»¬æ·»åŠ åˆ°åå°(å»ºè®®ä¸ºrootç”¨æˆ·)</p><ol><li><code>vim ~/..bashrc  </code>å¼€å§‹å‡†å¤‡å‘½ä»¤å¹¶æŠŠä¸‹é¢çš„å†™è¿›å…¥</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">alias</span> clash_start=<span class="string">&quot;screen -S clash /home/xxx/clash/clash -d /home/xxx/clash/&quot;</span></span><br><span class="line"><span class="built_in">alias</span> clash_stop=<span class="string">&quot;pkill clash&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">alias</span> proxy_on=<span class="string">&quot;export https_proxy=127.0.0.1:7890 &amp;&amp; export http_proxy=127.0.0.1:7890&quot;</span></span><br><span class="line"><span class="built_in">alias</span> proxy_off=<span class="string">&quot;unset http_proxy https_proxy&quot;</span></span><br></pre></td></tr></table></figure><ol start="2"><li><code>source ~/..bashrc </code> é‡æ–°è½½å…¥</li><li><code>clash_start</code>ä¼šè¿›å…¥screen æŒ‰ <code>ctrl + a + d</code>é€€å‡ºåå°</li><li><code>proxy_on</code>å¼€å¯ä»£ç†</li><li><code>curl https://www.youtube.com/</code>ä¼šå‘ç°é©¬ä¸Šè¿”å›ç»“æœ</li></ol><h2 id="githubåŠ é€Ÿ">githubåŠ é€Ÿ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ git config --global http.proxy <span class="string">&#x27;http://127.0.0.1:7890&#x27;</span></span><br><span class="line">$ git config --global https.proxy <span class="string">&#x27;https://127.0.0.1:7890&#x27;</span></span><br></pre></td></tr></table></figure><div class="note pink icon flat"><i class="note-icon fas fa-car-crash"></i><p>æ­å–œï¼šé€Ÿåº¦èµ·æ¥äº†ï¼<br>ç§‘å­¦ä¸Šç½‘ï¼Œè§„èŒƒè¡Œä½¿ã€‚</p></div>]]></content>
      
      
      <categories>
          
          <category> åˆ†äº« </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>æ—¥å¸¸ä¸­çš„Gitæ€ä¹ˆä½¿ç”¨</title>
      <link href="/article/e996634a.html"/>
      <url>/article/e996634a.html</url>
      
        <content type="html"><![CDATA[<hr><h2 id="æ—¥å¸¸ä¸­çš„Gitæ€ä¹ˆä½¿ç”¨">æ—¥å¸¸ä¸­çš„Gitæ€ä¹ˆä½¿ç”¨</h2><p><code>git</code>æ˜¯çœŸçš„é¦™å‘€ï¼Œä¸»è¦æ˜¯å¥½ç®¡ç†ï¼Œç”¨ç€æ–¹ä¾¿ã€‚</p><p>æˆ‘çš„gitå­¦ä¹ è·¯ç¨‹å°±æ˜¯ï¼šå­¦äº† -&gt; desktopç‚¹ç‚¹ç‚¹ -&gt; ä¸‰å‰‘å®¢ -&gt; æ•²å‡»å‘½ä»¤</p><p>è¯´ç™½å°±æ˜¯ä¸çŸ¥é“å„ç§æƒ…å†µä¸çŸ¥é“æ€ä¹ˆåŠï¼Ÿ</p><p>ç„¶åä»Šå¤©å°±ç®€å•æ€»ç»“ä¸‹å‡ ç§æƒ…å†µã€‚</p><h2 id="æƒ…æ™¯å†ç°ï¼š">æƒ…æ™¯å†ç°ï¼š</h2><ol><li>æˆ‘åˆ›å»ºäº†è¿œç¨‹ä»“åº“ï¼Œæˆ‘æœ¬åœ°å·²ç»æœ‰ä»£ç äº†ï¼Œå¦‚ä½•å°†æœ¬åœ°çš„åŠ å…¥åˆ°ä»“åº“é‡Œé¢</li><li>ä¸ºåˆ«äººä»“åº“æäº¤Prï¼Œå‚ä¸åˆ«äººçš„é¡¹ç›®ã€‚</li><li>æˆ‘åˆ›å»ºäº†ä»“åº“ï¼Œæ‹‰ä¸‹æ¥è‡ªå·±æ”¹äº†ï¼Œåˆ«äººåœ¨æˆ‘ä¹‹å‰ä¸Šä¼ äº†ä»£ç ï¼Œæˆ‘æ€ä¹ˆä¸Šä¼ </li><li>åˆ›å»ºäº†ä¸»çº¿åˆ†æ”¯ä¸æ”¯çº¿åˆ†æ”¯ï¼Œæ”¯çº¿å¼€å‘åˆå¹¶åˆ°ä¸»çº¿</li><li>ä¸€äº›åŸºç¡€å‘½ä»¤ï¼Œè´¦å·è®¾ç½®ã€‚</li></ol><div class="note green icon flat"><i class="note-icon fas fa-bullhorn"></i><p>åœ¨è¿™é‡Œæˆ‘å‡†å¤‡äº†2ä¸ªè´¦å·æ¥æ¨¡æ‹Ÿä¸‹ã€‚åˆ†åˆ«ç”¨å°å¼å’Œç¬”è®°æœ¬è®¾ç½®äº†å…¨å±€è´¦å·</p><p>è‡³äºç»ˆç«¯æ€ä¹ˆåŠ é€Ÿ ç‚¹å‡»å³ä¾§ğŸ‘‰ ï¼š<a href="https://hengy1.top/article/567e1422.html">https://hengy1.top/article/567e1422.html</a></p></div><h2 id="æƒ…å¢ƒä¸€ï¼š">æƒ…å¢ƒä¸€ï¼š</h2><blockquote><p>æˆ‘åˆ›å»ºäº†è¿œç¨‹ä»“åº“ï¼Œæˆ‘æœ¬åœ°å·²ç»æœ‰ä»£ç äº†ï¼Œå¦‚ä½•å°†æœ¬åœ°çš„åŠ å…¥åˆ°ä»“åº“é‡Œé¢</p></blockquote><p>ä¸€èˆ¬åˆ›å»ºå¥½äº†ä¼šæœ‰<code>LICENSE</code>ä¸<code>README</code>ï¼Œç„¶åæœ¬åœ°å·²ç»æœ‰äº†æ–‡ä»¶ã€‚</p><img src="/img/mics/image-20220220222648642.webp" alt="è¿œç¨‹ä»“åº“" style="zoom:67%;" /><img src="/img/mics/image-20220220222956379.webp" alt="æœ¬åœ°å­˜åœ¨æ–‡ä»¶äº†" style="zoom:67%;" /><p>ä¸‹é¢æ­¥éª¤ä¸æ³¨é‡Šæˆ‘éƒ½å†™åœ¨é‡Œé¢äº†ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆå§‹åŒ–initç¯å¢ƒ</span></span><br><span class="line">$ git init</span><br><span class="line"><span class="comment"># åˆ‡æ¢åˆ°mainåˆ†æ”¯ å› ä¸ºç°åœ¨gitçš„é»˜è®¤åˆ†æ”¯æ˜¯mainäº†</span></span><br><span class="line">$ git checkout -b main</span><br><span class="line"><span class="comment"># æ·»åŠ è¿œç¨‹åœ°å€ originNameè‡ªå·±å–</span></span><br><span class="line">$ git remote add originName git@github.com:HengY1Sky/gitTry.git</span><br><span class="line"><span class="comment"># æŸ¥çœ‹ä¸‹è¿œç¨‹</span></span><br><span class="line">$ git remote -v</span><br><span class="line"><span class="comment"># æŠŠè¿œç¨‹çš„æ‹¿æ¥ä¸‹ç„¶åä¸æœ¬åœ°çš„åˆåˆ°ä¸€èµ·</span></span><br><span class="line">$ git pull originName main</span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ•ˆæœ</span></span><br><span class="line">$ ls -l</span><br><span class="line"><span class="comment"># æ·»åŠ åˆ°å·¥ä½œåŒº</span></span><br><span class="line">$ git add .</span><br><span class="line">$ git commit -m <span class="string">&quot;init&quot;</span></span><br><span class="line"><span class="comment"># æäº¤ </span></span><br><span class="line">$ git push --set-upstream originName main</span><br></pre></td></tr></table></figure><img src="/img/mics/image-20220220224029970.webp" alt="" style="zoom:67%;" /><h2 id="æƒ…å¢ƒäºŒï¼š">æƒ…å¢ƒäºŒï¼š</h2><blockquote><p>ä¸ºåˆ«äººä»“åº“æäº¤Prï¼Œå‚ä¸åˆ«äººçš„é¡¹ç›®ã€‚</p></blockquote><p>è¿™ä¸ªæ˜¯åˆ†æƒ…å†µçš„ï¼š</p><p>å¦‚æœä½ æœ‰è¿™ä¸ªä»“åº“æƒé™ï¼Œå³ä½ æ˜¯æˆå‘˜ï¼šç›´æ¥æ‹‰ä¸‹æ¥æäº¤å°±è¡Œäº†</p><p>å¦‚æœæ˜¯åˆ«äººçš„ä»“åº“ï¼Œä½ å¾—å…ˆè‡ªå·±forkä¸ªï¼Œæ‹¥æœ‰æƒé™å†åŠ¨ã€‚</p><img src="/img/mics/image-20220220224632928.webp" alt="" style="zoom:67%;" /><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä»è‡ªå·±forkçš„æ‹¿ä¸‹æ¥å°†æ–‡ä»¶å‘½åä¸ºgit</span></span><br><span class="line">$ git <span class="built_in">clone</span> https://github.com/HengY1Sky/gitTest.git git </span><br><span class="line">$ <span class="built_in">cd</span> git</span><br><span class="line"><span class="comment"># åˆ›å»ºåˆ†æ”¯</span></span><br><span class="line"><span class="comment"># ä¸ºä»€ä¹ˆåŠ åˆ†æ”¯ï¼Ÿå› ä¸ºä¸»åˆ†æ”¯é˜²æ­¢åˆ«äººä»“åº“æ›´æ–°äº†</span></span><br><span class="line">$ git checkout -b change</span><br><span class="line"><span class="comment"># å¼€å§‹è‡ªå·±åŠ ä¸œè¥¿</span></span><br><span class="line">$ ....</span><br><span class="line">$ git add .</span><br><span class="line">$ git commit -m <span class="string">&quot;add hello.txt&quot;</span></span><br><span class="line"><span class="comment"># æäº¤åˆ°è¿œç¨‹</span></span><br><span class="line">$ git push --set-upstream origin change</span><br></pre></td></tr></table></figure><img src="/img/mics/image-20220220225547672.webp" alt="" style="zoom:67%;" /><img src="/img/mics/image-20220220225637580.webp" alt="" style="zoom:67%;" /><p><code>ä½ çš„ä»“åº“ï¼šåˆ†æ”¯</code> -&gt;<code>å¯¹æ–¹çš„ä»“åº“/åˆ†æ”¯</code>ï¼Œç„¶ååŠ ä¸Šä½ çš„æè¿°ï¼Œå¯¹æ–¹æ¥å—ä¼šç»™ä½ å‘é‚®ä»¶ï¼Œä½ ä»¬å¯ä»¥äº¤æµäº¤æµäº†ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å½“ç„¶åˆ«äººä»“åº“å¯ä»¥æ›´æ–°çš„</span></span><br><span class="line">$ git branch</span><br><span class="line">$ git checkout main</span><br><span class="line">$ git remote add upstream https://github.com/HengY1Sky/gitTest.git</span><br><span class="line"><span class="comment"># å°†åˆ«äººçš„æœ€æ–°åˆ†æ”¯æ›´æ–°åˆ°ä½ çš„æœ¬åœ°mainåˆ†æ”¯ä¸Š</span></span><br><span class="line">$ git pull upstream main</span><br></pre></td></tr></table></figure><h2 id="æƒ…å¢ƒä¸‰ï¼š">æƒ…å¢ƒä¸‰ï¼š</h2><blockquote><p>æˆ‘åˆ›å»ºäº†ä»“åº“ï¼Œæ‹‰ä¸‹æ¥è‡ªå·±æ”¹äº†ï¼Œåˆ«äººåœ¨æˆ‘ä¹‹å‰ä¸Šä¼ äº†ä»£ç ï¼Œæˆ‘æ€ä¹ˆä¸Šä¼ </p></blockquote><p>è¿™é‡Œæˆ‘ç›´æ¥åœ¨Githubä¸Šæ”¹ä¸€ä¸‹ç›¸å½“äºåˆ«äººæ”¹äº†</p><img src="/img/mics/image-20220220230237186.webp" alt="" style="zoom:67%;" /><p>ç„¶åæˆ‘åœ¨æœ¬åœ°ä¸çŸ¥é“ï¼Œç»§ç»­æ›´æ”¹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git add .</span><br><span class="line">$ git commit -m <span class="string">&quot;make change&quot;</span></span><br><span class="line">$ git push <span class="comment"># ä¼šè¢«æ‹’ç»</span></span><br></pre></td></tr></table></figure><img src="/img/mics/image-20220220230441903.webp" alt="" style="zoom:67%;" /><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ‹‰å–å¹¶åˆå¹¶</span></span><br><span class="line">$ git pull</span><br><span class="line"><span class="comment"># æ‰‹åŠ¨è§£å†³å†²çª</span></span><br><span class="line">$ vim index.txt</span><br></pre></td></tr></table></figure><img src="/img/mics/image-20220220230555258.webp" alt="" style="zoom:67%;" /><img src="/img/mics/image-20220220230613363.webp" alt="" style="zoom:67%;" /><p>ç•™ä¸‹ä½ æƒ³è¦çš„ï¼Œå…¶ä»–åˆ é™¤å¹²å‡€ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git add .</span><br><span class="line">$ git commit -m <span class="string">&quot;final&quot;</span></span><br><span class="line">$ git push <span class="comment"># æå®š</span></span><br></pre></td></tr></table></figure><h2 id="æƒ…å¢ƒå››ï¼š">æƒ…å¢ƒå››ï¼š</h2><blockquote><p>åˆ›å»ºäº†ä¸»çº¿åˆ†æ”¯ä¸æ”¯çº¿åˆ†æ”¯ï¼Œæ”¯çº¿å¼€å‘åˆå¹¶åˆ°ä¸»çº¿</p></blockquote><p>è¿™ä¸ªå¯ä»¥ä¸¤ç§:</p><ol><li>æœ¬åœ°ä¸¤ä¸ªåˆ†æ”¯ï¼Œåœ¨ä¸»åˆ†æ”¯åˆå¹¶å¥½äº†ï¼Œç„¶åæ›´æ–°è¿œç«¯ä¸»åˆ†æ”¯</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹æœ¬åœ°åˆ†æ”¯</span></span><br><span class="line">$ git branch </span><br><span class="line"><span class="comment"># åˆ›å»ºå‰¯åˆ†æ”¯</span></span><br><span class="line">$ git checkout -b other</span><br><span class="line"><span class="comment"># åˆ é™¤ä¸»åˆ†æ”¯å†…å®¹åŠ ä¸Šè‡ªå·±æ–°çš„å†…é€š</span></span><br><span class="line">$ vim index.txt</span><br><span class="line">$ git add .</span><br><span class="line">$ git commit -m <span class="string">&quot;new&quot;</span></span><br><span class="line"><span class="comment"># åˆ‡æ¢å›ä¸»åˆ†æ”¯</span></span><br><span class="line">$ git checkout main</span><br><span class="line"><span class="comment"># åˆå¹¶åˆ†æ”¯</span></span><br><span class="line">$ git merge other</span><br><span class="line">$ git push</span><br></pre></td></tr></table></figure><ol start="2"><li>ä¸¤ä¸ªåˆ†æ”¯éƒ½ä¸Šä¼ åˆ°è¿œç«¯ï¼Œç„¶ååœ¨githubä¸Šå›¾å½¢åŒ–åˆå¹¶åˆ°ä¸»çº¿(é€šå¸¸æ˜¯å›¢é˜Ÿ)</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ git checkout ohter</span><br><span class="line">$ vim index.txt</span><br><span class="line">$ git add .</span><br><span class="line">$ git commit -m <span class="string">&quot;other&quot;</span></span><br><span class="line">$ git push --set-upstream originName other</span><br></pre></td></tr></table></figure><img src="/img/mics/image-20220220232640656.webp" alt="" style="zoom:67%;" /><img src="/img/mics/image-20220220232704906.webp" alt="" style="zoom:67%;" /><p>æ­£å¸¸æäº¤ï¼Œæ‰‹åŠ¨è§£å†³å†²çªä¿å­˜æƒ³è¦çš„</p><img src="/img/mics/image-20220220232741088.webp" alt="" style="zoom:67%;" /><img src="/img/mics/image-20220220232816828.webp" alt="æ‰‹åŠ¨è§£å†³å†²çª" style="zoom:67%;" /><p>ç„¶åä¸€è·¯ç‚¹ç‚¹ç‚¹å°±å¥½äº†ï¼Œé€šå¸¸ä¸»çº¿æ˜¯æŠ€æœ¯ç»„é•¿ï¼Œç»„å‘˜åœ¨åˆ†æ”¯æäº¤ï¼Œç»„é•¿å®¡æ ¸åˆå¹¶åˆ°ä¸»çº¿ã€‚</p><h2 id="åŸºç¡€å‘½ä»¤ï¼Œè´¦å·è®¾ç½®">åŸºç¡€å‘½ä»¤ï¼Œè´¦å·è®¾ç½®</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">$ git config --global user.name <span class="string">&#x27;&#x27;</span></span><br><span class="line">$ git config --global user.email <span class="string">&#x27;&#x27;</span></span><br><span class="line">$ git config --list --global  <span class="comment"># æäº¤çš„æ—¶å€™ä¼šçŸ¥é“æ˜¯ä½ æäº¤çš„ä»¥åŠä¼šè”ç³»ä½ </span></span><br><span class="line"></span><br><span class="line">$ git status <span class="comment"># æŸ¥çœ‹çŠ¶å†µ</span></span><br><span class="line">$ git <span class="built_in">log</span> <span class="comment"># æŸ¥çœ‹æ—¥å¿—</span></span><br><span class="line">$ git tag -a v1.2 xxx -m <span class="string">&quot;my tag&quot;</span> <span class="comment"># ç»™xxxæ‰“ä¸Šæ ‡ç­¾ä¸æè¿°</span></span><br><span class="line"></span><br><span class="line">$ git branch -v <span class="comment"># æŸ¥çœ‹åˆ†æ”¯</span></span><br><span class="line">$ git checkout -b temp d96e27d54e4aaa79e0ccc76e1023b3d489a9aced <span class="comment"># åˆ›å»ºä¸€ä¸ªå«åštempçš„ä»d96e27d54eå¼€å§‹çš„åˆ†æ”¯</span></span><br><span class="line">$ git checkout master <span class="comment"># åˆ‡æ¢åˆ†æ”¯</span></span><br><span class="line"></span><br><span class="line">$ git diff xxx xxx <span class="comment"># ä¸¤è€…è¿›è¡Œæ¯”è¾ƒ</span></span><br><span class="line">$ git diff HEAD HEAD^1^1 <span class="comment"># ä¸çˆ·çˆ·è¿›è¡Œæ¯”è¾ƒ</span></span><br><span class="line">$ git diff temp master -- readme.md <span class="comment"># å½“å‰tempåˆ†æ”¯ä¸masterè¿›è¡Œæ¯”è¾ƒ</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿™ä¸ªäººå¯ä»¥æ ¹æ®æ–°çš„åˆ†æ”¯è‡ªå·±åœ¨æœ¬åœ°åˆ›å»ºåˆ†æ”¯æ¥ç¼–è¾‘-ã€‹ æ›´æ–° -ã€‹ ä¸Šä¼  -ã€‹ æäº¤</span></span><br><span class="line">$ git fetch gitTest <span class="comment"># å°†åˆ«äººæäº¤çš„åˆ†æ”¯ä¹Ÿæ‹‰ä¸‹æ¥</span></span><br><span class="line">$ git fetch gitTest <span class="comment"># åœ¨ç¼–è¾‘å®Œåå¦‚æœè¿˜æœ‰äººç¼–è¾‘äº†è€Œä½ å³å°†æäº¤äº†å°±è¦fetch</span></span><br><span class="line">$ git merge gitTest/master <span class="comment"># æ²¡æœ‰å†²çªæ™ºèƒ½åˆå¹¶/æœ‰å†²çªè¦æ”¹</span></span><br><span class="line">$ git push</span><br></pre></td></tr></table></figure><p>ç°åœ¨æ²¡æœ‰è´¦å·ç™»é™†äº†ç„¶åè¦é…ç½®å…¬é’¥ <a href="https://docs.github.com/cn">https://docs.github.com/cn</a></p><p>ç½‘ä¸Šæ•™ç¨‹ä¸€å¤§å †ï¼Œéšä¾¿æœæœ</p>]]></content>
      
      
      <categories>
          
          <category> å¼€å‘ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Dockeræ—¥å¸¸ç©¶ç«Ÿè¦æ€ä¹ˆç”¨</title>
      <link href="/article/86cd1cda.html"/>
      <url>/article/86cd1cda.html</url>
      
        <content type="html"><![CDATA[<h2 id="Dockeræ—¥å¸¸ç©¶ç«Ÿè¦æ€ä¹ˆç”¨">Dockeræ—¥å¸¸ç©¶ç«Ÿè¦æ€ä¹ˆç”¨</h2><p>æœ€è¿‘åœ¨è€ƒC4è®¤è¯ï¼Œç»“æœæ¨¡æ‹Ÿå¡åœ¨äº†Dockeréƒ¨ç½²ã€‚æˆ‘çœŸçš„ååˆ†æ— è¯­ğŸ˜“</p><p>æˆ‘åœ¨Windowsä¸Šé¢ç¼–è¾‘çš„ï¼Œè¸©äº†å¥½å¤šå‘ï¼Œè€—äº†å¾ˆå¤šæ—¶é—´ã€‚</p><p>è¶ç€ä¸‹å‘¨è€ƒè¯•å‰æ¥å†™ä¸€ä¸‹Dockeråœ¨æ—¥å¸¸åªèƒ½å¤Ÿç©¶ç«Ÿè¦æ€ä¹ˆç”¨ï¼š</p><div class="note green icon flat"><i class="note-icon fas fa-bullhorn"></i><p>æœ¬æ–‡é¦–å‘äºåšå®¢ï¼Œè§‚æ„Ÿæ›´å¥½ :)</p><p>æˆ‘çš„Dockerè‡ªå­¦ç¬”è®° ï¼š<a href="https://blog.csdn.net/weixin_51485807/article/details/122517156">CSDNåšå®¢ï¼Œæ±‚ä¸ªèµï½</a></p></div><h2 id="ä½ èƒ½æ”¶è·ä»€ä¹ˆ">ä½ èƒ½æ”¶è·ä»€ä¹ˆ</h2><p>ä¸‹é¢è¿™4é¡¹ï¼Œé™¤äº†ç©å¤æ‚ç½‘ç»œçš„ï¼ŒåŸºæœ¬å¤Ÿäº†ã€‚</p><p>æˆ‘æŠŠä»æœ¬åœ° = &gt; äº‘ä¸Š =&gt; åˆ«çš„åœ°æ–¹ éƒ½ä¸²é€šäº†</p><ul><li>DockerFileä½¿ç”¨</li><li>Dockerä¸Šä¼ ä»“åº“</li><li>docker-composeçš„ç¼–å†™ä¸éƒ¨ç½²</li><li>å¸¸ç”¨å‘½ä»¤</li></ul><h2 id="æ›´æ–°">æ›´æ–°</h2><div class="note red icon flat"><i class="note-icon fas fa-bullhorn"></i><p>é‡æ–°å†™äº†ä¸‹DockerFileä¸docker-composeçš„æ–‡ä»¶<br>æ‰¾åˆ°äº†ç›¸æ¯”è¾ƒdepends_onç­‰å¾…Mysqlæ‰“é€šå†é“¾æ¥çš„è„šæœ¬<br>è¿™ä¸ªå¾ˆå¥½çš„è§£å†³äº† <a class="btn-beautify " href="https://github.com/Eficode/wait-for"   title="ç‚¹å‡»æŸ¥çœ‹"><i class="far fa-hand-point-right"></i><span>ç‚¹å‡»æŸ¥çœ‹</span></a></p></div><h2 id="DockerFileä½¿ç”¨">DockerFileä½¿ç”¨</h2><p>è¿™ä¸ªæ˜¯å¹²å˜›çš„ï¼Ÿ ç®€å•æ¥è¯´å°±æ˜¯ä½ åœ¨æœ¬åœ°å†™å¥½äº†æ–‡ä»¶ï¼Œç„¶åå†™ä¸ªDockerFileæ¥æ‰“é€ ä½ çš„ä¸“å±Dockerå®¹å™¨</p><p>ä¹Ÿå°±æ˜¯<code>Centos</code>ä¸Šé€ ä¸ª<code>Ubuntu</code>çš„æ„Ÿè§‰ã€‚æˆ‘æ‹¿æˆ‘çš„ä¸€ä¸ªé¡¹ç›®æ¡ˆä¾‹æ¥è¯´ä¸‹ã€‚</p><p>é¦–å…ˆå‘¢åˆ›å»ºä¸€ä¸ª<code>Dockerfile</code>æ–‡ä»¶ï¼Œå¯¹ï¼åå­—éƒ½æ˜¯æ­»çš„ï¼Œå½“ç„¶ä½ ç”¨<code>-f</code>ä¹Ÿæ˜¯è¡Œçš„ï¼Œä½†æ˜¯æˆ‘æ‡’å¾—æè·¯å¾„</p><p>å…¶æ¬¡å‘¢ï¼Œç±»ä¼¼äº <code>.gitignore</code>ä½ ä¹Ÿè¦æä¸ª<code>.dockerignore</code>è¿™æ ·å°±â€œåŠ é€Ÿâ€äº†ï¼Œå…·ä½“åŸå› è°·æ­Œä¸‹ã€‚</p><p>å¥½äº†åˆ°ç°åœ¨ä¸ºæ­¢ï¼šå¼€å§‹å†™DockerFile ç„¶å å‘½ä»¤å‚æ•°åˆ°å¤„éƒ½æ˜¯ <a href="https://jiajially.gitbooks.io/dockerguide/content/chapter_fastlearn/dockerfile_details.html">éšä¾¿æ”¾ä¸ªåœ¨è¿™é‡Œ</a></p><p>å¯¹äº†ä½ åœ¨æ‰“åŒ…å‰è®°å¾—<strong>å¼€å¯dockeræœåŠ¡</strong>å“ˆï½</p><p>ä¸‹é¢æ˜¯æˆ‘çš„ç›®å½•ğŸ‘‡ ç›®æ ‡æ˜¯æ‰“åŒ…ä¸ªFlask</p><img src="/img/mics/image-20220219231439092.webp" alt="è¿™æ˜¯æˆ‘çš„ç›®å½•" style="zoom:80%;" /><p>è¿™é‡Œæœ‰å‡ ä¸ªå¤©å‘ï¼</p><ol><li><code>COPY</code> è¿‡å»çš„è¯<strong>æ–‡ä»¶</strong>å°±ä¼šè‡ªå·±åˆ›å»ºç›¸åŒåå­—ï¼Œ<strong>æ–‡ä»¶å¤¹</strong>çš„è¯å¿…é¡»å†™ä¸€é</li><li><code>PYTHONPATH</code>å¿…é¡»æŒ‡å®šï¼Œä¸ç„¶çš„è¯å°±ä¼šè¯´æ‰¾ä¸åˆ°Pythonæ¨¡å—ï¼Œè´¼éº»çƒ¦</li><li><code>RUN</code>å°½é‡å†™ä¸€èµ·ï¼Œå°‘å»ºç«‹å±‚æ•°ï¼Œå‡å°å†…å­˜</li><li><code>CMD</code>çš„å†™æ³•ä¹Ÿè¦æ³¨æ„âš ï¸ï¼Œä¸ç„¶åªä¼šæ‰§è¡Œæœ€åä¸€ä¸ª</li></ol><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> python:<span class="number">3.9</span>.<span class="number">5</span>-slim</span><br><span class="line"><span class="keyword">WORKDIR</span><span class="bash"> /pythonApp</span></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> requirements.txt /pythonApp</span></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> utils /pythonApp/utils</span></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> src /pythonApp/src</span></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> repo /pythonApp/repo</span></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> model /pythonApp/model</span></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> flaskApp /pythonApp/flaskApp</span></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> __init__.py /pythonApp</span></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> wait-for /</span></span><br><span class="line"><span class="keyword">ENV</span> FLASK_APP=/pythonApp/flaskApp/app.py</span><br><span class="line"><span class="keyword">ENV</span> PYTHONPATH /pythonApp</span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">8080</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> pip install --upgrade pip &amp;&amp; \</span></span><br><span class="line"><span class="bash">    pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple &amp;&amp; \</span></span><br><span class="line"><span class="bash">    apt-get -q update &amp;&amp; \</span></span><br><span class="line"><span class="bash">    apt-get -qy install netcat</span></span><br></pre></td></tr></table></figure><hr><p>å¼€å§‹éƒ¨ç½²æ‰“é€ è‡ªå·±çš„ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ docker build -t csdn:v0.2 . <span class="comment"># &lt;åå­—&gt;:&lt;ç‰ˆæœ¬&gt; . &lt;= æ³¨æ„è¿™ä¸ªç‚¹</span></span><br><span class="line"></span><br><span class="line">$ docker image ls <span class="comment"># å°±èƒ½çœ‹åˆ°äº† cfdac878807f ä¸ºcsdnçš„</span></span><br><span class="line"></span><br><span class="line">$ docker container run -d -p 8080:8080 cfdac878807f <span class="comment"># åå°å¼€å¯ä¸ªcontainer</span></span><br><span class="line"></span><br><span class="line">$ docker container <span class="built_in">exec</span> -it cfdac878807f sh <span class="comment"># äº¤äº’å¼è¿›å…¥å®¹å™¨</span></span><br></pre></td></tr></table></figure><h2 id="Dockerä¸Šä¼ ä»“åº“">Dockerä¸Šä¼ ä»“åº“</h2><p>ä½ æ‰“é€ å‡ºäº†è‡ªå·±çš„å®¹å™¨ï¼Œè‡ªå·±åœ¨æœ¬åœ°ç”¨è‚¯å®šä¸å¤Ÿï¼Œæ”¾åˆ°äº‘ä¸Šï¼Œåˆ«äººä¹Ÿèƒ½ç”¨å¯¹å§ï½</p><p>é¦–å…ˆåˆ°ä»“åº“é‡Œé¢åˆ›å»ºä»“åº“ <a href="https://hub.docker.com/repositories">https://hub.docker.com/repositories</a></p><img src="/img/mics/image-20220219233253507.webp" alt="åˆ›å»ºæ•ˆæœ" style="zoom:50%;" /><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ docker login <span class="comment"># ç„¶åæœ¬åœ°ç™»é™†ä¸‹éªŒè¯ä¸‹ä½ æ˜¯ä½ å°±å¥½äº†</span></span><br><span class="line"></span><br><span class="line">$ docker tag cfdac878807f &lt;hub-user&gt;/&lt;repo-name&gt;[:&lt;tag&gt;] <span class="comment"># ç»™ä½ å°†è¦ä¸Šä¼ çš„æ‰“ä¸Šæ ‡ç­¾</span></span><br><span class="line"></span><br><span class="line">$ docker push &lt;hub-user&gt;/&lt;repo-name&gt;:&lt;tag&gt; <span class="comment"># ä¼ åˆ°å“ªä¸ªä»“åº“å» ä¸å†™Tagå°±æ˜¯æœ€æ–°çš„</span></span><br></pre></td></tr></table></figure><p>åˆ°è¿™é‡Œåªè¦æœ‰ç½‘å°±èƒ½éƒ¨ç½²ä½ çš„ã€‚</p><h2 id="docker-composeçš„ç¼–å†™ä¸éƒ¨ç½²">docker-composeçš„ç¼–å†™ä¸éƒ¨ç½²</h2><p>è¿™ä¸ª<code>docker-compose</code>åˆæ˜¯å¹²å˜›çš„ï¼Ÿ è¿™ä¸ªæ˜¯ä½ ç»™åˆ«äººçš„ï¼Œåˆ«äººæœ‰ä½ è¿™ä¸ª</p><p>å°±èƒ½é©¬ä¸Šæ­å»ºå‡ºä½ æƒ³ç»™ä»–çš„ç¯å¢ƒã€‚ç±»ä¼¼äºshè„šæœ¬ï¼Œå¾ˆå¿«å°±åœ¨å¦å¤–æœºå™¨ä¸Šéƒ¨ç½²ç›¸åŒç¯å¢ƒã€‚</p><p>åå­—ä¹Ÿæ˜¯å†™æ­»çš„ <code>docker-compose.yml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;2&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">mysql:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">mysql:5.7.31</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="attr">small:</span></span><br><span class="line">        <span class="attr">ipv4_address:</span> <span class="number">172.19</span><span class="number">.0</span><span class="number">.3</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_ROOT_PASSWORD=root</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;3306:3306&quot;</span></span><br><span class="line">    <span class="attr">command:</span> <span class="string">--character-set-server=utf8mb4</span> <span class="string">--collation-server=utf8mb4_unicode_ci</span></span><br><span class="line">  <span class="attr">web:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">hengyisky/daily:v0.1</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="attr">small:</span></span><br><span class="line">        <span class="attr">ipv4_address:</span> <span class="number">172.19</span><span class="number">.0</span><span class="number">.4</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">&quot;8080:8080&quot;</span></span><br><span class="line">    <span class="attr">links:</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">mysql:mysql</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">mysql</span></span><br><span class="line">    <span class="attr">command:</span> <span class="string">sh</span> <span class="string">-c</span> <span class="string">&#x27;/wait-for mysql:3306 -- python /pythonApp/src/app.py; python /pythonApp/flaskApp/run.py&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">networks:</span></span><br><span class="line">  <span class="attr">small:</span></span><br><span class="line">    <span class="attr">driver:</span> <span class="string">bridge</span></span><br><span class="line">    <span class="attr">ipam:</span></span><br><span class="line">     <span class="attr">config:</span></span><br><span class="line">       <span class="bullet">-</span> <span class="attr">subnet:</span> <span class="number">172.19</span><span class="number">.0</span><span class="number">.0</span><span class="string">/16</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œå°±æ˜¯å§ mysql ä¸è‡ªå·±çš„ç¯å¢ƒéƒ¨ç½²åˆ°ä¸€ä¸ªå­ç½‘é‡Œé¢ï¼Œç„¶åæš´éœ²ç«¯å£ç›´æ¥ç”¨å°±è¡Œäº†ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ docker-compose pull <span class="comment"># æ‹‰å–éœ€è¦çš„image</span></span><br><span class="line"></span><br><span class="line">$ docker-compose up -d --build <span class="comment"># åå°å¯åŠ¨äº†ç›´æ¥ç”¨</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯¹äºå·²ç»åœ¨è¿è¡Œçš„containerï¼Œæ›´æ”¹äº†æœ¬åœ°çš„æ–‡ä»¶ä¹‹åå‘¢è¿˜æ˜¯å¯ä»¥ç»§ç»­ä½¿ç”¨ docker-compose up -d --build</span></span><br></pre></td></tr></table></figure><h2 id="å¸¸ç”¨å‘½ä»¤">å¸¸ç”¨å‘½ä»¤</h2><p>é™¤äº†ä¸Šé¢çš„å‘½ä»¤ï¼›</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ docker container run -d -p 80:80 nginx <span class="comment"># åå°è¿è¡Œåˆ›å»ºä¸€ä¸ªnginxå®¹å™¨</span></span><br><span class="line"></span><br><span class="line">$ docker run -it $(name) <span class="comment"># æ‰§è¡Œå®¹å™¨ä¸­çš„é»˜è®¤è„šæœ¬</span></span><br><span class="line"></span><br><span class="line">$ docker container <span class="built_in">exec</span> -it $(id) sh <span class="comment"># äº¤äº’å¼è¿›å…¥å®¹å™¨</span></span><br><span class="line"></span><br><span class="line">$ docker system prune -f <span class="comment"># åˆ é™¤æ‰€æœ‰å·²ç»åœæ­¢çš„å®¹å™¨</span></span><br><span class="line"></span><br><span class="line">$ docker image prune -a <span class="comment"># åˆ é™¤æ‰€æœ‰æ²¡æœ‰ä½¿ç”¨çš„é•œåƒ</span></span><br></pre></td></tr></table></figure><p>å…¶å®å§ï¼š<code>Docker DeskTop</code>å·²ç»å¯ä»¥å®ç°ç‚¹ç‚¹ç‚¹äº†ã€‚  <a href="https://www.docker.com/products/docker-desktop">https://www.docker.com/products/docker-desktop</a></p><img src="/img/mics/image-20220219234504845.webp" alt="image-20220219234504845" style="zoom:50%;" />]]></content>
      
      
      <categories>
          
          <category> å¼€å‘ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>æ•°å­—å–è¯ç©¶ç«Ÿæ€ä¹ˆå…¥é—¨</title>
      <link href="/article/8679ce28.html"/>
      <url>/article/8679ce28.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€ï¼š-8">å‰è¨€ï¼š</h2><p>æ•°å­—å–è¯ï¼ŒåŸºæœ¬éƒ½æ˜¯<strong>å®‰å…¨æ–¹å‘</strong>çš„å°ä¼™ä¼´å…³å¿ƒçš„æ¯”èµ›ã€‚åƒ<strong>é•¿å®‰æ¯,ç¾äºšæ¯</strong>ç­‰éƒ½æ¯”è¾ƒå‡ºåçš„ã€‚</p><p>ä½†æ˜¯<strong>å…¥é—¨éš¾</strong>æ˜¯ä¸ªé—®é¢˜ï¼Œä»¥åŠå¦‚ä½•è¯·æ•™ï¼Œå¦‚ä½•å­¦ä¹ éƒ½æ˜¯ä¸€è„¸æ‡µé€¼ï½</p><p>æ€»ç»“äº†ä¸‹é«˜æ ¡èµ›çš„å‚èµ›é€‰æ‰‹åŸºæœ¬ä¸Šæ˜¯è­¦å¯Ÿå­¦é™¢ğŸ‘®â€â™€ï¸ï¼Œç½‘å®‰äººå‘˜ğŸ¦§ï¼Œå®‰å…¨çˆ±å¥½è€…ã€‚</p><p>æˆ‘åœ¨CSNDä¸Šå‘å¸ƒçš„<a href="https://blog.csdn.net/weixin_51485807/article/details/121088494">2021å¹´é•¿å®‰æ¯è§‚çœ‹è§†é¢‘å¤ç›˜æ„Ÿæƒ³</a>ï¼Œä¼š<strong>ç»å¸¸æœ‰äººç§ä¿¡æˆ‘è¦æ£€æèµ„æ–™</strong>ã€‚</p><p>æˆ‘å°±æƒ³ç›´æ¥å¼€ä¸ªä»“åº“ï¼Œä¸€å£æ°”å­¦ä¹ æå®šå…¥é—¨ã€‚</p><div class="note green icon flat"><i class="note-icon fas fa-bullhorn"></i><p>ä»¥ä¸Šä»“åº“å‡ç”±@<strong>HengY1</strong> ä¸ªäººç»´æŠ¤ï¼Œæ¬¢è¿å¤§å®¶æå‡ºè‡ªå·±çœ‹æ³•ã€‚</p><p>äº¤æµä¸è¡¥å……çš„è¯ç›´æ¥å¼€Pr/issueä¸€èµ·è®¨è®ºã€‚æœ€åæ±‚ä¸ªç‚¹èµ/starâœ¨</p></div><hr><h2 id="ä½ èƒ½æ”¶è·ä»€ä¹ˆï¼Ÿ">ä½ èƒ½æ”¶è·ä»€ä¹ˆï¼Ÿ</h2><p>ç°åœ¨éƒ½è®²ç©¶çš„æ˜¯å¿«é¤æ–‡åŒ–ï¼Œæˆ‘ç›´æ¥æŠŠè¯¥<strong>ä»“åº“çš„å¤§ä½“å†…å®¹å†™å‡ºæ¥</strong>ï¼Œç›´æ¥çœ‹æœ‰ä¸æœ‰éœ€è¦çš„ã€‚</p><p>å…·ä½“è¯¦æƒ…<strong>ç‚¹å‡»æŒ‰é’®è¿›è¡Œè·³è½¬åˆ°ä»“åº“é‡Œé¢æŸ¥çœ‹</strong>ã€‚ <a class="btn-beautify " href="https://github.com/HengY1Sky/Where-Is-Evidence"   title="ç‚¹å‡»æŸ¥çœ‹ä»“åº“åŠç›¸å…³èµ„æ–™"><i class="far fa-hand-point-right"></i><span>ç‚¹å‡»æŸ¥çœ‹ä»“åº“åŠç›¸å…³èµ„æ–™</span></a></p><p>å³é€šè¿‡æœ¬ä»“åº“ï¼Œä½ å¯ä»¥è·å¾—ï¼š</p><ul><li><p>ä¸ªäºº<strong>æ¯”èµ›ç»éªŒ</strong>åˆ†äº«</p></li><li><p><strong>æ£€æ</strong>åˆ†äº«ï¼Œä¸Šæ‰‹å®æˆ˜</p></li><li><p><strong>å¤ç›˜</strong>è§†é¢‘æ”¶é›†ä¸åˆ†äº«</p></li><li><p>å®˜æ–¹/æ°‘é—´/ä¸ªäºº<strong>WriteUp</strong></p></li><li><p>æ¯”èµ›æˆ‘ç©¶ç«Ÿè¦<strong>æŒæ¡ä»€ä¹ˆ</strong></p></li><li><p>ç©¶ç«Ÿè¦ç”¨ä»€ä¹ˆ<strong>å·¥å…·</strong>æ¥åš</p></li></ul><hr><h2 id="ä¸ªäººæ¯”èµ›ç»éªŒåˆ†äº«">ä¸ªäºº<strong>æ¯”èµ›ç»éªŒ</strong>åˆ†äº«</h2><p>æˆ‘ä¸ªäººç®—æ˜¯ä¸ªå…¸å‹ä¾‹å­ï¼Œ<strong>æœ‰å·…å³°æœ‰æ»‘é“å¢</strong>ã€‚</p><details>  <summary>è¯·å¬æˆ‘å¨“å¨“é“æ¥</summary><ol><li><p>å…ˆè¯´ä¸‹é…ç½®é—®é¢˜ï¼Œé¦–å…ˆä½ å¾—å‡†å¤‡ä¸ª<code>1T</code>ç¡¬ç›˜ï¼Œä¿è¯åŸºæœ¬çš„ç¡¬ç›˜è¯»å†™é—®é¢˜ã€‚ç”µè„‘çš„è¿è¡Œå†…å­˜æœ€å¥½åˆ°<code>16G</code>,ä¸ç„¶ä½ å¼€ä¸ªå¤šä¸ªè™šæ‹Ÿæœºå°±æ˜¯å¼Ÿä¸­å¼Ÿäº†ã€‚</p></li><li><p>åœ¨æ¥è¯´æ¯”èµ›å‰å§ï¼Œé¦–å…ˆèµ›å‰çš„è¯å°±æ˜¯å»åš<strong>å¾€å¹´çš„é¢˜</strong>ï¼Œä¹Ÿå°±æ˜¯æ‹¿ç€Wpå’Œæ£€æå»å¤ç›˜ã€‚è·Ÿç€åˆ«äººçš„ç­”æ¡ˆå»æ‰¾é¢˜çš„ç­”æ¡ˆï¼Œç„¶åæ€»ç»“æ€ä¹ˆåšå°±å¥½äº†ã€‚ç„¶åæˆ‘å°±è¢«2020å¹´çš„ç¾äºšæ¯ç»™å‘äº†ï¼Œå› ä¸º2021å¹´çš„ç¾äºšæ¯æ¢äº†å¾ˆå¤šå½¢å¼ï¼Œåšçš„æˆ‘ä¹±äº†æ‰‹è„šï¼Œå°±æ„Ÿè§‰é¢˜ä¸æ˜¯é¢˜ä¸€æ ·ã€‚å†å»å¤šçœ‹çœ‹åˆ«äººå‘çš„è§†é¢‘ï¼Œè§†é¢‘å¸¦ç€åšé‚£å¤šå¥½çš„æ˜¯å§ï¼Œåˆ°è¿™é‡ŒåŸºæœ¬ä¸Šèµ›å‰èŠ±æ—¶é—´å°±çŸ¥é“ä¸ªå¤§æ¦‚äº†ã€‚</p></li><li><p>æ¯”èµ›ä¸­ï¼Œè·Ÿé˜Ÿå‹å¥½å¥½æ²Ÿé€šï¼Œç„¶åå¤šè¯»é¢˜ï¼Œåˆ«æ€¥ç€æäº¤ï¼Œé¢˜å¤šçš„è¯å°±å…ˆåˆ†å¥½å·¥ã€‚ç„¶åé˜Ÿå‹ä¹‹é—´çš„å®åŠ›å·®è·ä¸è¦å¤ªå¤§ï¼Œä¸ç„¶å¾ˆå®¹æ˜“è„±èŠ‚ã€‚ç„¶ååƒä¸‡åˆ«å¿ƒæ€å´©æºƒï¼Œåƒä¸‡åˆ«å¿ƒæ€å´©æºƒï¼Œåƒä¸‡åˆ«å¿ƒæ€å´©æºƒã€‚å…ˆæŠŠè‡ªå·±æ“…é•¿çš„ä¼šçš„åšäº†ã€‚ç„¶åæ¨èçš„è§£é¢˜æ˜¯ï¼šLinux/Mac/æ‰‹æœº/USB/Windowsã€‚å…ˆä¿è¯ä¼šçš„ç„¶åWindowså¾€åç§»åŠ¨ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºä½ æ‹¿å·¥å…·æ‰«äº†WindowsåŸºæœ¬ä¸Šæ‰«äº†ä¸ªå¯‚å¯ï¼ŒåŸºæœ¬ä¸Šè¦å¼€è™šæ‹Ÿæœºè¿›å»çœ‹ï¼ŒåŸºæœ¬ä¸Šä½ çš„ç”µè„‘ä¼šå¾ˆå¡ï¼Œæ‡‚å—ï¼Ÿæœ¬èº«æ£€æå¼€çš„å¤Ÿå¤šäº†ï¼Œè½¯ä»¶å¼€çš„å¤Ÿå¤šäº†ï¼Œä½ å†æ¥ä¸ªWindowsè™šæ‹Ÿæœºã€‚å“¦è±ï½</p></li><li><p>èµ›åå¥½å¥½å¤ç›˜ï¼Œå‡†å¤‡ä¸‹ä¸€åœºæ¯”èµ›ï¼ŒåŠæ—¶æ”¶é›†æœ€æ–°æ¶ˆæ¯ã€‚</p></li><li><p>2021å¹´çš„é•¿å®‰æ¯æ˜¯æˆ‘ç¬¬ä¸€æ¬¡æ­£å¼æ¯”èµ›ï¼Œæ¯”èµ›çš„å†…å®¹åŸºæœ¬ä¸Šéƒ½æ˜¯æˆ‘å¹³æ—¶åœ¨ç”¨çš„æ¡†æ¶å‘€ä»€ä¹ˆçš„ã€‚åšé¢˜å°±æ˜¯å—–å—–çš„ç§’æ€ã€‚ä½†æ˜¯2021å¹´çš„ç¾äºšæ¯å°±æ˜¯æˆ‘çš„æ»‘é“å¢äº†ã€‚æˆ‘è¦åæ§½çš„åœ°æ–¹å¤ªå¤šäº†ã€‚é¦–å…ˆä»–è¯´ä»€ä¹ˆè¦å½•åƒå¥½å˜›æ²¡å•¥é—®é¢˜ï¼Œå…³é”®æ˜¯è¦ç”¨ä¸ªä»–ç»™ä½ çš„è½¯ä»¶ï¼Œè¿™ä¸ªè½¯ä»¶ä¼šè‡ªåŠ¨æ€æ‰ä½ çš„QQï¼Œå¾®ä¿¡ï¼Œé’‰é’‰å•¥çš„ï¼Œç„¶åæ¯”èµ›è¿˜ä¸èƒ½çœ‹æ‰‹æœºï¼Œå…³é”®çš„æ¥äº†ï¼å®ƒå¯†ç å¤ªé•¿å®˜æ–¹ç»™ä½ çš„è§£å‹å¯†ç æ˜¯é”™çš„ï¼Œç„¶åå®˜æ–¹ä¹Ÿä¸è¯´ï¼Œç­‰äººååº”ï¼Œè¿™ä¸‹å¥½äº†20åˆ†é’Ÿå¤šåˆ†é’Ÿäº†ï¼Œå®˜æ–¹æ¢äº†å¯†ç ï¼Œç»“æœè¿˜æ˜¯é”™çš„ï¼Œæœ€åæˆ‘æ˜¯å®åœ¨æ†‹ä¸ä½é—®äº†åˆ«äººï¼Œæ²¡æœ‰é€šè®¯å·¥å…·ï¼Œç„¶åå¯†ç å¤ªé•¿æˆ‘ä¸€ä¸ªä¸ªæ•²ä¸Šå»äº†ï¼Œåˆ°è§£å‹å‡ºèµ„æ–™ï¼Œ40åˆ†é’Ÿå·²ç»è¿‡å»äº†â€¦ ç„¶åå¼€å§‹æ˜¯åˆ†ææ‰‹æœºï¼Œæˆ‘æ‹¿å‡ºç«çœ¼å‘ç°åˆ†æä¸ªå¯‚å¯ï¼Œæ ¹æœ¬æ‰«ä¸åˆ°ææ–™ã€‚ç»“æœæ•´äº†åŠå¤©è¿›å»å‘ç°å†…ç½®äº†åˆ†æå™¨ï¼Œè¿›å»è¿˜å…¨æ˜¯è‹±æ–‡ï¼Œåˆæ•´äº†åŠå¤©ç»ˆäºæ¢æˆäº†ä¸­æ–‡ã€‚åˆ°è¿™é‡Œæˆ‘æ˜¯å½»åº•ä¸æƒ³æ‰“äº†ï¼Œæ•´ä¸ªæ¯”èµ›ç»“æŸï¼Œæˆ‘è¿Linuxçš„é¢˜éƒ½æ²¡æ‘¸åˆ°â€¦ ä¸‹åˆé˜Ÿå‹å°‘äº†ä¸€ä¸ªï¼Œæ²¡å•¥æƒ³æ³•äº†ã€‚<s>ï¼ˆçœ‹æ¥ç«çœ¼</s><s>é’±æ²¡ç»™å¤Ÿå•Šï¼‰</s>ã€‚</p></li></ol></details><hr><h2 id="å†å¹´æ£€æåˆ†äº«">å†å¹´æ£€æåˆ†äº«</h2><blockquote><ol><li>Vc containerçš„æŒ‚è½½å¯†ç æ˜¯æŒ‡ä½ è¾“å…¥è¿›å»åï¼Œä½ çš„ç”µè„‘å°±å¤šäº†ä¸ªæŒ‡å®šçš„ç›˜</li><li>å¤šä¸ªå‹ç¼©æ–‡ä»¶åˆå¹¶ä½¿ç”¨7zå¤šé€‰å³é”®åˆå¹¶è§£å‹ï¼Œè¾“å…¥å¯†ç å°±ä¸‹æ¥å®Œæ•´çš„</li></ol></blockquote><p>2021å¹´ç¾äºšæ¯çš„è§£å‹å¯†ç ç»Ÿä¸€ä¸ºï¼š <code>MeiyaCup2021</code></p><p>æ¨¡æ‹Ÿç»ƒä¹ æ­é…ï¼š<a href="https://forensics.xidian.edu.cn/">https://forensics.xidian.edu.cn/</a> ä½¿ç”¨</p><table><thead><tr><th style="text-align:center">åç§°</th><th style="text-align:center">é“¾æ¥</th><th style="text-align:center">æå–ç </th><th style="text-align:center">è§£å‹å¯†ç /æŒ‚è½½å¯†ç </th></tr></thead><tbody><tr><td style="text-align:center">2021å¹´é•¿å®‰æ¯</td><td style="text-align:center"><a href="https://www.aliyundrive.com/s/bfkLNmRXs7i">https://www.aliyundrive.com/s/bfkLNmRXs7i</a></td><td style="text-align:center">æ— </td><td style="text-align:center"><a href="http://xn--2021CAB-changancup-k412af99rtsxh.com">2021ç¬¬ä¸‰å±ŠCAB-changancup.com</a></td></tr><tr><td style="text-align:center">2021å¹´ç¾äºšæ¯ä¸ªäººèµ›</td><td style="text-align:center"><a href="https://pan.baidu.com/s/15kQsiW1h_Onjl3dxokNHzA">https://pan.baidu.com/s/15kQsiW1h_Onjl3dxokNHzA</a></td><td style="text-align:center">dv2g</td><td style="text-align:center">HfsCk]&lt;eUqc5Q{(DG$ugiGlt8ezGdaZ&gt;!pQC-H\5BAc^gBo/^qq)/i2lufiN@H&quot;Y</td></tr><tr><td style="text-align:center">2021å¹´ç¾äºšæ¯å›¢é˜Ÿèµ›</td><td style="text-align:center"><a href="https://pan.baidu.com/s/1Rj1r8jnMIiBfGXK-lyS7DQ">https://pan.baidu.com/s/1Rj1r8jnMIiBfGXK-lyS7DQ</a></td><td style="text-align:center">jii2</td><td style="text-align:center">uR%{)Yâ€™Qz-n3oGU`ZJo@(1ntxp8U1+bW;JlZH^I4%0rxf;[N+eQ)Lolrw&amp;E%,4q1</td></tr></tbody></table><h2 id="å¤ç›˜è§†é¢‘">å¤ç›˜è§†é¢‘</h2><table><thead><tr><th style="text-align:center">åç§°</th><th style="text-align:center">é“¾æ¥</th></tr></thead><tbody><tr><td style="text-align:center">2021å¹´é•¿å®‰æ¯å®Œæ•´å¤ç›˜</td><td style="text-align:center"><a href="https://www.bilibili.com/video/BV1hP4y1b7Vj">https://www.bilibili.com/video/BV1hP4y1b7Vj</a></td></tr><tr><td style="text-align:center">2021å¹´ç¾äºšæ¯ç©¿æ’å¤ç›˜</td><td style="text-align:center"><a href="https://mudu.tv/live/watch/general?id=lj71nj2l">https://mudu.tv/live/watch/general?id=lj71nj2l</a></td></tr></tbody></table><h2 id="WriteUp">WriteUp</h2><ul><li><strong>XDforensics-Wiki</strong> ä¸Šçš„çœŸé¢˜WriteUp ï¼š<a href="https://forensics.xidian.edu.cn/wiki/Zello&amp;Xeno/">https://forensics.xidian.edu.cn/wiki/Zello&amp;Xeno/</a></li></ul><table><thead><tr><th style="text-align:center">åç§°</th><th style="text-align:center">é“¾æ¥</th></tr></thead><tbody><tr><td style="text-align:center">2021å¹´ç¾äºšæ¯ä¸ªäººèµ›Write-up</td><td style="text-align:center"><a href="https://mp.weixin.qq.com/s/brTWF2bCTQb-2yH457-C_A">https://mp.weixin.qq.com/s/brTWF2bCTQb-2yH457-C_A</a></td></tr><tr><td style="text-align:center">2019å¹´é•¿å®‰æ¯Write-up</td><td style="text-align:center"><a href="https://github.com/HengY1Sky/Where-Is-Evidence/blob/main/2019%E9%95%BF%E5%AE%89%E6%9D%AFWp.md">Githubä»“åº“</a></td></tr><tr><td style="text-align:center">2020å¹´é•¿å®‰æ¯Write-up</td><td style="text-align:center"><a href="https://github.com/HengY1Sky/Where-Is-Evidence/blob/main/2020%E9%95%BF%E5%AE%89%E6%9D%AFWp.md">Githubä»“åº“</a></td></tr><tr><td style="text-align:center">2021å¹´é•¿å®‰æ¯Write-up</td><td style="text-align:center"><a href="https://github.com/HengY1Sky/Where-Is-Evidence/blob/main/2021%E5%B9%B4%E9%95%BF%E5%AE%89%E6%9D%AFWp.md">Githubä»“åº“</a></td></tr><tr><td style="text-align:center">2021å¹´é•¿å®‰æ¯è§‚çœ‹è§†é¢‘å¤ç›˜æ„Ÿæƒ³</td><td style="text-align:center"><a href="https://github.com/HengY1Sky/Where-Is-Evidence/blob/main/2021%E5%B9%B4%E9%95%BF%E5%AE%89%E6%9D%AF%E8%A7%82%E7%9C%8B%E8%A7%86%E9%A2%91%E5%A4%8D%E7%9B%98%E6%84%9F%E6%83%B3.md">Githubä»“åº“</a></td></tr><tr><td style="text-align:center">ç¬¬ä¸ƒå±Šâ€œç¾äºšæ¯â€å–è¯å°ç¨‹åºè§£é¢˜å¤ç›˜å›é¡¾ç¬¬ä¸€æœŸ</td><td style="text-align:center"><a href="https://mp.weixin.qq.com/s/hLOeiD2fbSb8K63-q8t6Rw">https://mp.weixin.qq.com/s/hLOeiD2fbSb8K63-q8t6Rw</a></td></tr><tr><td style="text-align:center">ç¬¬ä¸ƒå±Šâ€œç¾äºšæ¯â€è§£é¢˜å¤ç›˜å›é¡¾ç¬¬äºŒæœŸ</td><td style="text-align:center"><a href="https://mp.weixin.qq.com/s/K1_OZdo9V0wRro1zwhAIIw">https://mp.weixin.qq.com/s/K1_OZdo9V0wRro1zwhAIIw</a></td></tr><tr><td style="text-align:center">ç¬¬ä¸ƒå±Šâ€œç¾äºšæ¯â€è§£é¢˜å¤ç›˜å›é¡¾ç¬¬ä¸‰æœŸ</td><td style="text-align:center"><a href="https://mp.weixin.qq.com/s/YFmHxmZydxejXLwU1oYewQ">https://mp.weixin.qq.com/s/YFmHxmZydxejXLwU1oYewQ</a></td></tr></tbody></table><h2 id="èƒ½åŠ›è¦æ±‚">èƒ½åŠ›è¦æ±‚</h2><p>è€åŸºç¡€ä¸‰ä»¶å¥—ï¼š Mysql + Apache + Php</p><p>å‰ç«¯ä¸‰ä»¶å¥—ï¼š Html + CSS + Js</p><p>æŒæ¡ï¼šPythonï¼›Phpï¼›Javaï¼›JavaScriptï¼›Golong</p><p>*Linuxæ“ä½œç†Ÿç»ƒ  *Mysqlæ“ä½œç†Ÿç»ƒ</p><p>æ€»çš„æ¥è¯´ä» <strong>LinuxåŸºç¡€/ç¼–ç¨‹è¯­è¨€çš„åŸºç¡€</strong> =&gt; <strong>åŠŸèƒ½å®ç°/æ¡†æ¶æŒæ¡</strong></p><p>å­¦çš„è¶Šå¤šï¼Œä½ ä¼šå‘ç°ä½ è¶Šæ˜¯å•¥ä¸æ˜¯ï½</p><h2 id="å¿…å¤‡å·¥å…·">å¿…å¤‡å·¥å…·</h2><p><strong>åˆ†æè½¯ä»¶ä½ ä¸ªäººæ˜¯ä¸‹è½½ä¸åˆ°çš„</strong>ï¼Œå«è€å¸ˆè”ç³»å¯¹åº”å…¬å¸çš„äºº</p><p>ä¸Šäº¤ä½ ä»¬çš„å­¦ç”Ÿè¯ç…§ç‰‡ä¼š<strong>å‘è´¦å·æƒé™ä¸‹æ¥/å¯†é’¥ä¸‹æ¥</strong></p><p>è½¯ä»¶ä½¿ç”¨æ˜¯æœ‰æ—¶é—´é™åˆ¶çš„ï¼Œä¸”ç”¨ä¸”çæƒœ</p><table><thead><tr><th style="text-align:center">åç§°</th><th style="text-align:center">è¯„ä»·</th><th style="text-align:center">è¯´æ˜ä¹¦</th></tr></thead><tbody><tr><td style="text-align:center">ç«çœ¼åˆ†æ</td><td style="text-align:center">åˆ†ææ‰‹æœºæ˜¯çœŸçš„å¥½ç”¨</td><td style="text-align:center"><a href="https://github.com/HengY1Sky/Where-Is-Evidence/blob/main/%E7%81%AB%E7%9C%BC%E6%89%8B%E6%9C%BA%E5%8F%96%E8%AF%81%E8%AF%B4%E6%98%8E%E4%B9%A6.pdf">https://github.com/HengY1Sky/Where-Is-Evidence/blob/main/ç«çœ¼æ‰‹æœºå–è¯è¯´æ˜ä¹¦.pdf</a></td></tr><tr><td style="text-align:center">ç«çœ¼ä»¿çœŸ</td><td style="text-align:center">è™šæ‹Ÿæœºä¸“ç”¨ï¼Œç»•å¯†ç å•¥çš„æŒºå¥½ç”¨çš„</td><td style="text-align:center"><a href="https://github.com/HengY1Sky/Where-Is-Evidence/blob/main/%E7%81%AB%E7%9C%BC%E4%BB%BF%E7%9C%9F%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E%E4%B9%A6.pdf">https://github.com/HengY1Sky/Where-Is-Evidence/blob/main/ç«çœ¼ä»¿çœŸä½¿ç”¨è¯´æ˜ä¹¦.pdf</a></td></tr><tr><td style="text-align:center">å–è¯å¤§å¸ˆ</td><td style="text-align:center">Window/Linuxåˆ†ææ¯”ç«çœ¼å…¨ï¼Œå°å·¥å…·å¤š</td><td style="text-align:center">æš‚æ— </td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Jsé€†å‘ç»ƒä¹ åˆ¶é€ Tokenä¸Id</title>
      <link href="/article/6d98b2b4.html"/>
      <url>/article/6d98b2b4.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€ï¼š-3">å‰è¨€ï¼š</h2><p>é—²æ¥æ— èŠï¼ŒæŠŠã€ŠPyhton3ç½‘ç»œçˆ¬è™«å¼€å‘å®æˆ˜(ç¬¬äºŒç‰ˆ)ã€‹çœ‹å®Œäº†Jsé€†å‘éƒ¨åˆ†ã€‚</p><p>æœ€åçš„å®æˆ˜éƒ¨åˆ†æ„Ÿè§‰æŒºæœ‰æŒ‘æˆ˜æ€§çš„ï¼Œæ­£å¥½å´”ä½¬ä¹Ÿæœ‰è¯¦ç»†çš„æ•™ç¨‹ã€‚</p><p>å¹³æ—¶çš„é€†å‘éƒ½æ˜¯é‡è·¯å­ï¼Œåˆšå¥½å¿«å›å­¦æ ¡äº†æœ‰æ—¶é—´ã€‚</p><p>é‚£ä¸ºä»€ä¹ˆä¸è‡ªå·±åŠ¨æ‰‹ä¸‹å‘¢ï¼Ÿä¸‹é¢è®°å½•ä¸‹è¿‡ç¨‹ï¼Œåªä¼šæ›´åŠ è¯¦ç»†ã€‚</p><h2 id="è§‚å¯Ÿé¡µé¢ï¼š">è§‚å¯Ÿé¡µé¢ï¼š</h2><p>åºŸè¯ä¸å¤šè¯´ï¼Œç›´æ¥ä¸Šé¶åœºï¼š<a href="https://spa6.scrape.center">https://spa6.scrape.center</a></p><p>æˆ‘ä»¬çš„ç›®æ ‡æ˜¯ï¼š1.æ‹¿åˆ°åˆ—è¡¨é¡µçš„è¯·æ±‚Ajaxçš„TokenåŠ å¯† 2. è¯¦æƒ…é¡µçš„IdåŠ å¯†ä¸Token</p><p><img src="/img/JsReverse/58413655a0d3b23bf06dc701444e3435.webp" alt=""></p><img src="/img/JsReverse/image-20220210220457469.webp" alt="" width=90% /><p>æŸ¥çœ‹ç½‘é¡µæºç å¯ä»¥çœ‹åˆ°ï¼šå¾ˆå¼ºçƒˆçš„Vueæ‰“åŒ…å‡ºæ¥çš„æ ·å­ï¼Œå³ä½¿ç”¨çš„ä½¿ç”¨<code>SPA</code>é¡µé¢</p><img src="/img/JsReverse/image-20220210220720322.webp" alt="" width=90% /><p>è§‚å¯ŸJsä¹Ÿä¼šå‘ç°ï¼Œä»£ç å‹ç¼©ï¼Œå˜é‡åå­—åå…­è¿›åˆ¶è½¬æ¢ã€‚</p><img src="/img/JsReverse/image-20220210220948065.webp" alt="" width=90% /><p>å¥½äº†æˆ‘ä»¬å°†ä»»åŠ¡è¿›è¡Œæ‹†åˆ†ï¼Œå…ˆæ‹¿åˆ°åˆ—è¡¨é¡µé¢çš„åŠ å¯†è§„åˆ™ï¼Œå³å»è¯·æ±‚åˆ—è¡¨çš„tokenæ€ä¹ˆæåˆ°çš„</p><h2 id="è·å–åˆ—è¡¨é¡µé¢ï¼š">è·å–åˆ—è¡¨é¡µé¢ï¼š</h2><p>ä½¿ç”¨Ajaxæ–­ç‚¹ï¼Œç›´æ¥æ‹¿åˆ°å³å°†æäº¤è¯·æ±‚é‚£ä¸ªåœ°æ–¹ï¼Œç„¶åä½¿ç”¨å †æ ˆï¼Œä¸€ç‚¹ç‚¹å¾€å›æ‰¾ï¼Œè¿™æ˜¯åŸºæœ¬æ€è·¯</p><p>æ ¹æ®ä¸Šé¢å¯ä»¥çœ‹åˆ°è¯·æ±‚è·¯å¾„æ˜¯ï¼š<code>/api/movie/?limit=10&amp;offset=0&amp;token=...</code> æ‰“ä¸Šæ–­ç‚¹åˆ·æ–°é¡µé¢</p><img src="/img/JsReverse/image-20220210221604905.webp" alt="" width=90% /><img src="/img/JsReverse/image-20220210221714743.webp" alt="" width=90% /><p>å¼€å§‹é’ˆå¯¹å †æ ˆå¾€å›æ‰¾ï¼šå‘ç°axiosçš„getæ–¹æ³•ï¼šå‚æ•°éƒ½æ˜¯è·Ÿä¸Šé¢è¯·æ±‚çš„ååˆ†ç¬¦åˆã€‚</p><p>åˆ°è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°<code>_0x263439 = Object(_0x2fa7bd['a'])(this['$store']['state']['url']['index']);</code>è¿™ä¸ªåº”è¯¥å°±æ˜¯token</p><img src="/img/JsReverse/image-20220210222010258.webp" alt="" width=90% /><p>å› ä¸ºæ‰¾åˆ°å…·ä½“çš„äº†ï¼Œå–æ¶ˆxhræ–­ç”µåœ¨169è¡Œæ‰“ä¸Šæ–­ç‚¹ã€‚æŠŠé¼ æ ‡ç§»åœ¨ä¸Šé¢å¯ä»¥å‘ç°</p><p><code>/api/movie</code>ä½œä¸ºå‚æ•°ä¼ å…¥è¿›å»ï¼Œå‰é¢æ˜¯ä¸ªå‡½æ•°ï¼ŒåŒæ ·æŠŠé¼ æ ‡ç§»ä¸Šå»ä¹Ÿå¯ä»¥çœ‹åˆ°</p><img src="/img/JsReverse/image-20220210222357464.webp" alt="" width=90% /><p>ç„¶åæˆ‘ä»¬ä½¿ç”¨Watchç›‘è§†çœ‹çœ‹å¯¹åº”çš„<code>_0x2fa7bd</code>ï¼šå»æ‰¾ä¸‹é¢çš„å‡½æ•°</p><img src="/img/JsReverse/image-20220210222633965.webp" alt="" width=90% /><img src="/img/JsReverse/image-20220210222902673.webp" alt="" width=90% /><p>æ ¼å¼åŒ–åçš„å¯¹åº”çš„å‡½æ•°å°±æ˜¯æŠŠå‚æ•°ä¼ å…¥è¿›æ¥ç”ŸæˆTokençš„é€»è¾‘å‡½æ•°äº†ï¼š</p><img src="/img/JsReverse/image-20220210223045604.webp" alt="" width=90% /><p>å•æ­¥è°ƒè¯•ï¼šå»çœ‹é€»è¾‘</p><img src="/img/JsReverse/image-20220210223400006.webp" alt="" width=90% /><img src="/img/JsReverse/image-20220210224351817.webp" alt="" width=90% /><p>*æœ€åçš„é€»è¾‘å°±æ˜¯ï¼š</p><p><strong>ä¼ å…¥åœ°å€è¿™é‡Œæ˜¯ï¼š<code>/api/movie</code>ä¸æ—¶é—´æˆ³ç”¨é€—å·æ‹¼æ¥åï¼Œä½¿ç”¨SHA1è¿›è¡ŒåŠ å¯†åï¼Œå†ä¸æ—¶é—´æˆ³æ‹¼æ¥ï¼Œå†ç”¨Base64ç¼–ç ä¸€æ¬¡å°±æ˜¯Token</strong></p><p>è¿™å¥è¯æœ‰ç‚¹é•¿ï¼Œè°…è§£ä¸‹QAQï¼Œåˆ°è¿™é‡Œå°±å¯ä»¥ç”¨Pythonæ¨¡æ‹Ÿäº†</p><p>å½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨è‡ªå¸¦çš„é‡å†™åŠŸèƒ½ï¼šæ–¹ä¾¿çœ‹å…¶ä¸­çš„æŸäº›å˜é‡</p><blockquote><p>æ­¥éª¤æ˜¯ï¼š</p><ol><li>åˆ›å»ºä¸€ä¸ªä¿å­˜çš„æ–‡ä»¶å¤¹</li><li>è¢«æ ¼å¼åŒ–çš„æ–‡ä»¶æ˜¯ä¸èƒ½ä¿®æ”¹çš„ä½†æ˜¯å¯ä»¥å¤åˆ¶å‡ºæ¥</li><li>åœ¨ç¼–è¾‘å™¨é‡Œé¢ä¿®æ”¹å¥½äº†ç„¶ååœ¨åŸæ–‡ä»¶é‡Œé¢å…¨é€‰ç„¶åæ›¿æ¢</li><li>ä¸‹æ¬¡åˆ·æ–°ä¼šè‡ªåŠ¨æ›¿æ¢</li></ol></blockquote><img src="/img/JsReverse/image-20220210225656780.webp" alt="" width=90% /><h2 id="è·å–è¯¦æƒ…é¡µåŠ å¯†">è·å–è¯¦æƒ…é¡µåŠ å¯†</h2><p>æ­£å¦‚æœ€å¼€å§‹çš„æ—¶å€™ä¼šå‘ç°ï¼šè·³è½¬åˆ°è¯¦æƒ…é¡µé¢çš„é“¾æ¥å·²ç»åŠ å¯†å¥½äº†ï¼Œè€Œä¸æ˜¯åœ¨è¯·æ±‚æ—¶å€™è¿›è¡ŒåŠ å¯†ï¼š</p><img src="/img/JsReverse/image-20220210233557960.webp" alt="" width=90% /><p>çœ‹åˆ°è¯·æ±‚çš„é“¾æ¥çš„Tokençš„è¯ï¼šåº”è¯¥æ˜¯è·Ÿç€è¯·æ±‚åŠ å¯†ç”Ÿæˆçš„ã€‚</p><p>æ‰€ä»¥å¯ä»¥çœ‹å‡ºæ¥æˆ‘ä»¬ç°åœ¨è¦æ‹¿åˆ°<code>/detail/xxx</code>æ˜¯æ€ä¹ˆæ¥çš„ä»¥åŠTokenæ€ä¹ˆå‡ºç°çš„ã€‚</p><p>åŒæ—¶å¯ä»¥ç›²çŒœä¸€æ³¢Tokençš„åŠ å¯†æ–¹å¼åº”è¯¥æ˜¯ä¸€æ ·çš„ï¼Œå³åªæ˜¯æ¢äº†ä¸Šé¢çš„å‚æ•°ã€‚</p><p>ç°åœ¨æˆ‘ä»¬å¼€å§‹åˆ†æï¼š<strong>ç¡®å®šæ˜¯åœ¨å®Œæˆè¯·æ±‚åˆ—è¡¨é¡µåç»è¿‡JsåŠ å¯†å·²ç»å½¢æˆçš„</strong></p><img src="/img/JsReverse/image-20220210234105022.webp" alt="" width=90% /><p>è¿™æ ·æ‰“æ–­ç‚¹å³åŠ è½½å¥½äº†å¼€å§‹è°ƒè¯•ã€‚<strong>ä½†æ˜¯è¿™é‡Œæœ‰ä¸ªé—®é¢˜å°±æ˜¯æ¥ä¸‹æ¥ä¸çŸ¥é“è¦èµ°å¤šä¹…</strong><img src="/img/JsReverse/image-20220210234232496.webp" alt="" width=90% /></p><p>è¿™ä¸ªåœ°æ–¹å°±æ˜¯å­¦åˆ°æ–°ä¸œè¥¿çš„åœ°æ–¹ï¼šå› ä¸ºtokençš„æ ·å­åº”è¯¥æ˜¯æœ€åBase64ç¼–ç è¿‡ï¼Œè€Œåœ¨å‰ç«¯Base64çš„åº“å°±é‚£ä¹ˆå‡ ä¸ª</p><p>é€šå¸¸æ˜¯<code>btao</code>æˆ–è€…æ˜¯<code>crypto-js</code>ç­‰ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ğŸªé’©å­æ¥æˆªå–åˆ°</p><blockquote><p>è¿™ä¸ªæ„æ€å°±æ˜¯func = object[attr]å…ˆæ‹¿åˆ°ï¼Œç„¶åé‡å†™ä¹‹åï¼Œè°ƒç”¨å›å»æ‰§è¡Œ</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="meta">  &#x27;use strict&#x27;</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">hook</span>(<span class="params">object ,attr</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> func = object[attr]</span><br><span class="line">    object[attr] = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&quot;hooked&quot;</span>, object, attr, <span class="built_in">arguments</span>)</span><br><span class="line">      <span class="keyword">var</span> ret = func.apply(object, <span class="built_in">arguments</span>)</span><br><span class="line">      <span class="keyword">debugger</span></span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">&quot;res&quot;</span>, ret)</span><br><span class="line">      <span class="keyword">return</span> ret</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  hook(<span class="built_in">window</span>, <span class="string">&#x27;btoa&#x27;</span>)</span><br><span class="line">&#125;)()</span><br></pre></td></tr></table></figure><p>æ³¨å…¥æ–¹å¼å¯ä»¥æ˜¯ï¼š1. æ§åˆ¶å° 2. é‡å†™Js 3. æ²¹çŒ´è„šæœ¬</p><p>å› ä¸ºæ‰“äº†æ–­ç‚¹ï¼Œæˆ‘ä»¬åœ¨æ§åˆ¶å°é‡å†™btoaæ–¹æ³•ï¼Œè¿™æ ·åˆ°äº†æ–¹æ³•æ‰§è¡Œçš„æ—¶å€™å°±ä¼šåˆ°æˆ‘ä»¬å†™å…¥çš„é‡Œé¢å»éªŒè¯</p><p>è¿™é‡Œæœ‰å‡ ä¸ªæ³¨æ„ç‚¹ï¼š</p><ol><li>æ§åˆ¶å°è¾“å…¥å å¯ä»¥è°ƒç”¨<code>btoa('1')</code>è¿›å…¥ä¸´æ—¶æ–‡ä»¶ä¸­çš„debugger</li><li>å› ä¸ºæ˜¯<code>SPA</code>é¡µé¢æ‰€ä»¥ç›´æ¥è¯·æ±‚ç¬¬äºŒé¡µå¯ä»¥è§¦å‘å†™å…¥çš„btoaï¼Œ<strong>åˆ·æ–°åˆ™ä¸è¡Œ</strong>ï¼</li></ol><img src="/img/JsReverse/image-20220211000800269.webp" alt="" width=90% /><p>ç‚¹å‡»ç¬¬äºŒé¡µï¼ŒåŠ å¯†è§„åˆ™éƒ½æ˜¯ä¸€æ ·çš„ã€‚ç›´æ¥è§¦å‘ï¼ˆè¿™é‡Œæˆ‘æ˜¯ç¬¬äºŒé¡µå»ç‚¹ç¬¬ä¸€é¡µï¼‰</p><img src="/img/JsReverse/image-20220211001051507.webp" alt="" width=90% /><p>å¾€ä¸‹æ‰¾äº†ä¸€å±‚å‘ç°å·²ç»å‡ºæ¥äº†åˆ™ç»§ç»­å¾€ä¸‹æ‰¾</p><img src="/img/JsReverse/image-20220211001220739.webp" alt="" width=90% /><p>å‘ç°äº†æ‹¼å‡‘ï¼šä¸€ä¸²ä¸çŸ¥é“æ˜¯å•¥çš„+ä¸€ä¸ªå•¥</p><img src="/img/JsReverse/image-20220211001431465.webp" alt="" width=90% /><p>åŒæ—¶å‘ç°ï¼š<code>_0x11a046</code>æ˜¯å†™æ­»çš„</p><img src="/img/JsReverse/image-20220211001556051.webp" alt="" width=90% /><p>æ‹¼å‡‘çš„é‚£ä¸ªæ•°å­—ç»§ç»­å¾€ä¸‹æ‰¾ï¼šå‘ç°å°±æ˜¯æ‹¿åˆ°ç»“æœçš„ID</p><img src="/img/JsReverse/image-20220211001717040.webp" alt="" width=90% /><p>åˆ°è¿™é‡Œè¯¦æƒ…é¡µåŠ å¯†å·²ç»å‡ºæ¥äº†ã€‚ç°åœ¨éªŒè¯ä¸‹tokenæ€ä¹ˆæ¥çš„ï¼Œå¥½çš„æ–¹å¼ä¸€æ¨¡ä¸€æ ·</p><img src="/img/JsReverse/image-20220211002248300.webp" alt="" width=90% /><h2 id="æ€»ç»“">æ€»ç»“</h2><ol><li>åšJsé€†å‘åŸºç¡€è¦æ‡‚è¦ä¼š</li><li>å¿ƒè¦å¤§ï¼Œè¦æ•¢çŒœï¼Œä¸ç„¶çœŸçš„ä¸€ä¸‹å­è·Ÿæ­£ç¡®ç­”æ¡ˆæ“¦è‚©è€Œè¿‡</li><li>åŒæ—¶å¿ƒè¦ç»†ï¼Œä¸åŒçš„å†™æ³•åŒä¸€ç§æ•ˆæœï¼Œä¸è¦æ”¾è¿‡è§‰å¾—ä¸å¯èƒ½çš„åœ°æ–¹</li><li>Pythonå®ç°çš„æ–¹å¼å¾ˆå¤šï¼Œè‡ªå·±å¤šæ£é¼“ä¸‹</li></ol>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>å­¦ä¹ Pythoné«˜çº§ç¼–ç¨‹åˆ°asyncioå¹¶å‘å®è·µ</title>
      <link href="/article/4ba9700a.html"/>
      <url>/article/4ba9700a.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€ï¼š-7">å‰è¨€ï¼š</h2><p>ä»Šå¤©ä¹Ÿé¡ºåˆ©æŠŠ<strong>Python3é«˜çº§æ ¸å¿ƒæŠ€æœ¯97è®²</strong>çœ‹å®Œäº†</p><p>è¯¾ç¨‹é“¾æ¥æˆ‘ä¹Ÿè´´ä¸€ä¸‹ï¼š<a href="https://coding.imooc.com/class/chapter/200.html">https://coding.imooc.com/class/chapter/200.html</a></p><p>æ€»ä½“è¯´ä¸‹æ„Ÿå—ï¼š<strong>å¾ˆæ¨èå§ï¼Œå¾ªåºæ¸è¿›å­¦ä¹ ï¼Œæ‹“å±•äº†å¾ˆå¤šè‡ªå·±çš„ä¸è¶³</strong></p><p>æ­£å¥½æˆ‘ç°åœ¨æˆ‘çœ‹ã€ŠPyhton3ç½‘ç»œçˆ¬è™«å¼€å‘å®æˆ˜(ç¬¬äºŒç‰ˆ)ã€‹ä¹Ÿ200é¡µå‡ºå¤´äº†</p><p>åˆšå¥½æ¥åˆ°äº†<strong>aiohttpçš„ä½¿ç”¨</strong>,è¿™ä¸æ­£å¥½ï¼Ÿ æŠŠå´”ä½¬çš„ä»£ç æ‹¿ä¸‹æ¥çœ‹çœ‹</p><p>é‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ç®€å•è®²è§£ä¸‹è‡ªå·±çš„ç†è§£ã€‚å›¾çœäº‹è‡ªå·±åˆ°æœ€åçš„å®Œæˆä»£ç </p><blockquote><p>æ³¨æ˜ï¼šå¤§éƒ¨åˆ†æˆ‘éƒ½å†™ä¸Šäº†æ³¨é‡Šï¼Œæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å®è·µä»£ç </p><p>å¦‚æœå“ªé‡Œæˆ‘æ²¡ç†è§£å¯¹ï¼Œè®°å¾—æ¥æ‹é†’æˆ‘ä¸‹ï¼Œè¯·èµæ•™ï¼Œæ¬¢è¿ä¸æˆ‘äº¤æµ</p></blockquote><h2 id="å›¾è§£ï¼š">å›¾è§£ï¼š</h2><blockquote><p>é¦–å…ˆå¾—ç†è§£ä»€ä¹ˆæ˜¯å¤šçº¿ç¨‹ï¼Œä»€ä¹ˆæ˜¯åç¨‹ï¼Ÿ ä»¥åŠç›¸å…³çš„æœ¯è¯­</p><p>ç®€å•æ¥è¯´ï¼šå¤šçº¿ç¨‹å°±æ˜¯å¤šä¸ªçº¿ç¨‹åŒæ—¶å¹¶è¡Œï¼›åç¨‹å°±æ˜¯å•ä¸ªçº¿ç¨‹å¼€å¯å¤šä¸ªåˆ†æ”¯</p><p>åç¨‹å°†CPUæ›´å¤§åˆ©ç”¨åŒ–ï¼Œç®€å•æ¯”æ–¹ï¼šä½ å»è¯·æ±‚ç½‘ç»œ é‚£ä¹ˆCPUå°±åœ¨è¿™é‡Œçç­‰</p></blockquote><p><img src="https://img-blog.csdnimg.cn/img_convert/b482423210574f27c212e38af2fb4de3.png" alt="Untitled-2022-02-04-1909"></p><h2 id="æ³¨æ„ç‚¹">æ³¨æ„ç‚¹</h2><div class="note orange icon flat"><i class="note-icon fas fa-battery-half"></i><p>ä¸ºä»€ä¹ˆå°†sessionè®¾ç½®åœ¨__init__ä¸­</p></div><p>å…å¾—ä¸€æ–­ä¸€è¿ã€‚</p><div class="note orange icon flat"><i class="note-icon fas fa-battery-half"></i><p>gatherä¸waitåŒºåˆ«</p></div><p>ç®€å•ç†è§£gatherçš„åŠŸèƒ½æ›´é«˜çº§ï¼Œå¯ä»¥æ‹¿åˆ°ç»“æœã€‚æƒ³äº†è§£æ›´å¤šç›´æ¥è°·æ­ŒQAQ</p><div class="note orange icon flat"><i class="note-icon fas fa-battery-half"></i><p>loop çš„ä½œç”¨</p></div><p>å¯ä»¥çœ‹ä½œè¿™ä¸ªç¨‹åºçš„å¿ƒè·³ï¼Œä¸åœçš„å¾ªç¯ã€‚æ¨èçœ‹çœ‹æˆ‘ä¸Šé¢æ¨èçš„è¯¾ç¨‹<br>ä»12ç« åˆ°13ç« ï¼Œä»æœ€å¼€å§‹çš„æºç ç¨‹åºå®ç°åˆ°åé¢å°è£…è°ƒç”¨åº“<br>å¾ªåºæ¸è¿›è®²çš„ä¸é”™ï¼Œè¿˜å¯ä»¥å­¦å­¦yieldæ€ä¹ˆå›äº‹</p><div class="note orange icon flat"><i class="note-icon fas fa-battery-half"></i><p>ä½¿ç”¨asyncio.sleepè€Œä¸æ˜¯ç”¨time.sleep ä½¿ç”¨motorå¼‚æ­¥åº“è€Œä¸æ˜¯ç”¨å¹³æ—¶çš„</p></div><p>ä½¿ç”¨time.sleepä¸æ˜¯ä¸è¡Œï¼Œä¼šæŠ¥é”™ä½†å¯ä»¥æ‹¿åˆ°ï¼Œå…·ä½“çš„åŸå› å»ºè®®çœ‹çœ‹ç¬¬12ï¼Œ13ç« </p><h2 id="å®Œæ•´ä»£ç ">å®Œæ•´ä»£ç </h2><blockquote><p>åŸæœ¬çš„ä»£ç åœ¨ <a href="https://github.com/Python3WebSpider/ScrapeSpa5">https://github.com/Python3WebSpider/ScrapeSpa5</a></p><p>æˆ‘ç®€å•æ”¹äº†æ”¹å°éƒ¨åˆ†ï¼Œå­¦ä¹ çš„ç›®çš„è¾¾åˆ°å³å¯ï½</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨aiohttpå¼‚æ­¥çˆ¬å»</span></span><br><span class="line"><span class="comment"># ç›®æ ‡ç½‘ç«™ï¼šhttps://spa5.scrape.center/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">import</span> aiohttp</span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"><span class="keyword">from</span> aiohttp <span class="keyword">import</span> ContentTypeError</span><br><span class="line"><span class="keyword">from</span> motor.motor_asyncio <span class="keyword">import</span> AsyncIOMotorClient</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®é€šç”¨å‚æ•°</span></span><br><span class="line">PAGE_SIZE = <span class="number">18</span>  <span class="comment"># è¯·æ±‚ä¸ªæ•°</span></span><br><span class="line">PAGE_NUMBER = <span class="number">1</span>  <span class="comment"># è¯·æ±‚é¡µæ•°</span></span><br><span class="line">CONCURRENCY = <span class="number">5</span>  <span class="comment"># å¹¶å‘æ•°é‡</span></span><br><span class="line"><span class="comment"># è®¾ç½®æ—¥å¿—æ ¼å¼</span></span><br><span class="line">logging.basicConfig(filename=<span class="string">&#x27;log.log&#x27;</span>, level=logging.INFO, <span class="built_in">format</span>=<span class="string">&#x27;%(asctime)s - %(levelname)s: %(message)s&#x27;</span>)</span><br><span class="line"><span class="comment"># é…ç½®mongodbæ–‡ä»¶</span></span><br><span class="line">MONGO_CONNECTION_STRING = <span class="string">&#x27;mongodb://localhost:27017&#x27;</span></span><br><span class="line">MONGO_DB_NAME = <span class="string">&#x27;books&#x27;</span></span><br><span class="line">MONGO_COLLECTION_NAME = <span class="string">&#x27;books&#x27;</span></span><br><span class="line"><span class="comment"># ä½¿ç”¨motorå¼‚æ­¥åº“</span></span><br><span class="line">client = AsyncIOMotorClient(MONGO_CONNECTION_STRING)</span><br><span class="line">db = client[MONGO_DB_NAME]</span><br><span class="line">collection = db[MONGO_CONNECTION_STRING]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Spider</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.semaphore = asyncio.Semaphore(CONCURRENCY)  <span class="comment"># è®¾ç½®å¹¶å‘æ•°é‡</span></span><br><span class="line">        self.session = aiohttp.ClientSession()  <span class="comment"># è®¾ç½®session() å…å¾—</span></span><br><span class="line">        self.ids = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">scrapeApi</span>(<span class="params">self, url</span>):</span></span><br><span class="line">        <span class="keyword">async</span> <span class="keyword">with</span> self.semaphore:  <span class="comment"># é™åˆ¶å¹¶å‘</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                logging.info(<span class="string">&#x27;scraping %s&#x27;</span>, url)</span><br><span class="line">                <span class="keyword">async</span> <span class="keyword">with</span> self.session.get(url) <span class="keyword">as</span> response:  <span class="comment"># ä½¿ç”¨ async with ä¸Šä¸‹æ–‡ä¼šè‡ªåŠ¨å…³é—­</span></span><br><span class="line">                    <span class="keyword">await</span> asyncio.sleep(<span class="number">1</span>)  <span class="comment"># å¿…é¡»ä½¿ç”¨asyncio.sleepè€Œä¸æ˜¯time.sleep</span></span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">await</span> response.json()  <span class="comment"># ä¸ºä»€ä¹ˆè¦ä½¿ç”¨awaitåœ¨pycharmä¸­ç‚¹è¿›å…¥å‘ç°æ˜¯asyncç”³æ˜çš„</span></span><br><span class="line">            <span class="keyword">except</span> ContentTypeError <span class="keyword">as</span> e:</span><br><span class="line">                logging.error(<span class="string">&#x27;error occurred while scraping %s&#x27;</span>, url, exc_info=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">scrapeIndex</span>(<span class="params">self, page</span>):</span></span><br><span class="line">        <span class="comment"># todo æ‹¼å‡‘å‡ºæ¥å¯¹åº”çš„url ç„¶åæ•™ç»™ä¸‹ä¸€ä¸ªåç¨‹</span></span><br><span class="line">        url = <span class="string">&#x27;https://spa5.scrape.center/api/book/?limit=18&amp;offset=&#123;offset&#125;&#x27;</span></span><br><span class="line">        url = url.<span class="built_in">format</span>(offset=PAGE_SIZE * (page - <span class="number">1</span>))</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">await</span> self.scrapeApi(url)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">scrapeDetail</span>(<span class="params">self, <span class="built_in">id</span></span>):</span></span><br><span class="line">        url = <span class="string">&#x27;https://spa5.scrape.center/api/book/&#123;id&#125;&#x27;</span></span><br><span class="line">        url = url.<span class="built_in">format</span>(<span class="built_in">id</span>=<span class="built_in">id</span>)</span><br><span class="line">        data = <span class="keyword">await</span> self.scrapeApi(url)  <span class="comment"># æ‹¿åˆ°ç»“æœå°±å­˜å…¥</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;id: <span class="subst">&#123;<span class="built_in">id</span>&#125;</span> : data: <span class="subst">&#123;data&#125;</span>&quot;</span>)  <span class="comment"># å…·ä½“å†…å®¹è‡ªå·±æ“ä½œå†™å°±å¥½äº†(æ³¨æ„ä¸æ˜¯ç½‘ç»œIOäº†ä¸ç”¨await)</span></span><br><span class="line">        <span class="comment"># await self.saveData(data)  # æˆ‘æ˜¯æ‡’å¾—å»å¼€ä¸ªmongoQAQ</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">saveData</span>(<span class="params">data</span>):</span></span><br><span class="line">        logging.info(<span class="string">&#x27;saving data %s&#x27;</span>, data)</span><br><span class="line">        <span class="keyword">if</span> data:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">await</span> collection.update_one(&#123;</span><br><span class="line">                <span class="string">&#x27;id&#x27;</span>: data.get(<span class="string">&#x27;id&#x27;</span>)</span><br><span class="line">            &#125;, &#123;</span><br><span class="line">                <span class="string">&#x27;$set&#x27;</span>: data</span><br><span class="line">            &#125;, upsert=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">main</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="comment"># todo è®¾ç½®ä»»åŠ¡</span></span><br><span class="line">        <span class="comment"># ä»è¿™ä¸€æ­¥çš„è¯å¯ä»¥æ‹¿åˆ°æŒ‡å®šé¡µæ•°çš„åˆ—è¡¨</span></span><br><span class="line">        scrape_index_tasks = [asyncio.ensure_future(self.scrapeIndex(page)) <span class="keyword">for</span> page <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, PAGE_NUMBER + <span class="number">1</span>)]</span><br><span class="line">        results = <span class="keyword">await</span> asyncio.gather(*scrape_index_tasks)  <span class="comment"># ä½¿ç”¨gatherè€Œä¸æ˜¯wait</span></span><br><span class="line">        <span class="comment"># todo æ‹¿åˆ°æ¯ä¸€é¡µä¸­çš„ids</span></span><br><span class="line">        <span class="comment"># è¿™ä¸€æ­¥å°±æ˜¯ä»é¢„è§ˆå¤§æ¦‚åˆ°æ¯ä¸€é¡µä¸­è·å–è¯¦ç»†ä¿¡æ¯</span></span><br><span class="line">        <span class="keyword">for</span> index_data <span class="keyword">in</span> results:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> index_data:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">for</span> item <span class="keyword">in</span> index_data.get(<span class="string">&#x27;results&#x27;</span>):  <span class="comment"># ä½¿ç”¨å­—å…¸çš„getæ–¹æ³•</span></span><br><span class="line">                self.ids.append(item.get(<span class="string">&#x27;id&#x27;</span>))</span><br><span class="line">        <span class="comment"># todo æ ¹æ®æ‹¿åˆ°çš„idè¿›å…¥åç¨‹åŒæ­¥è¿›è¡Œæ‹¿åˆ°æƒ³è¦çš„ç»“æœå¹¶å­˜å…¥</span></span><br><span class="line">        scrape_detail_tasks = [asyncio.ensure_future(self.scrapeDetail(each)) <span class="keyword">for</span> each <span class="keyword">in</span> self.ids]</span><br><span class="line">        <span class="keyword">await</span> asyncio.wait(scrape_detail_tasks)</span><br><span class="line">        <span class="comment"># todo æœ€åå…³é—­sessionä¼šè¯</span></span><br><span class="line">        <span class="keyword">await</span> self.session.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    spider = Spider()</span><br><span class="line">    loop = asyncio.get_event_loop()</span><br><span class="line">    loop.run_until_complete(spider.main())</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>MACä¸ŠRabbitMQä»å®‰è£…åˆ°ç”¨GOå¿«é€Ÿå®ç°æ¬ç§»</title>
      <link href="/article/5fe856cc.html"/>
      <url>/article/5fe856cc.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€">å‰è¨€</h2><p>æœ€è¿‘åœ¨è·Ÿæ…•è¯¾åšä¸€ä¸ªç§’æ€å•†åŸçš„å°é¡¹ç›®ï¼Œæ¥è§¦äº†RabbitMQ</p><p>è™½ç„¶å¹³æ—¶æ˜¯åœ¨Pythonä¸­å®ç°æ¶ˆæ¯é˜Ÿåˆ—ï¼Œä½†æ˜¯ä¸å¾—ä¸è¯´RabbitMQé¦™å‘€</p><p>ä»Šå¤©ä¹Ÿæ˜¯é™¤å¤•ï¼Œåœ¨è¿™ä¸ªç¥å¤§å®¶<strong>æ–°å¹´å¿«ä¹</strong>ï¼Œå‘ä¸ªå°æ°´æ–‡ç« å§QAQ</p><h2 id="å®‰è£…å¼€å§‹">å®‰è£…å¼€å§‹</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åŸºç¡€å®‰è£…</span></span><br><span class="line">$ brew install rabbitmq</span><br><span class="line">$ vim ~/.zshrc <span class="comment"># å°† export PATH=$PATH:/usr/local/sbin å†™å…¥</span></span><br><span class="line">$ rabbitmq-server <span class="comment"># é‡æ–°æ‰“å¼€ç»ˆç«¯ï¼Œå¼€å¯æœåŠ¡</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼€å¯æ’ä»¶</span></span><br><span class="line">$ rabbitmq-plugins list <span class="comment"># æŸ¥çœ‹æ’ä»¶</span></span><br><span class="line">$ rabbitmq-plugins <span class="built_in">enable</span> rabbitmq_management <span class="comment"># å¯åŠ¨ç®¡ç†æ’ä»¶</span></span><br><span class="line">$ rabbitmq-plugins <span class="built_in">enable</span> rabbitmq_tracing <span class="comment"># å¯åŠ¨æ—¥å¿—</span></span><br><span class="line">$ rabbitmq-plugins <span class="built_in">disable</span> rabbitmq_tracing <span class="comment"># å…³é—­æ—¥å¿—</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é¢å¤–å‘½ä»¤</span></span><br><span class="line">$ rabbitmq-server -detached <span class="comment"># åå°å¯åŠ¨</span></span><br><span class="line">$ rabbitmqctl status <span class="comment"># æŸ¥çœ‹çŠ¶æ€</span></span><br><span class="line">$ rabbitmqctl stop <span class="comment"># å…³é—­</span></span><br></pre></td></tr></table></figure><h2 id="æ‰“å¥½åŸºç¡€">æ‰“å¥½åŸºç¡€</h2><blockquote><p>è¿™äº›éƒ½æ˜¯å¾ˆåŸºæœ¬çš„æ¦‚å¿µï¼Œä½ å¾—æ˜ç™½ä»€ä¹ˆæ˜¯ä»€ä¹ˆå°±å¥½äº†</p><p>å› ä¸ºä½œä¸ºå·¥å…·ï¼Œé¦–å…ˆè¦ä¼šç”¨èµ·æ¥ï¼Œä¼šé‡‡ç”¨å›«å›µåæ£çš„æ¨¡å¼å­¦ä¹ </p><p>éšç€åé¢çš„æ·±å…¥ï¼Œæ…¢æ…¢äº†è§£ç‰¹ç‚¹å§</p></blockquote><table><thead><tr><th style="text-align:center">æ¦‚å¿µ</th><th style="text-align:center">æè¿°</th></tr></thead><tbody><tr><td style="text-align:center">Channel</td><td style="text-align:center">ç”Ÿäº§è€…publishæˆ–æ˜¯æ¶ˆè´¹è€…subscribeä¸€ä¸ªé˜Ÿåˆ—éƒ½æ˜¯é€šè¿‡ä¿¡é“æ¥é€šä¿¡çš„</td></tr><tr><td style="text-align:center">Exchange</td><td style="text-align:center">exchangeçš„ä½œç”¨å°±æ˜¯ç±»ä¼¼è·¯ç”±å™¨ï¼ŒæœåŠ¡å™¨ä¼šæ ¹æ®è·¯ç”±é”®å°†æ¶ˆæ¯ä»äº¤æ¢å™¨è·¯ç”±åˆ°é˜Ÿåˆ—ä¸Šå»</td></tr><tr><td style="text-align:center">Queue</td><td style="text-align:center">é˜Ÿåˆ—æ”¶åˆ°çš„æ¶ˆæ¯å°†å‘é€ç»™æ¶ˆè´¹è€…</td></tr><tr><td style="text-align:center">Binding</td><td style="text-align:center">å»ºç«‹é“¾æ¥äº¤æ¢çš„ç»‘å®šä¿¡æ¯</td></tr><tr><td style="text-align:center">VirtualHost</td><td style="text-align:center">ä¸åŒçš„éš”ç¦»åŒºï¼Œé˜²æ­¢æ±¡æŸ“</td></tr><tr><td style="text-align:center">Connection</td><td style="text-align:center">å»ºç«‹çš„é“¾æ¥</td></tr></tbody></table><hr><table><thead><tr><th style="text-align:center">å·¥ä½œæ¨¡å¼</th><th style="text-align:center">æè¿°</th></tr></thead><tbody><tr><td style="text-align:center">simple</td><td style="text-align:center">æœ€ç®€å•çš„æ”¶å‘æ¨¡å¼</td></tr><tr><td style="text-align:center">work</td><td style="text-align:center">èµ„æºçš„ç«äº‰</td></tr><tr><td style="text-align:center">publish/subscribe</td><td style="text-align:center">å…±äº«èµ„æº</td></tr><tr><td style="text-align:center">routing</td><td style="text-align:center">åªèƒ½åŒ¹é…ä¸Šè·¯ç”±keyå¯¹åº”çš„æ¶ˆæ¯é˜Ÿåˆ—,å¯¹åº”çš„æ¶ˆè´¹è€…æ‰èƒ½æ¶ˆè´¹æ¶ˆæ¯</td></tr><tr><td style="text-align:center">topic</td><td style="text-align:center">routingçš„ä¸€ç§æ¨¡ç³ŠåŒ¹é…</td></tr></tbody></table><h2 id="ä»£ç å®ç°-2">ä»£ç å®ç°</h2><h3 id="åŠŸèƒ½ä»“åº“æ–‡ä»¶">åŠŸèƒ½ä»“åº“æ–‡ä»¶</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MQURL è¿æ¥ä¿¡æ¯ amqp://è´¦å·:å¯†ç @ip:host/vhost</span></span><br><span class="line"><span class="keyword">const</span> MQURL = <span class="string">&quot;amqp://guest:guest@127.0.0.1:5672/&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// RabbitMQ rabbitMQç»“æ„ä½“</span></span><br><span class="line"><span class="keyword">type</span> RabbitMQ <span class="keyword">struct</span> &#123;</span><br><span class="line">conn      *amqp.Connection <span class="comment">// é“¾æ¥</span></span><br><span class="line">channel   *amqp.Channel    <span class="comment">// é€šé“</span></span><br><span class="line">QueueName <span class="keyword">string</span>           <span class="comment">//é˜Ÿåˆ—åç§°</span></span><br><span class="line">Exchange  <span class="keyword">string</span>           <span class="comment">//äº¤æ¢æœºåç§°</span></span><br><span class="line">Key       <span class="keyword">string</span>           <span class="comment">//bind Key åç§°</span></span><br><span class="line">Mqurl     <span class="keyword">string</span>           <span class="comment">//è¿æ¥ä¿¡æ¯</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// NewRabbitMQ åˆ›å»ºç»“æ„ä½“å®ä¾‹</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewRabbitMQ</span><span class="params">(queueName <span class="keyword">string</span>, exchange <span class="keyword">string</span>, key <span class="keyword">string</span>)</span> *<span class="title">RabbitMQ</span></span> &#123;</span><br><span class="line"><span class="keyword">return</span> &amp;RabbitMQ&#123;QueueName: queueName, Exchange: exchange, Key: key, Mqurl: MQURL&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Destroy æ–­å¼€ channel å’Œ connection</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(r *RabbitMQ)</span> <span class="title">Destroy</span><span class="params">()</span></span> &#123;</span><br><span class="line">r.channel.Close() <span class="comment">// æ–­å¼€ channel</span></span><br><span class="line">r.conn.Close()    <span class="comment">// æ–­å¼€ conn</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// é”™è¯¯å¤„ç†å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(r *RabbitMQ)</span> <span class="title">failOnErr</span><span class="params">(err error, message <span class="keyword">string</span>)</span></span> &#123;</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">log.Printf(<span class="string">&quot;%s:%s&quot;</span>, message, err)         <span class="comment">// æ‰“å°é”™è¯¯</span></span><br><span class="line"><span class="built_in">panic</span>(fmt.Sprintf(<span class="string">&quot;%s:%s&quot;</span>, message, err)) <span class="comment">// æŠ›å‡ºé”™è¯¯</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// NewRabbitMQSimple åˆ›å»ºç®€å•æ¨¡å¼ä¸‹RabbitMQå®ä¾‹</span></span><br><span class="line"><span class="comment">// åœ¨Simpleæ¨¡å¼ä¸‹å”¯ä¸€ä¸åŒçš„æ˜¯ queueName</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewRabbitMQSimple</span><span class="params">(queueName <span class="keyword">string</span>)</span> *<span class="title">RabbitMQ</span></span> &#123;</span><br><span class="line"><span class="comment">// todo åˆ›å»ºRabbitMQå®ä¾‹</span></span><br><span class="line">rabbitmq := NewRabbitMQ(queueName, <span class="string">&quot;&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="keyword">var</span> err error</span><br><span class="line"><span class="comment">// todo è¡¥ä¸Šconnä¸channel</span></span><br><span class="line"><span class="comment">//è·å–connection</span></span><br><span class="line">rabbitmq.conn, err = amqp.Dial(rabbitmq.Mqurl)</span><br><span class="line">rabbitmq.failOnErr(err, <span class="string">&quot;failed to connect rabbitmq!&quot;</span>)</span><br><span class="line"><span class="comment">//è·å–channel</span></span><br><span class="line">rabbitmq.channel, err = rabbitmq.conn.Channel()</span><br><span class="line">rabbitmq.failOnErr(err, <span class="string">&quot;failed to open a channel&quot;</span>)</span><br><span class="line"><span class="keyword">return</span> rabbitmq</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// PublishSimple ç®€å•æ¨¡å¼ä¸‹é˜Ÿåˆ—ç”Ÿäº§</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(r *RabbitMQ)</span> <span class="title">PublishSimple</span><span class="params">(message <span class="keyword">string</span>)</span></span> &#123;</span><br><span class="line"><span class="comment">// todo ç”³è¯·é˜Ÿåˆ—ï¼Œå¦‚æœé˜Ÿåˆ—ä¸å­˜åœ¨ä¼šè‡ªåŠ¨åˆ›å»ºï¼Œå­˜åœ¨åˆ™è·³è¿‡åˆ›å»º</span></span><br><span class="line">_, err := r.channel.QueueDeclare(</span><br><span class="line">r.QueueName, <span class="comment">// é¦–å…ˆæ”¾å…¥åç§°</span></span><br><span class="line"><span class="literal">false</span>,       <span class="comment">//æ˜¯å¦æŒä¹…åŒ–</span></span><br><span class="line"><span class="literal">false</span>,       <span class="comment">//æ˜¯å¦è‡ªåŠ¨åˆ é™¤</span></span><br><span class="line"><span class="literal">false</span>,       <span class="comment">//æ˜¯å¦å…·æœ‰æ’ä»–æ€§</span></span><br><span class="line"><span class="literal">false</span>,       <span class="comment">//æ˜¯å¦é˜»å¡å¤„ç†</span></span><br><span class="line"><span class="literal">nil</span>,         <span class="comment">//é¢å¤–çš„å±æ€§</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(err)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//todo è°ƒç”¨channel å‘é€æ¶ˆæ¯åˆ°é˜Ÿåˆ—ä¸­</span></span><br><span class="line">r.channel.Publish(</span><br><span class="line">r.Exchange, <span class="comment">// æ­¤å¤„ä¸ºç©º</span></span><br><span class="line">r.QueueName,</span><br><span class="line"><span class="literal">false</span>, <span class="comment">//å¦‚æœä¸ºtrueï¼Œæ ¹æ®è‡ªèº«exchangeç±»å‹å’ŒrouteKeyè§„åˆ™ï¼›æ— æ³•æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„é˜Ÿåˆ—ä¼šæŠŠæ¶ˆæ¯è¿”è¿˜ç»™å‘é€è€…</span></span><br><span class="line"><span class="literal">false</span>, <span class="comment">//å¦‚æœä¸ºtrueï¼Œå½“exchangeå‘é€æ¶ˆæ¯åˆ°é˜Ÿåˆ—åå‘ç°é˜Ÿåˆ—ä¸Šæ²¡æœ‰æ¶ˆè´¹è€…ï¼Œåˆ™ä¼šæŠŠæ¶ˆæ¯è¿”è¿˜ç»™å‘é€è€…</span></span><br><span class="line">amqp.Publishing&#123;</span><br><span class="line">ContentType: <span class="string">&quot;text/plain&quot;</span>,</span><br><span class="line">Body:        []<span class="keyword">byte</span>(message),</span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ConsumeSimple ç®€å•æ¨¡å¼ä¸‹æ¶ˆè´¹è€…</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(r *RabbitMQ)</span> <span class="title">ConsumeSimple</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">//todo ç”³è¯·é˜Ÿåˆ—ï¼Œå¦‚æœé˜Ÿåˆ—ä¸å­˜åœ¨ä¼šè‡ªåŠ¨åˆ›å»ºï¼Œå­˜åœ¨åˆ™è·³è¿‡åˆ›å»º</span></span><br><span class="line">q, err := r.channel.QueueDeclare(</span><br><span class="line">r.QueueName,</span><br><span class="line"><span class="literal">false</span>, <span class="comment">//æ˜¯å¦æŒä¹…åŒ–</span></span><br><span class="line"><span class="literal">false</span>, <span class="comment">//æ˜¯å¦è‡ªåŠ¨åˆ é™¤</span></span><br><span class="line"><span class="literal">false</span>, <span class="comment">//æ˜¯å¦å…·æœ‰æ’ä»–æ€§</span></span><br><span class="line"><span class="literal">false</span>, <span class="comment">//æ˜¯å¦é˜»å¡å¤„ç†</span></span><br><span class="line"><span class="literal">nil</span>,   <span class="comment">//é¢å¤–çš„å±æ€§</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(err)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//todo æ¥æ”¶æ¶ˆæ¯</span></span><br><span class="line">msg, err := r.channel.Consume(</span><br><span class="line">q.Name, <span class="comment">// queue</span></span><br><span class="line"><span class="string">&quot;&quot;</span>,     <span class="comment">//ç”¨æ¥åŒºåˆ†å¤šä¸ªæ¶ˆè´¹è€… æ­¤å¤„ä¸åŒºåˆ†</span></span><br><span class="line"><span class="literal">true</span>,   <span class="comment">//æ˜¯å¦è‡ªåŠ¨åº”ç­”</span></span><br><span class="line"><span class="literal">false</span>,  <span class="comment">//æ˜¯å¦ç‹¬æœ‰</span></span><br><span class="line"><span class="literal">false</span>,  <span class="comment">//è®¾ç½®ä¸ºtrueï¼Œè¡¨ç¤ºä¸èƒ½å°†åŒä¸€ä¸ªConnectionä¸­ç”Ÿäº§è€…å‘é€çš„æ¶ˆæ¯ä¼ é€’ç»™è¿™ä¸ªConnectionä¸­çš„æ¶ˆè´¹è€…</span></span><br><span class="line"><span class="literal">false</span>,  <span class="comment">// æ˜¯å¦é˜»å¡å¤„ç†</span></span><br><span class="line"><span class="literal">nil</span>,    <span class="comment">// é¢å¤–çš„å±æ€§</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">fmt.Println(err)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//todo å¯ç”¨åç¨‹å¤„ç†æ¶ˆæ¯</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ­¤å¤„ä½¿ç”¨foreverçš„æ„æ€ä¸ºå› ä¸ºåç¨‹ä¼šå§‹ç»ˆç›‘å¬æ¶ˆæ¯(é™¤éæ‰‹åŠ¨ç»“æŸ)</span></span><br><span class="line"><span class="comment">// æ‰‹åŠ¨ç»“æŸæ‰ä¼šè¿›è¡Œ &lt;-forever æœ‰åç¨‹ä¸”ä¸€ç›´å°è¯•è¯»å–æ•°æ®</span></span><br><span class="line">forever := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">bool</span>)</span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">for</span> d := <span class="keyword">range</span> msg &#123;</span><br><span class="line"><span class="comment">// æ¶ˆæ¯é€»è¾‘å¤„ç†</span></span><br><span class="line">log.Printf(<span class="string">&quot;Received a message: %s&quot;</span>, d.Body)</span><br><span class="line">&#125;</span><br><span class="line">&#125;()</span><br><span class="line">log.Printf(<span class="string">&quot; [*] Waiting for messages. To exit press CTRL+C&quot;</span>)</span><br><span class="line">&lt;-forever</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// NewRabbitMQPubSub è®¢é˜…æ¨¡å¼åˆ›å»ºRabbitMQå®ä¾‹å°±è¦è®¾ç½®è·¯ç”±å™¨äº†</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewRabbitMQPubSub</span><span class="params">(exchangeName <span class="keyword">string</span>)</span> *<span class="title">RabbitMQ</span></span> &#123;</span><br><span class="line"><span class="comment">//todo åˆ›å»ºRabbitMQå®ä¾‹</span></span><br><span class="line">rabbitmq := NewRabbitMQ(<span class="string">&quot;&quot;</span>, exchangeName, <span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="keyword">var</span> err error</span><br><span class="line"><span class="comment">//todo è·å–connectionå’Œè·å–channel</span></span><br><span class="line">rabbitmq.conn, err = amqp.Dial(rabbitmq.Mqurl)</span><br><span class="line">rabbitmq.failOnErr(err, <span class="string">&quot;failed to connect rabbitmq!&quot;</span>)</span><br><span class="line">rabbitmq.channel, err = rabbitmq.conn.Channel()</span><br><span class="line">rabbitmq.failOnErr(err, <span class="string">&quot;failed to open a channel&quot;</span>)</span><br><span class="line"><span class="keyword">return</span> rabbitmq</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// PublishPub è®¢é˜…æ¨¡å¼ç”Ÿäº§</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(r *RabbitMQ)</span> <span class="title">PublishPub</span><span class="params">(message <span class="keyword">string</span>)</span></span> &#123;</span><br><span class="line"><span class="comment">//todo å°è¯•åˆ›å»ºäº¤æ¢æœº</span></span><br><span class="line">err := r.channel.ExchangeDeclare(</span><br><span class="line">r.Exchange,</span><br><span class="line"><span class="string">&quot;fanout&quot;</span>,</span><br><span class="line"><span class="literal">true</span>,</span><br><span class="line"><span class="literal">false</span>,</span><br><span class="line"><span class="literal">false</span>, <span class="comment">//trueè¡¨ç¤ºè¿™ä¸ªexchangeä¸å¯ä»¥è¢«clientç”¨æ¥æ¨é€æ¶ˆæ¯ï¼Œä»…ç”¨æ¥è¿›è¡Œexchangeå’Œexchangeä¹‹é—´çš„ç»‘å®š</span></span><br><span class="line"><span class="literal">false</span>,</span><br><span class="line"><span class="literal">nil</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">r.failOnErr(err, <span class="string">&quot;Failed to declare an exchange&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//todo å‘é€æ¶ˆæ¯</span></span><br><span class="line">err = r.channel.Publish(</span><br><span class="line">r.Exchange,</span><br><span class="line"><span class="string">&quot;&quot;</span>,</span><br><span class="line"><span class="literal">false</span>,</span><br><span class="line"><span class="literal">false</span>,</span><br><span class="line">amqp.Publishing&#123;</span><br><span class="line">ContentType: <span class="string">&quot;text/plain&quot;</span>,</span><br><span class="line">Body:        []<span class="keyword">byte</span>(message),</span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ReceiveSub è®¢é˜…æ¨¡å¼æ¶ˆè´¹ç«¯ä»£ç </span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(r *RabbitMQ)</span> <span class="title">ReceiveSub</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">//todo è¯•æ¢æ€§åˆ›å»ºäº¤æ¢æœº</span></span><br><span class="line">err := r.channel.ExchangeDeclare(</span><br><span class="line">r.Exchange,</span><br><span class="line"><span class="string">&quot;fanout&quot;</span>, <span class="comment">//äº¤æ¢æœºç±»å‹</span></span><br><span class="line"><span class="literal">true</span>,</span><br><span class="line"><span class="literal">false</span>,</span><br><span class="line"><span class="literal">false</span>, <span class="comment">//trueè¡¨ç¤ºè¿™ä¸ªexchangeä¸å¯ä»¥è¢«clientç”¨æ¥æ¨é€æ¶ˆæ¯ï¼Œä»…ç”¨æ¥è¿›è¡Œexchangeå’Œexchangeä¹‹é—´çš„ç»‘å®š</span></span><br><span class="line"><span class="literal">false</span>,</span><br><span class="line"><span class="literal">nil</span>,</span><br><span class="line">)</span><br><span class="line">r.failOnErr(err, <span class="string">&quot;Failed to declare an exchange&quot;</span>)</span><br><span class="line"><span class="comment">//todo è¯•æ¢æ€§åˆ›å»ºé˜Ÿåˆ—ï¼Œè¿™é‡Œæ³¨æ„é˜Ÿåˆ—åç§°ä¸è¦å†™</span></span><br><span class="line">q, err := r.channel.QueueDeclare(</span><br><span class="line"><span class="string">&quot;&quot;</span>, <span class="comment">//éšæœºç”Ÿäº§é˜Ÿåˆ—åç§°</span></span><br><span class="line"><span class="literal">false</span>,</span><br><span class="line"><span class="literal">false</span>,</span><br><span class="line"><span class="literal">true</span>,</span><br><span class="line"><span class="literal">false</span>,</span><br><span class="line"><span class="literal">nil</span>,</span><br><span class="line">)</span><br><span class="line">r.failOnErr(err, <span class="string">&quot;Failed to declare a queue&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//todo ç»‘å®šé˜Ÿåˆ—åˆ° exchange ä¸­</span></span><br><span class="line">err = r.channel.QueueBind(</span><br><span class="line">q.Name,</span><br><span class="line"><span class="string">&quot;&quot;</span>, <span class="comment">//åœ¨pub/subæ¨¡å¼ä¸‹ï¼Œè¿™é‡Œçš„keyè¦ä¸ºç©º</span></span><br><span class="line">r.Exchange,</span><br><span class="line"><span class="literal">false</span>,</span><br><span class="line"><span class="literal">nil</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//todo æ¶ˆè´¹æ¶ˆæ¯</span></span><br><span class="line">message, err := r.channel.Consume(</span><br><span class="line">q.Name,</span><br><span class="line"><span class="string">&quot;&quot;</span>,</span><br><span class="line"><span class="literal">true</span>,</span><br><span class="line"><span class="literal">false</span>,</span><br><span class="line"><span class="literal">false</span>,</span><br><span class="line"><span class="literal">false</span>,</span><br><span class="line"><span class="literal">nil</span>,</span><br><span class="line">)</span><br><span class="line">forever := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">bool</span>)</span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">for</span> d := <span class="keyword">range</span> message &#123;</span><br><span class="line">log.Printf(<span class="string">&quot;Received a message: %s&quot;</span>, d.Body)</span><br><span class="line">&#125;</span><br><span class="line">&#125;()</span><br><span class="line">fmt.Println(<span class="string">&quot;é€€å‡ºè¯·æŒ‰ CTRL+C\n&quot;</span>)</span><br><span class="line">&lt;-forever</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// NewRabbitMQRouting è·¯ç”±æ¨¡å¼</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewRabbitMQRouting</span><span class="params">(exchangeName <span class="keyword">string</span>, routingKey <span class="keyword">string</span>)</span> *<span class="title">RabbitMQ</span></span> &#123;</span><br><span class="line"><span class="comment">//todo åˆ›å»ºRabbitMQå®ä¾‹</span></span><br><span class="line">rabbitmq := NewRabbitMQ(<span class="string">&quot;&quot;</span>, exchangeName, routingKey)</span><br><span class="line"><span class="keyword">var</span> err error</span><br><span class="line"><span class="comment">//todo è·å–connection è·å–channel</span></span><br><span class="line">rabbitmq.conn, err = amqp.Dial(rabbitmq.Mqurl)</span><br><span class="line">rabbitmq.failOnErr(err, <span class="string">&quot;failed to connect rabbitmq!&quot;</span>)</span><br><span class="line">rabbitmq.channel, err = rabbitmq.conn.Channel()</span><br><span class="line">rabbitmq.failOnErr(err, <span class="string">&quot;failed to open a channel&quot;</span>)</span><br><span class="line"><span class="keyword">return</span> rabbitmq</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// PublishRouting è·¯ç”±æ¨¡å¼å‘é€æ¶ˆæ¯</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(r *RabbitMQ)</span> <span class="title">PublishRouting</span><span class="params">(message <span class="keyword">string</span>)</span></span> &#123;</span><br><span class="line"><span class="comment">//1.å°è¯•åˆ›å»ºäº¤æ¢æœº</span></span><br><span class="line">err := r.channel.ExchangeDeclare(</span><br><span class="line">r.Exchange,</span><br><span class="line"><span class="string">&quot;direct&quot;</span>,</span><br><span class="line"><span class="literal">true</span>,</span><br><span class="line"><span class="literal">false</span>,</span><br><span class="line"><span class="literal">false</span>,</span><br><span class="line"><span class="literal">false</span>,</span><br><span class="line"><span class="literal">nil</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">r.failOnErr(err, <span class="string">&quot;Failed to declare an exchange&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.å‘é€æ¶ˆæ¯</span></span><br><span class="line">err = r.channel.Publish(</span><br><span class="line">r.Exchange,</span><br><span class="line"><span class="comment">//è¦è®¾ç½®</span></span><br><span class="line">r.Key,</span><br><span class="line"><span class="literal">false</span>,</span><br><span class="line"><span class="literal">false</span>,</span><br><span class="line">amqp.Publishing&#123;</span><br><span class="line">ContentType: <span class="string">&quot;text/plain&quot;</span>,</span><br><span class="line">Body:        []<span class="keyword">byte</span>(message),</span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ReceiveRouting è·¯ç”±æ¨¡å¼æ¥å—æ¶ˆæ¯</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(r *RabbitMQ)</span> <span class="title">ReceiveRouting</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">// todo è¯•æ¢æ€§åˆ›å»ºäº¤æ¢æœº</span></span><br><span class="line">err := r.channel.ExchangeDeclare(</span><br><span class="line">r.Exchange,</span><br><span class="line"><span class="comment">//äº¤æ¢æœºç±»å‹</span></span><br><span class="line"><span class="string">&quot;direct&quot;</span>,</span><br><span class="line"><span class="literal">true</span>,</span><br><span class="line"><span class="literal">false</span>,</span><br><span class="line"><span class="literal">false</span>,</span><br><span class="line"><span class="literal">false</span>,</span><br><span class="line"><span class="literal">nil</span>,</span><br><span class="line">)</span><br><span class="line">r.failOnErr(err, <span class="string">&quot;Failed to declare an exchange&quot;</span>)</span><br><span class="line"><span class="comment">// todo è¯•æ¢æ€§åˆ›å»ºé˜Ÿåˆ—ï¼Œè¿™é‡Œæ³¨æ„é˜Ÿåˆ—åç§°ä¸è¦å†™</span></span><br><span class="line">q, err := r.channel.QueueDeclare(</span><br><span class="line"><span class="string">&quot;&quot;</span>, <span class="comment">//éšæœºç”Ÿäº§é˜Ÿåˆ—åç§°</span></span><br><span class="line"><span class="literal">false</span>,</span><br><span class="line"><span class="literal">false</span>,</span><br><span class="line"><span class="literal">true</span>,</span><br><span class="line"><span class="literal">false</span>,</span><br><span class="line"><span class="literal">nil</span>,</span><br><span class="line">)</span><br><span class="line">r.failOnErr(err, <span class="string">&quot;Failed to declare a queue&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç»‘å®šé˜Ÿåˆ—åˆ° exchange ä¸­</span></span><br><span class="line">err = r.channel.QueueBind(</span><br><span class="line">q.Name,</span><br><span class="line"><span class="comment">//éœ€è¦ç»‘å®škey</span></span><br><span class="line">r.Key,</span><br><span class="line">r.Exchange,</span><br><span class="line"><span class="literal">false</span>,</span><br><span class="line"><span class="literal">nil</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// todo æ¶ˆè´¹æ¶ˆæ¯</span></span><br><span class="line">message, err := r.channel.Consume(</span><br><span class="line">q.Name,</span><br><span class="line"><span class="string">&quot;&quot;</span>,</span><br><span class="line"><span class="literal">true</span>,</span><br><span class="line"><span class="literal">false</span>,</span><br><span class="line"><span class="literal">false</span>,</span><br><span class="line"><span class="literal">false</span>,</span><br><span class="line"><span class="literal">nil</span>,</span><br><span class="line">)</span><br><span class="line">forever := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">bool</span>)</span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">for</span> d := <span class="keyword">range</span> message &#123;</span><br><span class="line">log.Printf(<span class="string">&quot;Received a message: %s&quot;</span>, d.Body)</span><br><span class="line">&#125;</span><br><span class="line">&#125;()</span><br><span class="line">fmt.Println(<span class="string">&quot;é€€å‡ºè¯·æŒ‰ CTRL+C\n&quot;</span>)</span><br><span class="line">&lt;-forever</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// NewRabbitMQTopic è¯é¢˜æ¨¡å¼</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewRabbitMQTopic</span><span class="params">(exchangeName <span class="keyword">string</span>, routingKey <span class="keyword">string</span>)</span> *<span class="title">RabbitMQ</span></span> &#123;</span><br><span class="line"><span class="comment">// todo åˆ›å»ºRabbitMQå®ä¾‹</span></span><br><span class="line">rabbitmq := NewRabbitMQ(<span class="string">&quot;&quot;</span>, exchangeName, routingKey)</span><br><span class="line"><span class="keyword">var</span> err error</span><br><span class="line"><span class="comment">// todo è·å–connectionä¸è·å–channel</span></span><br><span class="line">rabbitmq.conn, err = amqp.Dial(rabbitmq.Mqurl)</span><br><span class="line">rabbitmq.failOnErr(err, <span class="string">&quot;failed to connect rabbitmq!&quot;</span>)</span><br><span class="line">rabbitmq.channel, err = rabbitmq.conn.Channel()</span><br><span class="line">rabbitmq.failOnErr(err, <span class="string">&quot;failed to open a channel&quot;</span>)</span><br><span class="line"><span class="keyword">return</span> rabbitmq</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// PublishTopic è¯é¢˜æ¨¡å¼å‘é€æ¶ˆæ¯</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(r *RabbitMQ)</span> <span class="title">PublishTopic</span><span class="params">(message <span class="keyword">string</span>)</span></span> &#123;</span><br><span class="line"><span class="comment">// todo å°è¯•åˆ›å»ºäº¤æ¢æœº</span></span><br><span class="line">err := r.channel.ExchangeDeclare(</span><br><span class="line">r.Exchange,</span><br><span class="line"><span class="string">&quot;topic&quot;</span>,</span><br><span class="line"><span class="literal">true</span>,</span><br><span class="line"><span class="literal">false</span>,</span><br><span class="line"><span class="literal">false</span>,</span><br><span class="line"><span class="literal">false</span>,</span><br><span class="line"><span class="literal">nil</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">r.failOnErr(err, <span class="string">&quot;Failed to declare an exchange&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// todo å‘é€æ¶ˆæ¯</span></span><br><span class="line">err = r.channel.Publish(</span><br><span class="line">r.Exchange,</span><br><span class="line"><span class="comment">//è¦è®¾ç½®</span></span><br><span class="line">r.Key,</span><br><span class="line"><span class="literal">false</span>,</span><br><span class="line"><span class="literal">false</span>,</span><br><span class="line">amqp.Publishing&#123;</span><br><span class="line">ContentType: <span class="string">&quot;text/plain&quot;</span>,</span><br><span class="line">Body:        []<span class="keyword">byte</span>(message),</span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ReceiveTopic è¯é¢˜æ¨¡å¼æ¥å—æ¶ˆæ¯</span></span><br><span class="line"><span class="comment">//è¦æ³¨æ„key,è§„åˆ™</span></span><br><span class="line"><span class="comment">//å…¶ä¸­â€œ*â€ç”¨äºåŒ¹é…ä¸€ä¸ªå•è¯ï¼Œâ€œ#â€ç”¨äºåŒ¹é…å¤šä¸ªå•è¯ï¼ˆå¯ä»¥æ˜¯é›¶ä¸ªï¼‰</span></span><br><span class="line"><span class="comment">//åŒ¹é… xx.* è¡¨ç¤ºåŒ¹é… xx.hello, ä½†æ˜¯ xx.hello.oneéœ€è¦ç”¨ xx.#æ‰èƒ½åŒ¹é…åˆ°</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(r *RabbitMQ)</span> <span class="title">ReceiveTopic</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">//1.è¯•æ¢æ€§åˆ›å»ºäº¤æ¢æœº</span></span><br><span class="line">err := r.channel.ExchangeDeclare(</span><br><span class="line">r.Exchange,</span><br><span class="line"><span class="comment">//äº¤æ¢æœºç±»å‹</span></span><br><span class="line"><span class="string">&quot;topic&quot;</span>,</span><br><span class="line"><span class="literal">true</span>,</span><br><span class="line"><span class="literal">false</span>,</span><br><span class="line"><span class="literal">false</span>,</span><br><span class="line"><span class="literal">false</span>,</span><br><span class="line"><span class="literal">nil</span>,</span><br><span class="line">)</span><br><span class="line">r.failOnErr(err, <span class="string">&quot;Failed to declare an exch&quot;</span>+</span><br><span class="line"><span class="string">&quot;ange&quot;</span>)</span><br><span class="line"><span class="comment">//2.è¯•æ¢æ€§åˆ›å»ºé˜Ÿåˆ—ï¼Œè¿™é‡Œæ³¨æ„é˜Ÿåˆ—åç§°ä¸è¦å†™</span></span><br><span class="line">q, err := r.channel.QueueDeclare(</span><br><span class="line"><span class="string">&quot;&quot;</span>, <span class="comment">//éšæœºç”Ÿäº§é˜Ÿåˆ—åç§°</span></span><br><span class="line"><span class="literal">false</span>,</span><br><span class="line"><span class="literal">false</span>,</span><br><span class="line"><span class="literal">true</span>,</span><br><span class="line"><span class="literal">false</span>,</span><br><span class="line"><span class="literal">nil</span>,</span><br><span class="line">)</span><br><span class="line">r.failOnErr(err, <span class="string">&quot;Failed to declare a queue&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç»‘å®šé˜Ÿåˆ—åˆ° exchange ä¸­</span></span><br><span class="line">err = r.channel.QueueBind(</span><br><span class="line">q.Name,</span><br><span class="line"><span class="comment">//åœ¨pub/subæ¨¡å¼ä¸‹ï¼Œè¿™é‡Œçš„keyè¦ä¸ºç©º</span></span><br><span class="line">r.Key,</span><br><span class="line">r.Exchange,</span><br><span class="line"><span class="literal">false</span>,</span><br><span class="line"><span class="literal">nil</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ¶ˆè´¹æ¶ˆæ¯</span></span><br><span class="line">message, err := r.channel.Consume(</span><br><span class="line">q.Name,</span><br><span class="line"><span class="string">&quot;&quot;</span>,</span><br><span class="line"><span class="literal">true</span>,</span><br><span class="line"><span class="literal">false</span>,</span><br><span class="line"><span class="literal">false</span>,</span><br><span class="line"><span class="literal">false</span>,</span><br><span class="line"><span class="literal">nil</span>,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">forever := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">bool</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="keyword">for</span> d := <span class="keyword">range</span> message &#123;</span><br><span class="line">log.Printf(<span class="string">&quot;Received a message: %s&quot;</span>, d.Body)</span><br><span class="line">&#125;</span><br><span class="line">&#125;()</span><br><span class="line"></span><br><span class="line">fmt.Println(<span class="string">&quot;é€€å‡ºè¯·æŒ‰ CTRL+C\n&quot;</span>)</span><br><span class="line">&lt;-forever</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å„ä¸ªæ¨¡å¼å®ç°">å„ä¸ªæ¨¡å¼å®ç°</h3><blockquote><p>å› ä¸ºä¸ç¡®å®šåŒ…çš„ä½ç½®</p><p>æ‰€ä»¥æŠ¥çº¢ç®€å•å†™ä¸€ä¸‹å¼•å…¥ä¸Šé¢çš„ä»“åº“æ–‡ä»¶å°±å¥½äº†</p></blockquote><ol><li>ç®€å•æ¨¡å¼</li></ol><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‘å¸ƒè€…</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">// todo åˆ›å»ºå®ä¾‹å¹¶å‘é€æ¶ˆæ¯</span></span><br><span class="line">rabbitmq := RabbitMQ.NewRabbitMQSimple(<span class="string">&quot;Simple&quot;</span>)</span><br><span class="line">rabbitmq.PublishSimple(<span class="string">&quot;Hello world!&quot;</span>)</span><br><span class="line">fmt.Println(<span class="string">&quot;å‘é€æˆåŠŸï¼&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ¥å—è€…</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">rabbitmq := RabbitMQ.NewRabbitMQSimple(<span class="string">&quot;Simple&quot;</span>) <span class="comment">// åå­—è¦ä¸€æ ·</span></span><br><span class="line">rabbitmq.ConsumeSimple()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>å·¥ä½œæ¨¡å¼</li></ol><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‘å¸ƒè€…</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">rabbitmq := RabbitMQ.NewRabbitMQSimple(<span class="string">&quot;Simple&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt;= <span class="number">100</span>; i++ &#123;</span><br><span class="line">rabbitmq.PublishSimple(<span class="string">&quot;Hello world!&quot;</span> + strconv.Itoa(i))</span><br><span class="line">time.Sleep(<span class="number">1</span> * time.Second)</span><br><span class="line">fmt.Println(i)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ¥å—è€…1</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">rabbitmq := RabbitMQ.NewRabbitMQSimple(<span class="string">&quot;Simple&quot;</span>)</span><br><span class="line">rabbitmq.ConsumeSimple()</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ¥å—è€…2</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">rabbitmq := RabbitMQ.NewRabbitMQSimple(<span class="string">&quot;Simple&quot;</span>)</span><br><span class="line">rabbitmq.ConsumeSimple()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>å‘å¸ƒæ¨¡å¼</li></ol><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‘å¸ƒè€…</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">rabbitmq := RabbitMQ.NewRabbitMQPubSub(<span class="string">&quot;newProduct&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">100</span>; i++ &#123;</span><br><span class="line">rabbitmq.PublishPub(<span class="string">&quot;è®¢é˜…æ¨¡å¼ç”Ÿäº§ç¬¬&quot;</span> + strconv.Itoa(i) + <span class="string">&quot;æ¡&quot;</span> + <span class="string">&quot;æ•°æ®&quot;</span>)</span><br><span class="line">fmt.Println(<span class="string">&quot;è®¢é˜…æ¨¡å¼ç”Ÿäº§ç¬¬&quot;</span> + strconv.Itoa(i) + <span class="string">&quot;æ¡&quot;</span> + <span class="string">&quot;æ•°æ®&quot;</span>)</span><br><span class="line">time.Sleep(<span class="number">1</span> * time.Second)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è®¢é˜…è€…1</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">rabbitmq := RabbitMQ.NewRabbitMQPubSub(<span class="string">&quot;newProduct&quot;</span>)</span><br><span class="line">rabbitmq.ReceiveSub()</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è®¢é˜…è€…2</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">rabbitmq := RabbitMQ.NewRabbitMQPubSub(<span class="string">&quot;newProduct&quot;</span>)</span><br><span class="line">rabbitmq.ReceiveSub()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="4"><li>è·¯ç”±æ¨¡å¼</li></ol><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‘å¸ƒè€…</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">One := RabbitMQ.NewRabbitMQRouting(<span class="string">&quot;ex&quot;</span>, <span class="string">&quot;one&quot;</span>)</span><br><span class="line">Two := RabbitMQ.NewRabbitMQRouting(<span class="string">&quot;ex&quot;</span>, <span class="string">&quot;two&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt;= <span class="number">10</span>; i++ &#123;</span><br><span class="line">One.PublishRouting(<span class="string">&quot;Hello one!&quot;</span> + strconv.Itoa(i))</span><br><span class="line">Two.PublishRouting(<span class="string">&quot;Hello Two!&quot;</span> + strconv.Itoa(i))</span><br><span class="line">time.Sleep(<span class="number">1</span> * time.Second)</span><br><span class="line">fmt.Println(i)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ¥å—è€…</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">One := RabbitMQ.NewRabbitMQRouting(<span class="string">&quot;ex&quot;</span>, <span class="string">&quot;one&quot;</span>)</span><br><span class="line">One.ReceiveRouting()</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ¥å—è€…</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">Two := RabbitMQ.NewRabbitMQRouting(<span class="string">&quot;ex&quot;</span>, <span class="string">&quot;two&quot;</span>)</span><br><span class="line">Two.ReceiveRouting()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="5"><li>è¯é¢˜æ¨¡å¼</li></ol><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‘å¸ƒè€…</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">One := RabbitMQ.NewRabbitMQTopic(<span class="string">&quot;exTopic&quot;</span>, <span class="string">&quot;topic.one&quot;</span>)</span><br><span class="line">Two := RabbitMQ.NewRabbitMQTopic(<span class="string">&quot;exTopic&quot;</span>, <span class="string">&quot;topic.two&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt;= <span class="number">10</span>; i++ &#123;</span><br><span class="line">One.PublishTopic(<span class="string">&quot;Hello topic one!&quot;</span> + strconv.Itoa(i))</span><br><span class="line">Two.PublishTopic(<span class="string">&quot;Hello topic Two!&quot;</span> + strconv.Itoa(i))</span><br><span class="line">time.Sleep(<span class="number">1</span> * time.Second)</span><br><span class="line">fmt.Println(i)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ¥å—è€…1</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">One := RabbitMQ.NewRabbitMQTopic(<span class="string">&quot;exTopic&quot;</span>, <span class="string">&quot;#&quot;</span>) <span class="comment">// # è¡¨ç¤ºä¸€ä¸ªæˆ–è€…å¤šä¸ªè¯è¯­</span></span><br><span class="line">One.ReceiveTopic()</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æ¥å—è€…2</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">Two := RabbitMQ.NewRabbitMQTopic(<span class="string">&quot;exTopic&quot;</span>, <span class="string">&quot;*.two&quot;</span>) <span class="comment">// è¡¨ç¤ºå¤šä¸ªè¯è¯­</span></span><br><span class="line">Two.ReceiveTopic()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å¼€å‘ </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Pygameå®ç°å°çƒèº²é¿</title>
      <link href="/article/72f74028.html"/>
      <url>/article/72f74028.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€ï¼š-4">å‰è¨€ï¼š</h2><p>è¿™å­¦æœŸçš„Pythonè¯¾ï¼Œè¦å†™ä»£ç æ˜¯çœŸçš„å¤šâ€¦</p><p>è¯¾ç¨‹å®éªŒä¸€æ˜¯ä¸€ä¸ªäº”å­æ£‹ï¼Œä½†æ˜¯å‘äº†ä»£ç ã€‚</p><p>è‡³äºä»£ç è´¨é‡å˜›ï½  æˆ‘ç›´æ¥å…¨éƒ¨æ ¹æ®è‡ªå·±åˆ’åˆ†çš„ç»“æ„æ”¹äº†</p><p>è¿™é‡Œåæ§½ä¸‹ (çœŸçš„å‘ä¸‹æ¥çš„ä»£ç  æƒ¨ä¸å¿ç¹ )</p><p>æˆ‘æ”¹äº†å¿«4ä¸ªå°æ—¶ åé¢åŠŸèƒ½ä¸æƒ³åŠ äº†â€¦</p><p>è¿™æ¬¡æ˜¯è‡ªå·±å†™å˜›ï½ é‚£å°±å†™ä¸ªæƒ³æ ·çš„ã€‚</p><h2 id="ç»“æ„åˆ’åˆ†">ç»“æ„åˆ’åˆ†</h2><p>æˆ‘åˆ†ä¸ºäº†</p><ul><li>run  å…¥å£</li><li>setting  è®¾ç½®</li><li>main ä¸»é€»è¾‘</li><li>utils ä»“åº“</li></ul><p>å…¶å®æˆ‘æƒ³çš„æ˜¯ï¼šå…¨éƒ¨è®¾ç½®åˆ°é¡µé¢ä¸Šå»ï¼Œä½†æ˜¯å·æ‡’ï½ ï¼ˆæœŸæœ«è¦å»å¼„ç»©ç‚¹ï¼‰</p><p>ç›´æ¥å¼€å§‹è´´ä»£ç </p><h3 id="run-py"><a href="http://run.py">run.py</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> main <span class="keyword">import</span> main</span><br><span class="line"></span><br><span class="line">banner = <span class="string">&quot;&quot;&quot; ____        _ _ _____          </span></span><br><span class="line"><span class="string">| __ )  __ _| | | ____|___  ___ </span></span><br><span class="line"><span class="string">|  _ \ / _` | | |  _| / __|/ __|</span></span><br><span class="line"><span class="string">| |_) | (_| | | | |___\__ \ (__ </span></span><br><span class="line"><span class="string">|____/ \__,_|_|_|_____|___/\___|</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="built_in">print</span>(banner)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Author: HengYi&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[*] ç®€å•ï¼šè¾“å…¥ 1&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[*] æ™®é€šï¼šè¾“å…¥ 2&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[*] å›°éš¾ï¼šè¾“å…¥ 3&quot;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        num = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;è¯·é€‰æ‹©éš¾åº¦ï¼š&quot;</span>))</span><br><span class="line">        <span class="keyword">if</span> num <span class="keyword">in</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]:</span><br><span class="line">            main(num)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;æ— æ³•å¤„ç†ï½&quot;</span>)</span><br><span class="line">            sys.exit()</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">&quot;æ— æ³•å¤„ç†ï½&quot;</span>)</span><br></pre></td></tr></table></figure><h3 id="setting-py"><a href="http://setting.py">setting.py</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">WIDTH = <span class="number">900</span>  <span class="comment"># å®½</span></span><br><span class="line">HEIGHT = <span class="number">600</span>  <span class="comment"># é«˜</span></span><br><span class="line">SCORE = <span class="number">0</span>  <span class="comment"># åˆ†æ•°</span></span><br><span class="line">TIME = <span class="number">0</span>  <span class="comment"># æ—¶é—´</span></span><br><span class="line">FIRST_STEP = <span class="number">10</span>  <span class="comment"># åˆ°è¾¾ç¬¬äºŒå…³æ—¶é—´</span></span><br><span class="line">SECOND_STEP = <span class="number">20</span>  <span class="comment"># åˆ°è¾¾ç¬¬ä¸‰å…³æ—¶é—´</span></span><br><span class="line">FPS = <span class="number">60</span>  <span class="comment"># åˆ·æ–°ç‡</span></span><br><span class="line">BG_COLOR = (<span class="number">255</span>, <span class="number">239</span>, <span class="number">213</span>)  <span class="comment"># èƒŒæ™¯é¢œè‰²</span></span><br></pre></td></tr></table></figure><h3 id="utils-py"><a href="http://utils.py">utils.py</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> pygame</span><br><span class="line"><span class="keyword">from</span> setting <span class="keyword">import</span> FIRST_STEP, SECOND_STEP, BG_COLOR, WIDTH, HEIGHT</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Note: æ ¹æ®éš¾åº¦ç”Ÿæˆå¯¹åº”çš„å°çƒ</span></span><br><span class="line"><span class="comment"># Time: 2021/12/17 8:35 ä¸‹åˆ</span></span><br><span class="line"><span class="comment"># Author: HengYi</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ballNum</span>(<span class="params">ladderNum, time</span>):</span></span><br><span class="line">    index = <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> FIRST_STEP &lt;= time &lt; SECOND_STEP:</span><br><span class="line">        index = <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> SECOND_STEP &lt;= time:</span><br><span class="line">        index = <span class="number">2</span></span><br><span class="line">    numMap = [</span><br><span class="line">        [<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>],</span><br><span class="line">        [<span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>],</span><br><span class="line">        [<span class="number">4</span>, <span class="number">6</span>, <span class="number">7</span>]</span><br><span class="line">    ]</span><br><span class="line">    <span class="keyword">return</span> numMap[ladderNum - <span class="number">1</span>][index]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Note: æ ¹æ®å°çƒä¸ªæ•°è®¾ç½®é˜²æ­¢è¯¯è§¦æ—¶é—´</span></span><br><span class="line"><span class="comment"># Time: 2021/12/17 8:43 ä¸‹åˆ</span></span><br><span class="line"><span class="comment"># Author: HengYi</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">protectTime</span>(<span class="params">ballsNum</span>):</span></span><br><span class="line">    <span class="keyword">if</span> ballsNum <span class="keyword">in</span> [<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Note: æ ¹æ®æ—¶é—´è®¾ç½®å°çƒå¤§å°</span></span><br><span class="line"><span class="comment"># Time: 2021/12/17 8:58 ä¸‹åˆ</span></span><br><span class="line"><span class="comment"># Author: HengYi</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">howBigBallIs</span>(<span class="params">ladderNum, time</span>):</span></span><br><span class="line">    index = <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> FIRST_STEP &lt;= time &lt; SECOND_STEP:</span><br><span class="line">        index = <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> SECOND_STEP &lt;= time:</span><br><span class="line">        index = <span class="number">2</span></span><br><span class="line">    numMap = [</span><br><span class="line">        [<span class="number">25</span>, <span class="number">20</span>, <span class="number">15</span>],</span><br><span class="line">        [<span class="number">24</span>, <span class="number">20</span>, <span class="number">16</span>],</span><br><span class="line">        [<span class="number">26</span>, <span class="number">20</span>, <span class="number">16</span>]</span><br><span class="line">    ]</span><br><span class="line">    <span class="keyword">return</span> numMap[ladderNum - <span class="number">1</span>][index]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Note: æ ¹æ®æ—¶é—´éš¾åº¦è®¡ç®—çƒä½“çš„å¤§å°å’Œé€Ÿåº¦</span></span><br><span class="line"><span class="comment"># Time: 2021/12/17 9:15 ä¸‹åˆ</span></span><br><span class="line"><span class="comment"># Author: HengYi</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">judgeDiff</span>(<span class="params">ladderNum, time</span>):</span></span><br><span class="line">    index = <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> FIRST_STEP &lt;= time &lt; SECOND_STEP:</span><br><span class="line">        index = <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> SECOND_STEP &lt;= time:</span><br><span class="line">        index = <span class="number">2</span></span><br><span class="line">    numMap = [</span><br><span class="line">        [(<span class="number">30</span>, <span class="number">30</span>, <span class="number">3.5</span>, <span class="number">3.5</span>), (<span class="number">28</span>, <span class="number">28</span>, <span class="number">6</span>, <span class="number">6</span>), (<span class="number">26</span>, <span class="number">26</span>, <span class="number">9</span>, <span class="number">9</span>)],</span><br><span class="line">        [(<span class="number">30</span>, <span class="number">30</span>, <span class="number">4.5</span>, <span class="number">4.5</span>), (<span class="number">27</span>, <span class="number">27</span>, <span class="number">8</span>, <span class="number">8</span>), (<span class="number">25</span>, <span class="number">25</span>, <span class="number">10</span>, <span class="number">10</span>)],</span><br><span class="line">        [(<span class="number">30</span>, <span class="number">30</span>, <span class="number">5</span>, <span class="number">5</span>), (<span class="number">26</span>, <span class="number">26</span>, <span class="number">9</span>, <span class="number">9</span>), (<span class="number">24</span>, <span class="number">24</span>, <span class="number">12</span>, <span class="number">12</span>)]</span><br><span class="line">    ]</span><br><span class="line">    <span class="keyword">return</span> numMap[ladderNum - <span class="number">1</span>][index]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Note: åˆ›å»ºå¹³å°çª—å£</span></span><br><span class="line"><span class="comment"># Time: 2021/12/17 2:58 ä¸‹åˆ</span></span><br><span class="line"><span class="comment"># Author: HengYi</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">makeGameBg</span>(<span class="params">width, height</span>):</span></span><br><span class="line">    pygame.init()</span><br><span class="line">    screen = pygame.display.set_mode((width, height))  <span class="comment"># è®¾ç½®çª—å£å¤§å°</span></span><br><span class="line">    pygame.display.set_caption(<span class="string">&#x27;å°çƒé€ƒé€ƒé€ƒ&#x27;</span>)  <span class="comment"># è®¾ç½®çª—å£æ ‡é¢˜</span></span><br><span class="line">    background = pygame.Surface(screen.get_size())  <span class="comment"># å¡«å……èƒŒæ™¯</span></span><br><span class="line">    <span class="keyword">return</span> screen, background</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Note: æ·»åŠ å°çƒäº§ç”Ÿçš„äº‹ä»¶</span></span><br><span class="line"><span class="comment"># Time: 2021/12/17 3:06 ä¸‹åˆ</span></span><br><span class="line"><span class="comment"># Author: HengYi</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ballCome</span>():</span></span><br><span class="line">    COME_AGAIN = pygame.USEREVENT</span><br><span class="line">    pygame.time.set_timer(COME_AGAIN, <span class="number">1000</span>)</span><br><span class="line">    <span class="keyword">return</span> COME_AGAIN</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Note: æç¤ºå­—ä½“</span></span><br><span class="line"><span class="comment"># Time: 2021/12/17 3:11 ä¸‹åˆ</span></span><br><span class="line"><span class="comment"># Author: HengYi</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">makeTips</span>(<span class="params">content, size, color, position, screen</span>):</span></span><br><span class="line">    font = pygame.font.SysFont(<span class="string">&#x27;arial&#x27;</span>, size)</span><br><span class="line">    text_sf = font.render(content, <span class="literal">True</span>, color, BG_COLOR)</span><br><span class="line">    screen.blit(text_sf, position)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Note: å­—ä½“å±•ç¤º</span></span><br><span class="line"><span class="comment"># Time: 2021/12/18 4:20 ä¸‹åˆ</span></span><br><span class="line"><span class="comment"># Author: HengYi</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">draw</span>(<span class="params">screen, SCORE, TIME</span>):</span></span><br><span class="line">    screen.fill(BG_COLOR)  <span class="comment"># é˜²æ­¢å‡ºç°æ‹–å½±</span></span><br><span class="line">    makeTips(<span class="string">&#x27;SCORE: &#x27;</span>, <span class="number">30</span>, (<span class="number">34</span>, <span class="number">139</span>, <span class="number">34</span>), (<span class="number">5</span>, <span class="number">40</span>), screen)</span><br><span class="line">    makeTips(<span class="string">&#x27;TIME(s): &#x27;</span>, <span class="number">30</span>, (<span class="number">64</span>, <span class="number">158</span>, <span class="number">255</span>), (<span class="number">5</span>, <span class="number">75</span>), screen)</span><br><span class="line">    makeTips(<span class="built_in">str</span>(<span class="built_in">int</span>(SCORE)), <span class="number">30</span>, (<span class="number">34</span>, <span class="number">139</span>, <span class="number">34</span>), (<span class="number">135</span>, <span class="number">40</span>), screen)</span><br><span class="line">    makeTips(<span class="built_in">str</span>(<span class="built_in">int</span>(TIME)), <span class="number">30</span>, (<span class="number">64</span>, <span class="number">158</span>, <span class="number">255</span>), (<span class="number">135</span>, <span class="number">75</span>), screen)</span><br><span class="line">    <span class="keyword">if</span> TIME <span class="keyword">in</span> [FIRST_STEP, FIRST_STEP + <span class="number">1</span>]:</span><br><span class="line">        makeTips(<span class="string">&#x27;Ops! LEVEL_2~&#x27;</span>, <span class="number">30</span>, (<span class="number">60</span>, <span class="number">179</span>, <span class="number">113</span>), (WIDTH / <span class="number">2</span> - <span class="number">30</span> * <span class="number">3.5</span>, HEIGHT / <span class="number">2</span> - <span class="number">50</span>), screen)</span><br><span class="line">    <span class="keyword">elif</span> TIME <span class="keyword">in</span> [SECOND_STEP, SECOND_STEP + <span class="number">1</span>]:</span><br><span class="line">        makeTips(<span class="string">&#x27;Congratulations! LEVEL_3&#x27;</span>, <span class="number">25</span>, (<span class="number">60</span>, <span class="number">179</span>, <span class="number">113</span>), (WIDTH / <span class="number">2</span> - <span class="number">25</span> * <span class="number">6.25</span>, HEIGHT / <span class="number">2</span> - <span class="number">50</span>), screen)</span><br></pre></td></tr></table></figure><h3 id="Main-py"><a href="http://Main.py">Main.py</a></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> setting <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> utils <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Ball</span>(<span class="params">pygame.sprite.Sprite</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, *keys</span>):</span>  <span class="comment"># åˆ›å»ºçƒ</span></span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        self.timeSec = <span class="number">0</span></span><br><span class="line">        w, h, xs, ys = keys[<span class="number">0</span>]</span><br><span class="line">        self.w = w</span><br><span class="line">        self.h = h</span><br><span class="line">        self.xs = xs</span><br><span class="line">        self.ys = ys</span><br><span class="line">        x = random.randint(<span class="number">0</span>, WIDTH - self.w)</span><br><span class="line">        y = random.randint(<span class="number">0</span>, HEIGHT - self.h)</span><br><span class="line">        self.rect = pygame.Rect(x, y, self.w * <span class="number">2</span>, self.h * <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">update</span>(<span class="params">self, screen, *args</span>):</span></span><br><span class="line">        <span class="comment"># æ ¹æ®è®¾ç½®çš„é€Ÿåº¦è¿›è¡Œè¿åŠ¨</span></span><br><span class="line">        self.rect.x += self.xs</span><br><span class="line">        self.rect.y += self.ys</span><br><span class="line">        <span class="comment"># å½“é‡åˆ°å¢™çš„æ—¶å€™è¿›è¡Œåå¼¹</span></span><br><span class="line">        <span class="keyword">if</span> self.rect.x &gt; WIDTH - self.w <span class="keyword">or</span> self.rect.x &lt; <span class="number">0</span>:</span><br><span class="line">            self.xs = -self.xs</span><br><span class="line">        <span class="keyword">elif</span> self.rect.y &gt; HEIGHT - self.h <span class="keyword">or</span> self.rect.y &lt; <span class="number">0</span>:</span><br><span class="line">            self.ys = -self.ys</span><br><span class="line">        <span class="keyword">if</span> self.timeSec &lt;= args[<span class="number">0</span>]:</span><br><span class="line">            pygame.draw.rect(screen, (<span class="number">100</span>, <span class="number">149</span>, <span class="number">237</span>), [self.rect.x, self.rect.y, self.rect.w, self.rect.h], <span class="number">2</span>)</span><br><span class="line">        pygame.draw.circle(screen, (<span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>), [self.rect.center[<span class="number">0</span>], self.rect.center[<span class="number">1</span>]], self.w)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">timerAdd</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.timeSec += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> self.timeSec</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__del__</span>(<span class="params">self</span>):</span>  <span class="comment"># é”€æ¯çš„æ—¶å€™</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Mouse</span>(<span class="params">pygame.sprite.Sprite</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, *keys</span>):</span></span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        self.size = keys[<span class="number">0</span>]  <span class="comment"># è®¾ç½®åœ†çš„å¤§å°</span></span><br><span class="line">        self.rect = pygame.Rect(WIDTH / <span class="number">2</span> - self.size, HEIGHT / <span class="number">2</span> - self.size, self.size * <span class="number">2</span>, self.size * <span class="number">2</span>)  <span class="comment"># å®åˆ™æ˜¯ä¸€ä¸ªæ­£æ–¹å½¢</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">update</span>(<span class="params">self, screen, *args</span>):</span></span><br><span class="line">        <span class="keyword">if</span> pygame.mouse.get_focused():  <span class="comment"># å¦‚æœå­˜åœ¨äºé¡µé¢å†…</span></span><br><span class="line">            self.rect.center = pygame.mouse.get_pos()</span><br><span class="line">        <span class="comment"># é™åˆ¶çƒä¸èƒ½åŠèº«è·‘åˆ°è¾¹æ¡†ä¸Š</span></span><br><span class="line">        <span class="keyword">if</span> self.rect.x &lt; <span class="number">0</span>:</span><br><span class="line">            self.rect.x = <span class="number">0</span></span><br><span class="line">        <span class="keyword">elif</span> self.rect.x &gt; WIDTH - self.rect.w:</span><br><span class="line">            self.rect.x = WIDTH - self.rect.w</span><br><span class="line">        <span class="keyword">elif</span> self.rect.y &lt; <span class="number">0</span>:</span><br><span class="line">            self.rect.y = <span class="number">0</span></span><br><span class="line">        <span class="keyword">elif</span> self.rect.y &gt; HEIGHT - self.rect.h:</span><br><span class="line">            self.rect.y = HEIGHT - self.rect.h</span><br><span class="line">        pygame.draw.circle(screen, (<span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>), [self.rect.center[<span class="number">0</span>], self.rect.center[<span class="number">1</span>]], self.size)  <span class="comment"># æ ¹æ®åœ†å¿ƒç”»åœ†</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>(<span class="params">ladderNum</span>):</span></span><br><span class="line">    <span class="comment"># -------------------ç”»å¸ƒåˆå§‹åŒ–-----------------------</span></span><br><span class="line">    screen, background = makeGameBg(WIDTH, HEIGHT)</span><br><span class="line">    clock = pygame.time.Clock()</span><br><span class="line">    comeAgain = ballCome()</span><br><span class="line">    <span class="comment"># --------------------------------------------------</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># --------------------å¯¹è±¡å­˜å‚¨-------------------------</span></span><br><span class="line">    <span class="keyword">global</span> TIME, SCORE</span><br><span class="line">    balls = pygame.sprite.Group(Ball(judgeDiff(ladderNum, TIME)))</span><br><span class="line">    mouse = Mouse(howBigBallIs(ladderNum, TIME))</span><br><span class="line">    mouseObject = pygame.sprite.Group(mouse)</span><br><span class="line">    <span class="comment"># --------------------------------------------------</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># ---------------------æ¸¸æˆä¸»ç¨‹åº-----------------------</span></span><br><span class="line">    RUNNING = <span class="literal">True</span></span><br><span class="line">    SHOWINFO = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        draw(screen, SCORE, TIME)  <span class="comment"># åŠ¨æ€æ·»åŠ æ–‡å­—</span></span><br><span class="line">        <span class="keyword">if</span> SHOWINFO:</span><br><span class="line">            makeTips(<span class="string">&#x27;Please Press The Space To Restart&#x27;</span>, <span class="number">30</span>, (<span class="number">255</span>, <span class="number">99</span>, <span class="number">71</span>), (WIDTH / <span class="number">2</span> - <span class="number">240</span>, HEIGHT / <span class="number">2</span> - <span class="number">50</span>),</span><br><span class="line">                     screen)</span><br><span class="line">        <span class="keyword">for</span> each <span class="keyword">in</span> balls:</span><br><span class="line">            <span class="keyword">if</span> pygame.sprite.spritecollide(each, mouseObject, <span class="literal">False</span>, collided=<span class="literal">None</span>) <span class="keyword">and</span> each.timeSec &gt; <span class="number">2</span>:</span><br><span class="line">                RUNNING = <span class="literal">False</span></span><br><span class="line">                SHOWINFO = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">for</span> event <span class="keyword">in</span> pygame.event.get():</span><br><span class="line">            <span class="keyword">if</span> event.<span class="built_in">type</span> == pygame.QUIT:</span><br><span class="line">                pygame.quit()</span><br><span class="line">                exit(<span class="number">0</span>)</span><br><span class="line">            <span class="keyword">elif</span> event.<span class="built_in">type</span> == pygame.KEYDOWN:  <span class="comment"># é‡æ–°å¼€å§‹</span></span><br><span class="line">                <span class="keyword">if</span> event.key == pygame.K_SPACE:</span><br><span class="line">                    SCORE = <span class="number">0</span></span><br><span class="line">                    TIME = <span class="number">0</span></span><br><span class="line">                    <span class="keyword">for</span> each <span class="keyword">in</span> balls.sprites():</span><br><span class="line">                        balls.remove(each)</span><br><span class="line">                    SHOWINFO = <span class="literal">False</span></span><br><span class="line">                    RUNNING = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">elif</span> event.<span class="built_in">type</span> == comeAgain <span class="keyword">and</span> RUNNING:  <span class="comment"># æ¯ç§’å¢åŠ </span></span><br><span class="line">                TIME += <span class="number">1</span></span><br><span class="line">                ballsNum = ballNum(ladderNum, TIME)</span><br><span class="line">                diff = judgeDiff(ladderNum, TIME)</span><br><span class="line">                SCORE += (ballsNum * diff[<span class="number">3</span>])</span><br><span class="line">                <span class="keyword">if</span> TIME <span class="keyword">in</span> [<span class="number">10</span>, <span class="number">20</span>]:</span><br><span class="line">                    mouseObject.remove(mouseObject.sprites()[<span class="number">0</span>])</span><br><span class="line">                    mouseObject.add(Mouse(howBigBallIs(ladderNum, TIME)))</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(balls) &lt; ballsNum:</span><br><span class="line">                    balls.add(Ball(diff))</span><br><span class="line">                <span class="keyword">for</span> each <span class="keyword">in</span> balls:  <span class="comment"># é˜²æ­¢è¯¯è§¦çš„ä¿æŠ¤ç½©</span></span><br><span class="line">                    each.timerAdd()</span><br><span class="line">        balls.update(screen, protectTime(ballNum(ladderNum, TIME)))</span><br><span class="line">        mouseObject.update(screen)</span><br><span class="line">        clock.tick(FPS)</span><br><span class="line">        pygame.display.update()  <span class="comment"># åˆ·æ–°</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;æ¸¸æˆç»“æŸ&#x27;</span>)</span><br></pre></td></tr></table></figure><h2 id="æ€»ç»“-2">æ€»ç»“</h2><h3 id="æ•ˆæœå›¾ï¼š">æ•ˆæœå›¾ï¼š</h3><img src="/img/ballResult.webp" alt="æ•ˆæœå›¾" style="zoom:40%;" /><h3 id="å¦‚ä½•é£Ÿç”¨ï¼š">å¦‚ä½•é£Ÿç”¨ï¼š</h3><p>æŠŠä¸Šé¢4å¤„ä»£ç Copyä¸‹æ¥åœ¨ç”¨<code>run.py</code>å¯åŠ¨</p><p>é‡Œé¢è®¾è®¡çš„ å¦‚ä½•åˆ¤æ–­ï¼›å¦‚ä½•é‡æ¥ï¼›â€¦ (æˆ‘è§‰å¾—æˆ‘çš„å˜é‡åå­—å·²ç»å¤Ÿæ¸…æ¥šäº†ğŸ¶)</p><p>æ¬¢è¿ä¸æˆ‘äº¤æµï¼Œè®¨è®ºã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ä»˜è´¹è§†é¢‘ä¸‹è½½åˆ°æœ¬åœ°,å…³äºtsä¸m3u8æ–‡ä»¶ä¸‹è½½åçš„å¤ç›˜æ€»ç»“</title>
      <link href="/article/ba582517.html"/>
      <url>/article/ba582517.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€ï¼š-6">å‰è¨€ï¼š</h2><p>ä¸€åˆ‡çš„èµ·å› ï¼šå› ä¸ºæŸä¸ªåŒå­¦åœ¨æŸæ–¯ä¸Šé¢çš„ä¼šå‘˜å¿«è¦è¿‡æœŸäº†ï¼Œæƒ³æŠŠè§†é¢‘ä¸‹è½½åˆ°æœ¬åœ°è§‚çœ‹ã€‚<br>æˆ‘æƒ³è¿™è¿˜ä¸ç®€å•ï¼Ÿæ„‰å¿«çš„æ¥ä¸‹äº†ä»»åŠ¡ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘æƒ³æˆ‘æ˜¯ç¬‘ä¸å‡ºæ¥äº†ï¼Œä½†æ˜¯èµ°è¿‡æ¥è¿˜æ˜¯å€¼å¾—ã€‚</p><h2 id="æ±‚åŠ©æ’ä»¶">æ±‚åŠ©æ’ä»¶</h2><h3 id="You-Get">You-Get</h3><blockquote><p>ä¼šPythonçš„åº”è¯¥éƒ½å¬è¯´è¿‡<code>you-get</code>å§ï¼Œå°±æ˜¯æ”¯æŒå¤§å¤šæ•°è§†é¢‘çš„ä¸‹è½½<br>è¿™é‡Œæˆ‘ç›´æ¥æ”¾ä¸Šå¼€æºåœ°å€ï¼š<code>https://github.com/soimort/you-get</code><br>Bç«™çš„è§†é¢‘ä½ æƒ³ä¸‹è½½ä¸‹æ¥ç›´æ¥ç”¨è¿™ä¸ªå¤šçº¿ç¨‹è·‘å°±è¡Œäº†ã€‚</p></blockquote><h3 id="Flash-Video-Downloader">Flash Video Downloader</h3><blockquote><p>ä¸€ä¸ªåœ¨<code>Chrome</code>ä¸Šçš„æ’ä»¶ï¼Œä¸ç”¨è¯´äº†æ²¡ç”¨ã€‚</p></blockquote><h3 id="Video-DownloadHelper">Video DownloadHelper</h3><blockquote><p>ä¸€ä¸ªåœ¨Firefoxä¸Šçš„æ’ä»¶ï¼Œç¬¬ä¸€æ¬¡è¿˜æ£€æµ‹åˆ°äº†<br>ç„¶ååˆ·æ–°é¡µé¢ï¼Œå“¦è±æ²¡äº†ï¼Œé€æ¸å¼€å§‹å˜æ€èµ·æ¥~</p></blockquote><h2 id="åˆ†æç½‘ç»œè¯·æ±‚">åˆ†æç½‘ç»œè¯·æ±‚</h2><h3 id="ç¬¬ä¸€æ­¥">ç¬¬ä¸€æ­¥</h3><ol><li>æ‰“å¼€F12</li><li>åˆ·æ–°network</li><li>é»˜è®¤è§‚å¯Ÿçš„æ˜¯è¯·æ±‚çš„å…ˆåé¡ºåº</li></ol><blockquote><p>æˆ‘é€‰æ‹©å¤§å°ä¹‹åï¼Œéšç€è§†é¢‘çš„æ’­æ”¾ï¼Œé€æ¸äº§ç”Ÿæ–°çš„æ–‡ä»¶<br>å› ä¸ºæ˜¯å¤§å°å€’åºï¼Œ0.ts,1.tsé€æ¸å‡ºç°<br>é‚£è¯´æ˜äº†è¿™ä¸ªè§†é¢‘çš„æ’­æ”¾å°±æ˜¯ä¸€ä¸ªä¸ªè¿™æ ·çš„tsç»„æˆçš„</p></blockquote><img src="/img/mics/d41104a297d24a6c8a135cc323e91fab.webp" alt="" style="zoom:80%;" /><h3 id="ç¬¬äºŒæ­¥">ç¬¬äºŒæ­¥</h3><blockquote><p>æˆ‘æ¥ç€å»è¯·æ•™æŸä½å°é€æ˜ï¼Œåœ¨ä»–çš„å¸¦é¢†ä¸‹æˆ‘æ˜ç™½äº†ï¼Œå¯ä»¥æ‰¾åˆ°ä¸€ä¸ªm3u8çš„æ–‡ä»¶<br>è¿™ä¸ªæ–‡ä»¶çš„å«ä¹‰ç›¸å½“äºæ•´ä¸ªè§†é¢‘çš„æ€»æŒ‡æŒ¥<br>ä»–é‡Œé¢é›†åˆäº†æ‰€æœ‰çš„tsï¼Œä»¥åŠå¦‚ä½•åŠ å¯†ï¼Œå¯†é’¥æ¥è‡ªå“ªé‡Œ<br>é‚£ä¹ˆå¦‚ä½•æ‰¾å‘¢ï¼Ÿ</p></blockquote><img src="/img/mics/11ffc258ec544beda68928ede0de4c2d.webp" alt="" style="zoom:80%;" /><h3 id="ç¬¬ä¸‰æ­¥">ç¬¬ä¸‰æ­¥</h3><blockquote><p>å› ä¸ºä»–è¿™ä¸ªæ¶‰åŠç™»å½•çš„ï¼Œæ‰€ä»¥è‚¯å®šä¼šæºå¸¦tokenç­‰è®¤è¯ä¿¡æ¯ï¼Œæ³¨æ„ç•™æ„è¿™ä¸ª<br>å…¶æ¬¡åŠ è½½ä¸€ä¸ªç½‘é¡µï¼Œé¦–å…ˆä¼šåŠ è½½cssï¼Œjsï¼Œå›¾ç‰‡ç­‰å…ˆå°†æ•´ä¸ªç½‘ç«™çš„æ ·å­åŠ è½½å‡ºæ¥<br>éšåå°±æ˜¯jsçš„æ¸²æŸ“è§£ç çš„é—®é¢˜ï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šå‘å‡ºè¯·æ±‚m3u8<br>æ‰€ä»¥æ ¹æ®waterfallæ¥æ’åºï¼Œæ‹‰åˆ°ä¸­é—´ï¼Œå°±èƒ½å‘ç°ä¸Šå›¾ã€‚</p></blockquote><img src="/img/mics/55c844a3923747aea50844d2532ebb4f.webp" alt="" style="zoom:80%;" /><blockquote><p>è¿›è€Œä»–åœ¨é‡Œé¢è¯´æ˜äº†æ˜¯AES-128åŠ å¯†<br>ç„¶åå¯†é’¥å¯¹åº”çš„åœ°å€æ˜¯URIä¸­çš„<br>å½“ç„¶ä½ ç›´æ¥è®¿é—®è‚¯å®šæ˜¯ä¸è¡Œçš„ï¼Œè‡ªå·±é€ åŒ…åˆå¤ªéº»çƒ¦<br>è€Œç½‘é¡µèƒ½æ’­æ”¾è§†é¢‘ï¼Œè¯´æ˜å¯†é’¥è‚¯å®šä¹Ÿä¸‹å‘äº†<br>ç„¶åç½‘ç«™çš„jsæ ¹æ®keyå’Œm3u8è¯·æ±‚æœåŠ¡å™¨å¹¶è§£å¯†ï¼Œå‰ç«¯å°±èƒ½è§‚çœ‹åˆ°è§†é¢‘äº†</p></blockquote><img src="/img/mics/34f9e6e453a04b6093000d939d60deca.webp" alt="" style="zoom:80%;" /><blockquote><p>è¿™é‡Œæœ‰ä¸ªéœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼Œæˆ‘ä¸‹é¢å•ç‹¬è¯´ä¸€ä¸‹</p></blockquote><h3 id="æ¥ä¸ªå°æ€»ç»“">æ¥ä¸ªå°æ€»ç»“</h3><blockquote><p>ç½‘ç«™æ˜¯æ€ä¹ˆæ’­æ”¾è§†é¢‘çš„å‘¢ï¼š</p><ol><li>ä»–æ˜¯æ‹†åˆ†æˆ30ç§’ä¸€ä¸ªçš„tsæ–‡ä»¶</li><li>ç½‘ç«™çš„jsä¼šå»è¯»å–è¯·æ±‚æ¥çš„m3u8æ–‡ä»¶</li><li>è¿›è€Œjsä¼šæ ¹æ®keyè§£å¯†</li><li>ç›´æ¥è¯·æ±‚m3u8å’Œkeyæ˜¯ä¼šè¢«æœåŠ¡å™¨æ‹’ç»çš„</li></ol><p>ç»¼ä¸Šï¼š<br>æˆ‘ä»¬è¦å°†m3u8å’Œkeyæ‹‰å–åˆ°æœ¬åœ°<br>ç”¨æœ¬åœ°çš„æœåŠ¡å™¨ç»™æˆ‘ä»¬çš„å·¥å…·ç»™å¯ä»¥ç›´æ¥è®¿é—®åˆ°çš„é“¾æ¥<br>ç„¶åæˆ‘ä»¬å°±èƒ½å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„è§†é¢‘äº†</p></blockquote><h2 id="å¦‚ä½•å¤„ç†åŠ å¯†key">å¦‚ä½•å¤„ç†åŠ å¯†key</h2><ul><li>ä½¿ç”¨ç«ç‹æµè§ˆå™¨</li></ul><blockquote><p>è¿™ç‚¹å€¼å¾—è°·æ­Œæµè§ˆå™¨å­¦ä¹ å“ˆï¼Œè‡ªåŠ¨è½¬ç </p></blockquote><ul><li>ä½¿ç”¨hackbar</li></ul><blockquote><p>æœ‰çš„ç«ç‹æµè§ˆå™¨æ˜¯ä¸ä¼šè‡ªåŠ¨è½¬ç çš„ï¼Œå¦‚æœåªå­˜åœ¨ä¸€è¡Œï¼Œå¯ä»¥ç›´æ¥å¤åˆ¶<br>åˆ°hackbaré‡Œé¢çš„base64_encodeæ‹¿åˆ°</p></blockquote><ul><li>å¦‚æœå­˜åœ¨æ¢è¡Œæ€ä¹ˆåŠï¼Ÿ</li></ul><img src="/img/mics/f5e7026473bb4b2aaf10ab9bc83c8020.webp" alt="" style="zoom:80%;" /><blockquote><ol><li>burpsuitæŠ“åŒ… æ‰¾åˆ°è¿™ä¸ªåŒ…çš„responseåˆ°è§£ç å™¨é‡Œé¢è§£</li><li>å³é”®æ”¹åŒ…çš„curlå‘½ä»¤ï¼Œåˆ°æ§åˆ¶å°é‡Œé¢å‘åŒ…å¤„ç†è¿”å›å›æ¥çš„äºŒè¿›åˆ¶ï¼ˆæ²¡è¯•è¿‡~ï¼‰</li></ol></blockquote><img src="/img/mics/6c4d1be297874684867ca654f08823ad.webp" alt="" style="zoom:80%;" /><ul><li>æœ€åç”Ÿæˆkeyæ–‡ä»¶</li></ul><blockquote><p>ä½ ç›´æ¥å¤åˆ¶æ˜¯æ²¡æœ‰ç”¨çš„ï¼ŒäºŒè¿›åˆ¶å½“æˆå­—ç¬¦ä¸²ç”¨~<br>å¦‚ä¸‹ä½ ä¼šå¾—åˆ°å¯¹åº”çš„key</p></blockquote><img src="/img/mics/5cf1ec0d14f34c0db6fe738031d41a12.webp" alt="" style="zoom:80%;" /><p><code>file_put_contents('./key', base64_decode('DQoNCtL+6IOzUNCrR/OBXiRkDek='));</code></p><h2 id="å¼€å§‹è½¬è§†é¢‘">å¼€å§‹è½¬è§†é¢‘</h2><h3 id="m3u8dlå·¥å…·">m3u8dlå·¥å…·</h3><blockquote><p>å¼€æºåœ°å€ï¼š<a href="https://github.com/nilaoda/N_m3u8DL-CLI">https://github.com/nilaoda/N_m3u8DL-CLI</a><br>ä½†æ˜¯è¿™ä¸ªåœ¨è¿™é‡Œä¸æ˜¯ç‰¹åˆ«å¥½ä½¿</p></blockquote><h3 id="youtu-dl-å·¥å…·">youtu-dl å·¥å…·</h3><blockquote><p>å¼€æºåœ°å€ ï¼š <a href="https://github.com/ytdl-org/youtube-dl">https://github.com/ytdl-org/youtube-dl</a><br>æœ€åç›´æ¥æå®šï¼</p></blockquote><h3 id="ffmpeg-æ ¹æœ¬">ffmpeg æ ¹æœ¬</h3><blockquote><p>ä¸‹è½½åœ°å€ï¼š<a href="https://www.gyan.dev/ffmpeg/builds/">https://www.gyan.dev/ffmpeg/builds/</a></p></blockquote><blockquote><p>ä¸Šé¢çš„å»ºè®®éƒ½è¦åŠ å…¥ç¯å¢ƒå˜é‡<br>è€Œæˆ‘å°±æ¯”è¾ƒæ‡’<br>ç›´æ¥ä¸¢åˆ°<code>site-pakage</code>é‡Œé¢äº†äº‹<br>æ³¨æ„ï¼šffmpegæœ‰å¾ˆå¤šé˜‰å‰²ç‰ˆï¼Œå»ºè®®ç”¨ä¸Šé¢çš„ä¸‹è½½åœ°å€ä¸‹è½½å®Œæˆç‰ˆ</p></blockquote><img src="/img/mics/dcb925840718489c8986a0d91e7e6925.webp" alt="" style="zoom:80%;" /><h3 id="åœ°å€">åœ°å€</h3><blockquote><p>è¿˜è®°å¾—å‰é¢æˆ‘ä»¬è¯´è¿‡çš„ï¼Œç½‘ç«™ä¸Šçš„åœ°å€æ˜¯è¦tokenè®¤è¯çš„<br>è€Œè½¯ä»¶çš„ä½¿ç”¨æ˜¯ç›´æ¥ç»™ä¸ªé“¾æ¥<br>åŠ ä¸Šæœ‰å‡ ç‚¹æˆ‘ä»¬å¯ä»¥åˆ©ç”¨</p><ol><li>m3u8æ–‡ä»¶æ˜¯æ²¡æœ‰åŠ å¯†çš„</li><li>tsæ–‡ä»¶æ˜¯ç›´æ¥å¯ä»¥æ‹¿ä¸‹æ¥çš„</li></ol><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†m3u8æ‹¿åˆ°æœ¬åœ°ï¼Œç»™æœ¬åœ°è¿æ¥</p></blockquote><p><strong>è¿™é‡Œç›´æ¥æä¾›å‡ ç§æ–¹å¼ï¼š</strong></p><ol><li>XAMPPï¼ŒPHPstudyç­‰æœ¬åœ°å¼€ä¸ªæœåŠ¡å™¨ï¼Œä¸¢åˆ°é‡Œé¢</li></ol><img src="/img/mics/de79ea9ef4de450cb9b45cac035c0abc.webp" alt="" style="zoom:80%;" /><img src="/img/mics/4ddbaa87db2342d59a9a8c50539f2f58.webp" alt="" style="zoom:80%;" /><ol start="2"><li>python -m http.server</li></ol><blockquote><p>ç”¨pythonæ­å»ºä¸€ä¸ªä¸´æ—¶è™šæ‹Ÿçš„æœåŠ¡å™¨<br>ç»™è¿æ¥å‚è€ƒä¸‹ï¼š<br><code>https://www.cnblogs.com/shenshangzz/p/8318143.html</code><br><code>https://juejin.cn/s/python%20http%20server%E6%95%99%E7%A8%8B</code><br><code>https://www.pythonf.cn/read/4681</code></p></blockquote><ol start="3"><li>ç™½å«–å›¾åºŠ</li></ol><blockquote><p>å’³å’³å’³,å°é€æ˜å¤§ä½¬çš„ç™¾å®ç®±ä¸­çš„ä¸œè¥¿<br><code>https://github.com/TransparentLC/free-img</code><br>è¿™æ˜¯ä¸ªå¥½ç©æ„ï¼Œå¤§å‚ä»¬ä¹Ÿä¸å·®è¿™ç‚¹</p></blockquote><h2 id="æœ€åä¸€æ­¥">æœ€åä¸€æ­¥</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å½“å‰æ–‡ä»¶å¤¹ä¸‹æ‰“å¼€cmd</span></span><br><span class="line"></span><br><span class="line">$ youtu-dl http://127.0.0.1:8112/index.m3u8</span><br></pre></td></tr></table></figure><img src="/img/mics/40df08a49ae7427abde6eadedf6d78ff.webp" alt="" style="zoom:80%;" /><img src="/img/mics/7c3312832673453fbcd18c53c8d286a8.webp" alt="" style="zoom:80%;" />æå®šï¼]]></content>
      
      
      <categories>
          
          <category> åˆ†äº« </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>æ ‘è“æ´¾è¶…å…¨ä»‹ç»åˆé›†ï¼š2021 ä»0åˆ°1ï¼</title>
      <link href="/article/b2e16fb3.html"/>
      <url>/article/b2e16fb3.html</url>
      
        <content type="html"><![CDATA[<h2 id="å‰è¨€ï¼š-9">å‰è¨€ï¼š</h2><p>æœ¬äººå¤§å­¦ç”Ÿï¼Œå¼„æ ‘è“æ´¾æ˜¯å› ä¸ºæƒ³æ¶è®¾<strong>ç§äººæœåŠ¡å™¨</strong>ã€‚<br>æŒæ¡äº†ä¸€å®šçš„<strong>LinuxåŸºç¡€</strong>ï¼Œç°åœ¨æˆ‘åˆ†äº«ä¸€ä¸‹è‡ªå·±çš„ä»0åˆ°1çš„è·¯ç¨‹ï¼Œå¤§å®¶å¯ä»¥æ ¹æ®ç›®å½•æœ‰é€‰æ‹©æ€§çš„å‚è€ƒï¼Œ<br>è‹¥æœ‰ç–‘é—® è¯·é€šè¿‡é‚®ä»¶/ä¸‹æ–¹ç•™è¨€è”ç³»æˆ‘</p><h2 id="æ­¥éª¤ï¼š">æ­¥éª¤ï¼š</h2><h3 id="æ·˜å®è´­ä¹°é…ä»¶">æ·˜å®è´­ä¹°é…ä»¶</h3><table><thead><tr><th>å‚è€ƒ</th><th>ä»·æ ¼</th></tr></thead><tbody><tr><td>4B-4GB</td><td>415</td></tr><tr><td>äºšå…‹åŠ›ç›’å­åŠ é£æ‰‡</td><td>17</td></tr><tr><td>64Gå†…å­˜å¡åŠ è¯»å¡å™¨</td><td>34</td></tr><tr><td>ç”µæºåŠ æ•£çƒ­</td><td>18</td></tr></tbody></table><blockquote><p>è¿™ä¸ªä»·æ ¼æˆ‘ä¹Ÿä»…èƒ½ä¾›å¤§å®¶å‚è€ƒï¼Œå¸‚åœºéšæ—¶éƒ½åœ¨å˜çš„ï¼Œç„¶åå»ºè®®ä¸è¦ä¹°ä¸€å¥—</p></blockquote><h3 id="ä¸‹è½½ç³»ç»Ÿå’Œçƒ§ç³»ç»Ÿ">ä¸‹è½½ç³»ç»Ÿå’Œçƒ§ç³»ç»Ÿ</h3><blockquote><p>å¯ä»¥åœ¨è¿™é‡Œ<a href="https://www.raspberrypi.org/software/operating-systems/">æ ‘è“æ´¾å®˜æ–¹ç½‘ç«™</a>ä¸‹è½½ç³»ç»Ÿ<br>å¤§ä½¬ä»¬å¯ä»¥é€‰æ‹©æ›´å¤šç‰ˆæœ¬çš„ï¼Œä½†å¦‚æœä¸ç©èŠ±çš„è¿™ä¸ªä¹Ÿå°±å¤Ÿäº†ã€‚</p></blockquote><hr><blockquote><p>çƒ§ç³»ç»Ÿçš„è¯ï¼Œå¤§å®¶åœ¨è¿›è¡Œæ¯ä¸€æ­¥çš„æ—¶å€™å°½é‡å°å¿ƒç‚¹ï¼Œå› ä¸ºè¿™ç©æ„ä¸å­˜åœ¨å¿«ç…§ï¼Œä¸€ä¸å°å¿ƒåˆè¦é‡æ¥</p><ul><li>å…ˆå°†SDå¡æ ¼å¼åŒ–å¹²å¹²å‡€å‡€</li><li>å‡†å¤‡å¥½çƒ§ç³»ç»Ÿçš„è½¯ä»¶å¼€å§‹çƒ§ç³»ç»Ÿ</li><li>çƒ§å¥½çš„ç³»ç»Ÿä¼šè¢«åˆ†æˆ2ä¸ªåŒºåŸŸï¼Œæ‰€ä»¥ä¸è¦è§‰å¾—å‡ºé”™äº†</li><li>å› æœ€æ–°ç‰ˆçš„æ ‘è“æ´¾æ²¡æœ‰å¼€sshï¼Œæ‰€ä»¥ï¼Œæ‰“å¼€çƒ§å½•å®Œç³»ç»Ÿçš„sdå¡ï¼Œæ–°å»ºä¸€ä¸ªåä¸ºsshï¼Œ<strong>æ— åç¼€çš„æ–‡ä»¶</strong>ã€‚</li></ul></blockquote><blockquote><p>æ¨èçš„çƒ§å½•è½¯ä»¶ï¼šWin32Disklmager</p></blockquote><img src="/img/mics/1c52697ee374467bbae9e62ef6a3aa0e.webp" alt="" style="zoom:80%;" /><hr><h3 id="å¼€å§‹è¿æ¥">å¼€å§‹è¿æ¥</h3><ul><li>æœ€ç®€å•çš„ä¸€ç§å°±æ˜¯æ’å…¥è·¯ç”±å™¨</li><li>ä¹Ÿå¯ä»¥ç¬”è®°æœ¬æ¥æ— çº¿ç½‘ï¼Œæ ‘è“æ´¾æ¥ç¬”è®°æœ¬ï¼Œä½†æ˜¯è¦åœ¨ç½‘ç»œç®¡ç†ä¸­å¿ƒæ”¹ä¸€ä¸‹ï¼ˆæ‰‹æœºçƒ­ç‚¹ï¼‰</li><li>ä¹Ÿå¯ä»¥å°å¼æ¥ç½‘çº¿ï¼Œæ ‘è“æ´¾æ¥å°å¼ï¼ˆé”æ·ä»€ä¹ˆçš„ä¼šåˆ¤æ–­ä½ å¤–æ¥åˆ¤æ–­ä¸ºå¤–æŒ‚ï¼‰</li><li>æ‰€ä»¥ä¸è¦æ€¥ï¼Œæ–¹æ³•æ€»æ¯”å›°éš¾å¤š</li></ul><blockquote><ul><li>åæ­£æœ€åå°±æ˜¯ä½ çš„ç”µè„‘å’Œä½ çš„æ ‘è“æ´¾æ„æˆäº†ç½‘ç»œç¾¤ï¼Œå†…ç½‘å»æ‰¾æ ‘è“æ´¾çš„IPåœ°å€</li><li>æ‰¾IPåœ°å€å¯ä»¥ç”¨ç«¯å£æ‰«æè½¯ä»¶æ‰«æï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨cmd</li><li>ä½¿ç”¨cmd   å…ˆæ˜¯æŸ¥çœ‹è‡ªå·±çš„å†…ç½‘ip ç„¶ååŒä¸€ç½‘æ®µä¸‹å»æ‰¾æ ‘è“æ´¾çš„ipåœ°å€</li><li>cmd 2ä¸ªå‘½ä»¤ ipconfig ä¸ arp -a</li></ul></blockquote><ul><li>å»PuTTY<a href="https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html">å®˜ç½‘ä¸‹è½½</a>å¥½äº†ï¼Œå¼€å§‹sshè¿æ¥</li></ul><hr><h3 id="å¼€å§‹ç™»å½•">å¼€å§‹ç™»å½•</h3><p><strong>é»˜è®¤è´¦å·</strong>ä¸º<strong>pi</strong>ï¼Œ<strong>å¯†ç </strong>ä¸º<strong>raspberry</strong>,åœ¨åé¢ä¼šæœ‰æœºä¼šæ”¹å¯†ç çš„ï¼Œå…ˆç”¨ç€ã€‚</p><ul><li>å®‰è£…vncserver</li></ul> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install tightvncserver</span><br></pre></td></tr></table></figure><ul><li>å®‰è£…xrdp</li></ul> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install xrdp</span><br></pre></td></tr></table></figure><ul><li>å®‰è£…xrdp</li></ul> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install vnc4server tightvncserver</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼š</strong> ç½‘é€Ÿä¼šæ…¢ä¸€ç‚¹ï¼Œç¨åä¼šè¿›è¡Œæ¢æº</p><ul><li>ä¸ºäº†ä»¥åèƒ½è¿›è¡ŒVNC</li><li>sudo raspi-config -&gt; InterFace Option -&gt;VNC -&gt; enable</li><li>ç™»å½•è¿œç¨‹æ¡Œé¢ï¼ˆ<strong>win+R</strong>ï¼‰ è¾“å…¥ä½ çš„pi ç„¶åè´¦å·å¯†ç éƒ½æ˜¯é»˜è®¤çš„</li><li>è¿›å…¥åæ ¹æ®æ“ä½œï¼Œä¼šé…ç½®å¥½åŸºç¡€è®¾ç½®ï¼ŒåŒ…æ‹¬å¯†ç </li><li>ä»¥ä¸‹æ“ä½œå»ºè®®åœ¨å›¾å½¢ç•Œé¢çš„ç»ˆç«¯æ“ä½œï¼ˆæ•ˆæœå·®ä¸å¤šï¼‰<br><img src="/img/mics/2708b483093a4435824de2e7d2c4575b.webp" alt="" style="zoom:80%;" /></li></ul><h3 id="è®¾ç½®ä¸­æ–‡å­—ä½“">è®¾ç½®ä¸­æ–‡å­—ä½“</h3><ul><li>å®‰è£…å­—åº“</li></ul> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install ttf-wqy-zenhei</span><br></pre></td></tr></table></figure><ul><li>å®‰è£…æ‹¼éŸ³è¾“å…¥æ³•</li></ul> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install fcitx fcitx-googlepinyin fcitx-module-cloudpinyin fcitx-sunpinyin</span><br></pre></td></tr></table></figure><ul><li>é…ç½®ä¸­æ–‡ç¯å¢ƒ</li></ul> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo raspi-config</span><br></pre></td></tr></table></figure> <img src="/img/mics/0adae36ba405473fba509cdeefb9452f.webp" alt="" style="zoom:80%;" /><blockquote><p>å†é€‰æ‹©local ç„¶åæ‰¾åˆ°zh_CN.UTF-8,ç›´æ¥æŒ‰ç©ºæ ¼é€‰å–ï¼Œç„¶åæŒ‰tabé”®ç¡®è®¤ã€‚<br>æ€ä¹ˆè¿›æ¥çš„å°±è¦å®Œå®Œæ•´æ•´åœ°æ¨å‡º<br>æœ€åé‡å¯</p></blockquote> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo reboot</span><br></pre></td></tr></table></figure><h3 id="è®¾ç½®rootç”¨æˆ·å’Œé…ç½®æ—¶é—´">è®¾ç½®rootç”¨æˆ·å’Œé…ç½®æ—¶é—´</h3><ul><li>ç»™rootè®¾ç½®å¯†ç </li></ul> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo passwd root </span><br></pre></td></tr></table></figure><ul><li>è¿›å…¥root</li></ul> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">su - </span><br></pre></td></tr></table></figure><ul><li>åˆ‡æ¢å›æ™®é€špi</li></ul> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">su - pi</span><br></pre></td></tr></table></figure><ul><li><strong>æ³¨æ„</strong>:è¾“å…¥å¯†ç çš„æ—¶å€™ä¸ä¼šæ˜¾ç¤ºçš„ï¼Œæ‰€ä»¥è·Ÿç€æ„Ÿè§‰è¾“å…¥å›è½¦å°±å¥½äº†ã€‚</li><li>è¾“é”™äº†ä¹Ÿä¸è¦ä¹±æŒ‰ï¼å¡æ­»äº†è¿™ä¸æ˜¯äº‘æœåŠ¡å™¨ï¼Œä¸å¥½æã€‚</li><li>åˆ°æ­¤å·²ç»è¿›å…¥rootç”¨æˆ·ä¸‹äº†ï¼Œæˆ‘ä»¬å¿…é¡»é…ç½®æ—¶é—´ï¼Œä¸ºæ¢æºåšå‡†å¤‡ã€‚</li><li>è®¾ç½®æ—¶é—´</li></ul> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">date -s &#x27;2021-7-30 xx:xx:xx&#x27;</span><br></pre></td></tr></table></figure><ul><li>å°†æ—¶é—´å†™å…¥biosé¿å…é‡å¯å¤±æ•ˆã€‚</li></ul> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hwclock -w</span><br></pre></td></tr></table></figure><h3 id="æ¢æº">æ¢æº</h3><blockquote><p><strong>æ—¶é—´ä¸å¯¹æ˜¯ä¸æˆåŠŸçš„</strong></p></blockquote><ul><li>å¤‡ä»½è½¯ä»¶æº</li></ul> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo cp /etc/apt/sources.list /etc/apt/sources.list.bak</span><br><span class="line">sudo cp /etc/apt/sources.list.d/raspi.list /etc/apt/sources.list.d/raspi.list.bak</span><br></pre></td></tr></table></figure><ul><li>ä¿®æ”¹è½¯ä»¶æ›´æ–°æº é…ç½®æ–‡ä»¶</li></ul> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nano  /etc/apt/sources.list</span><br></pre></td></tr></table></figure><ul><li>ç”¨#æ³¨é‡ŠåŸæ–‡å†…å®¹ï¼ŒåŠ å…¥</li></ul> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">deb http://mirrors.ustc.edu.cn/raspbian/raspbian/ stretch main contrib non-free rpi</span><br><span class="line">deb-src http://mirrors.tuna.tsinghua.edu.cn/raspbian/raspbian/ stretch main contrib non-free rpi</span><br></pre></td></tr></table></figure><ul><li>ä¿®æ”¹ç³»ç»Ÿæ›´æ–°æº é…ç½®æ–‡ä»¶</li></ul> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nano /etc/apt/sources.list.d/raspi.list</span><br></pre></td></tr></table></figure><ul><li>ç”¨#æ³¨é‡ŠåŸæ–‡å†…å®¹ï¼ŒåŠ å…¥</li></ul> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">deb http://mirrors.tuna.tsinghua.edu.cn/raspberrypi/ stretch main ui</span><br><span class="line">deb-src http://mirrors.tuna.tsinghua.edu.cn/raspberrypi/ stretch main ui</span><br></pre></td></tr></table></figure><ul><li>æ ‘è“æ´¾æ›´æ–°ä¿¡æ¯æ•°æ®</li></ul> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br></pre></td></tr></table></figure><h3 id="æ‰“é€šé˜²ç«å¢™ï¼ˆå»ºç«™ï¼‰">æ‰“é€šé˜²ç«å¢™ï¼ˆå»ºç«™ï¼‰</h3><ul><li>å®‰è£…ç®¡ç†</li></ul> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install ufw</span><br></pre></td></tr></table></figure><ul><li>å¯ç”¨</li></ul> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ufw enable</span><br></pre></td></tr></table></figure><ul><li>æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€</li></ul> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ufw status</span><br></pre></td></tr></table></figure><ul><li>å…è®¸å¤–éƒ¨è®¿é—®80ç«¯å£</li></ul> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ufw allow 80</span><br></pre></td></tr></table></figure><blockquote><p>80ï¼šé»˜è®¤ç«¯å£ 3306ï¼šæ•°æ®åº“ç«¯å£ 8888ï¼šå®å¡”é¢æ¿ç«¯å£<br>å…¶å®æœ‰äº†å®å¡”é¢æ¿ä¹‹åå¯ä»¥åœ¨é‚£ä¸Šé¢æ‰“å¼€ï¼Œè¿™é‡Œæ‰“å¼€æ˜¯ä¸ºäº†èƒ½å¤Ÿå®‰è£…å®å¡”é¢æ¿</p></blockquote><h3 id="å®‰è£…å®å¡”">å®‰è£…å®å¡”</h3><ul><li>å®‰è£…å‘½ä»¤</li></ul> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget -O install.sh http://download.bt.cn/install/install-ubuntu_6.0.sh &amp;&amp; bash install.sh</span><br></pre></td></tr></table></figure><ul><li><strong>æ³¨æ„ï¼šæˆ‘å·²ç»å¿˜äº†å…·ä½“çš„å‘½ä»¤äº†ï¼ˆåº”è¯¥æ˜¯ubuntuç‰ˆçš„ï¼‰</strong></li><li><strong>å®åœ¨æŠŠæ¡ä¸ä½å°±ç™¾åº¦æœç´¢å®å¡”é¢æ¿åˆ°å®˜ç½‘çœ‹çœ‹</strong></li></ul><blockquote><ul><li>å®‰è£…å¥½äº†ä¼šå¼¹å‡ºå†…å¤–ç½‘å…¥å£</li><li>è¿™é‡Œé€‰æ‹©å†…ç½‘å…¥å£ï¼Œåœ¨å›¾å½¢ç•Œé¢é€‰æ‹©é»˜è®¤æµè§ˆå™¨æ‰“å¼€</li><li>è¾“å…¥è´¦å·å’Œå¯†ç å°±è¡Œäº†</li><li>é€‰æ‹©ä½ å¯¹åº”çš„ç‰ˆæœ¬ï¼ˆè¿™å°†ä¼šæ¶ˆè€—å¾ˆé•¿æ®µæ—¶é—´ï¼‰</li><li>ä¹‹åå°±è·Ÿé˜¿é‡Œäº‘ï¼Œè…¾è®¯äº‘ä¸€æ¨¡ä¸€æ ·äº†ã€‚</li></ul></blockquote><h3 id="å†…ç½‘ç©¿é€">å†…ç½‘ç©¿é€</h3><p>ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/fatedier/frp/releases">https://github.com/fatedier/frp/releases</a><br>ä¸‹è½½ç‰ˆæœ¬ï¼š<br><img src="/img/mics/58d95b3515b64797846e9ba00b1c0dc6.webp" alt="" style="zoom:80%;" /></p><p>è¿™é‡Œæœ‰å‡ ä¸ªæ³¨æ„ç‚¹ï¼š</p><ul><li>å†…ç½‘æƒ³åœ¨å¤–ç½‘è®¿é—®ï¼šé‚£ä¹ˆä½ çš„æ ‘è“æ´¾å°±æ˜¯å®¢æˆ·ç«¯</li><li>åº”è¯¥é…ç½®frpæ–‡ä»¶ï¼ˆå…·ä½“è¯¦ç»†é…ç½®éº»çƒ¦å¤§å®¶è‡ªè¡Œç™¾åº¦ä¸‹ï¼‰</li></ul><img src="/img/mics/47b051e8b7a04e98b6f09d931a185dd8.webp" alt="" style="zoom:80%;" /><p>ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿå°±æ˜¯ä»¥åä½ çš„sshç™»å½•å°±å¯ä»¥ç”¨ ä½ çš„ipåœ°å€çš„7999ç«¯å£æ¥è¿›è¡Œç™»å½•äº†</p><blockquote><p>æœåŠ¡ç«¯ï¼š<br><img src="/img/mics/5bbfb4f9078249e9bfbb4b296fad3188.webp" alt="" style="zoom:80%;" /></p></blockquote><p>è¿™é‡Œ<strong>ä»…ä¾›å‚è€ƒ</strong>ï¼Œæƒ³æ€ä¹ˆç©¿é€ï¼Œå¾—èŠ±ç‚¹æ—¶é—´å­¦ä¹ ä¸‹ï¼ˆå­¦ä¹ æˆæœ¬å¾ˆå°ï¼‰</p><ul><li>åˆ‡æ¢åˆ°rootä¸‹</li><li>åˆ›å»ºå­çª—å£ï¼Œæ­¤æ—¶è¿›å…¥äº†å½“å‰è·¯å¾„ä¸‹çš„å­çª—å£</li></ul> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">screen -S frp</span><br><span class="line"> ll</span><br></pre></td></tr></table></figure><ul><li>å¯åŠ¨</li></ul> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./frpc -c ./frpc.ini</span><br></pre></td></tr></table></figure><ul><li>ä¸€èµ·æŒ‰ctrl + a + d å›åˆ°ä¸»ç•Œé¢</li><li>å…ˆå¼€å¯å…¬ç½‘çš„ï¼Œå†å¼€å¯å†…ç½‘çš„</li><li>åªè¦ä¸é‡å¯ï¼Œè¿™ä¸ªåå°ç¨‹åºå°±ä¼šä¸€ç›´è·‘ä¸‹å»</li></ul><blockquote><p>å¦‚æœè®¿é—®ä¸æˆåŠŸï¼ŒæŸ¥çœ‹å¯¹åº”çš„ç«¯å£æ˜¯å¦å¼€å¯ï¼Œåœ¨å­çª—å£ä¹Ÿä¼šæŠ¥é”™åŸå› çš„<br>å†…ç½‘çš„æ ‘è“æ´¾åœ¨å®å¡”é¢åŒ…æ“ä½œå°±å¥½äº†<br>å¤–ç½‘çš„é˜¿é‡Œäº‘åœ¨å®å¡”é¢æ¿å¼€å¯æˆ‘è®°å¾—æ˜¯ä¸è¡Œçš„ï¼Œå¾—åˆ°å®˜æ–¹æ§åˆ¶å°ä¸‹çš„å®‰å…¨ç»„æ‰“å¼€æ‰è¡Œ</p></blockquote><h3 id="å®‰è£…ä¸ªäººäº‘ç›˜">å®‰è£…ä¸ªäººäº‘ç›˜</h3><img src="/img/mics/3b6b20e887f94a66b18976d3723a285b.webp" alt="" style="zoom:80%;" /><blockquote><p>å®å¡”é¢æ¿-ã€‹è½¯ä»¶å•†åº—-ã€‹ä¸€é”®éƒ¨ç½²-ã€‹å¯é“äº‘<br>æ³¨æ„ä¸‹ç«¯å£å·ï¼Œç„¶åå†…ç½‘ç©¿é€å³å¯<br>è®¿é—®åœ°å€ ä½ çš„å¤–ç½‘IP:ç©¿é€æ¥å£ æ¯”å¦‚ <a href="http://xx.xx.xxx.xxx">xx.xx.xxx.xxx</a>:yyyy</p></blockquote><h3 id="ç•ªå¤–ç¯‡ï¼šVNCé—®é¢˜ï¼š">ç•ªå¤–ç¯‡ï¼šVNCé—®é¢˜ï¼š</h3><p>å¦‚æœæ˜¯é»‘å±ï¼š</p><blockquote><p>ç½‘ä¸Šæ™®éçš„åšæ³•æ˜¯ï¼š<br>åœ¨è®¾ç½®é‡Œé¢è°ƒæ•´ä»€ä¹ˆåˆ†è¾¨ç‡ä»€ä¹ˆçš„ï¼ˆæˆ‘æœ‰ç‚¹å¿˜äº†ï¼‰<br>å…³é”®è¿™ä¸ªé€‰é¡¹è¿˜æœ‰ç‚¹éš¾æ‰¾ï¼Œå› ä¸º4Bçš„é€‰é¡¹è·ŸåŸæ¥çš„ä¸ä¸€æ ·<br>ç„¶åå°å¿ƒç‚¹æ‰¾æ˜¯æœ‰çš„ï¼Œå‡ºç°äº†è¿œç¨‹æ˜¾ç¤ºåé—®é¢˜åˆæ¥äº†<br>åˆ†è¾¨ç‡ä¸å¯¹ï¼šå°±æ˜¯æ•´ä¸ªå±å¹•æ”¾å¤§äº†ï¼Œå¾ˆéš¾å—</p></blockquote><hr><ul><li>æœ€åæ‰¾åˆ°çš„åšæ³•æ˜¯(èµ„æ–™)ï¼š</li></ul><blockquote><p>vncserver -geometry 1920x1080 -randr 1920x1080<br>xrandr -s 1920x1080<br>å¦‚æœé¼ æ ‡å˜æˆä¸€ä¸ªå‰å·äº†ï¼Œå†è¾“å…¥å¦‚ä¸‹å‘½ä»¤:<br>lxappearance<br>ä»¥åé‡å¯è¿˜ä¼šæ¢å¤çš„ï¼Œä½†æ˜¯æ ‘è“æ´¾æ€•æ˜¯1å¹´éƒ½ä¸ä¼šåœå§</p></blockquote><ul><li><p>vncserver :7 -geometry 1920x1080 è¿™æ¡å‘½ä»¤çš„æ„æ€æ˜¯åœ¨é»˜è®¤ç«¯å£ä¸Šï¼‹6</p></li><li><p>æˆ‘çš„åšæ³•ï¼š<br><img src="/img/mics/ca3289f9e89c41628c77c586bb4b34ce.webp" alt="" style="zoom:80%;" /></p></li></ul><blockquote><p>vncserver :2 -geometry 1920x1080<br>å‰ææ˜¯ä¿è¯5091 + 1 å³5092ç«¯å£å¼€çš„<br>å‡ºç°é¼ æ ‡ä¸ºå‰å‰ lxappearance<br>æå®š</p></blockquote><h3 id="ç•ªå¤–ç¯‡ï¼šå½“é‡å¯ä¹‹åéœ€è¦å¹²ä»€ä¹ˆï¼š">ç•ªå¤–ç¯‡ï¼šå½“é‡å¯ä¹‹åéœ€è¦å¹²ä»€ä¹ˆï¼š</h3><ul><li>æœ‰å¿…è¦çš„è¯ï¼Œè°ƒæ•´ä¸‹ç³»ç»Ÿæ—¶é—´</li></ul><blockquote><p>date æŸ¥çœ‹æ—¶é—´æ˜¯å¦æ­£ç¡®</p></blockquote><ul><li>VNCè®¾ç½®</li></ul><blockquote><p>vncserver :1 -geometry 1920x1080 è®¾ç½®</p></blockquote><ul><li>å†…ç½‘ç©¿é€é‡æ–°è®¾ç½®</li></ul><h2 id="æ€»ç»“-3">æ€»ç»“</h2><p>è¿™ä¸ªåº”è¯¥ç®—æ˜¯å…¨çš„å§ QAQ<br>è‡³äºä¸ºä»€ä¹ˆå†™ï¼Œå› ä¸ºå½“åˆæˆ‘æ‰¾è¿™äº›èµ„æ–™éƒ½ç”¨äº†å¾ˆå¤šæ—¶é—´ï¼Œå¸Œæœ›èƒ½å¸®åŠ©åˆ°å„ä½<br>æˆ‘çš„æ ‘è“ç›®çš„å·²ç»è¾¾åˆ°äº†ï¼Œæœºå™¨å­¦ä¹ çš„å¤§ä½¬ï¼Œè¿˜è¦ç»§ç»­æŠ˜è…¾æ‰è¡Œ<br>å¦‚æœæœ‰ä»€ä¹ˆé”™è¯¯ï¼Œè¯·åœ¨è¯„è®ºåŒºæŒ‡å‡º<br>è‹¥æœæœ‰å¸®åŠ©ï¼Œç‚¹ä¸ªèµå§ï¼Œå˜»å˜»</p><h2 id="å‚è€ƒé“¾æ¥">å‚è€ƒé“¾æ¥</h2><p><a href="https://blog.csdn.net/iefenghao/article/details/88836303">https://blog.csdn.net/iefenghao/article/details/88836303</a><br><a href="https://blog.csdn.net/oneil2016/article/details/51837627">https://blog.csdn.net/oneil2016/article/details/51837627</a><br><a href="https://blog.csdn.net/xnlay/article/details/79048508">https://blog.csdn.net/xnlay/article/details/79048508</a><br><a href="https://www.cnblogs.com/suiyueshentou/p/7798340.html">https://www.cnblogs.com/suiyueshentou/p/7798340.html</a><br><a href="https://blog.csdn.net/zuoguaishouxiao/article/details/106142955">https://blog.csdn.net/zuoguaishouxiao/article/details/106142955</a><br><a href="https://blog.csdn.net/a497785609/article/details/77944327">https://blog.csdn.net/a497785609/article/details/77944327</a><br><a href="https://blog.csdn.net/weixin_44513679/article/details/116142001">https://blog.csdn.net/weixin_44513679/article/details/116142001</a><br><a href="https://blog.csdn.net/deyafoo/article/details/105243894">https://blog.csdn.net/deyafoo/article/details/105243894</a></p>]]></content>
      
      
      <categories>
          
          <category> åˆ†äº« </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ClashXæµ‹é€Ÿå¤±è´¥ä»¥åŠMacç»ˆç«¯èµ°ä»£ç†</title>
      <link href="/article/567e1422.html"/>
      <url>/article/567e1422.html</url>
      
        <content type="html"><![CDATA[<h2 id="ClashXæµ‹é€Ÿå¤±è´¥ä»¥åŠMacç»ˆç«¯èµ°ä»£ç†">ClashXæµ‹é€Ÿå¤±è´¥ä»¥åŠMacç»ˆç«¯èµ°ä»£ç†</h2><p>ç”¨æœºåœºä¹Ÿå¿«ä¸€å¹´åŠäº†ï¼ŒClashXçš„è¯åœ¨Macä¸Šå¾ˆæ˜æ˜¾åœ¨ç»ˆç«¯ä¸Šæ²¡æœ‰èµ°ä»£ç†</p><p>ç„¶åæˆ‘å†™è¿™ç¯‡åœ¨2021å¹´ä»½äº†ï¼Œä½†æ˜¯åœ¨<strong>CSDNä¸Šæ²¡æ³•å®¡æ ¸é€šè¿‡</strong>ã€‚</p><p>æ”¾åˆ°æˆ‘åšå®¢ä¸Šæ¥ç§‘å­¦ä¸Šç½‘ï¼Œ<strong>ä¸ç„¶ç™¾åº¦æ‹¿æ¥çœ‹å¹¿å‘Šçš„</strong>ï¼Ÿ</p><div class="note green icon flat"><i class="note-icon fas fa-bullhorn"></i><p>æ³¨æ„ï¼šè¿™æ˜¯æˆ‘çš„é‚€è¯·é“¾æ¥ï¼ˆæˆ‘å¯ä»¥æ”¶åˆ° <strong>10%</strong> çš„è¿”åˆ©ï¼‰</p><p>æˆ‘ä¸€ç›´åœ¨ç”¨ï¼Œæš‚æ—¶æ²¡ç¿»è¿‡è½¦ï¼Œç„¶åæ¨èåŠå¹´åŠå¹´ä¹°ï¼Œä»·æ ¼åˆç†</p><p>æˆ‘çš„é“¾æ¥ï¼š <a href="https://fastlink-aff.com/auth/register?code=HengY1Sky">https://fastlink-aff.com/auth/register?code=HengY1Sky</a></p></div><h2 id="ä¸‹è½½Clashx">ä¸‹è½½Clashx</h2><p>å®˜æ–¹ä¸‹è½½é“¾æ¥ï¼š<a href="https://github.com/yichengchen/clashX/releases">https://github.com/yichengchen/clashX/releases</a></p><img src="/img/mics/20210309210610923.webp" alt="é€‰æ‹©Clashx.dmgä¸‹è½½" style="zoom:80%;" /><h2 id="æµ‹é€Ÿå¤±è´¥">æµ‹é€Ÿå¤±è´¥</h2><p><strong>æˆ‘çš„åŸå› æ˜¯ï¼š</strong><br>ç³»ç»Ÿæ—¶é—´æ…¢å•¦ï¼Œ<strong>æ˜¯æ•´æ•´æ…¢äº†ä¸€å¤©</strong>ï¼<br>è¯´æ¥æç¬‘ï¼Œæˆ‘æµ‹é€Ÿä¸ç®¡æ€æ ·éƒ½æ˜¯å¤±è´¥ã€‚<br>æ—¶åˆ†ç§’éƒ½æ˜¾ç¤ºæ­£ç¡®ï¼ŒèŠ±äº†å‡ ä¸ªæ™šä¸Šå»ç¿»çœ‹å¸–å­ã€‚<br>Githubä¸Šçš„issueåœ¨å°ç«ç®­å’ŒClashxçœ‹åˆ°äº†å‡Œæ™¨<br>éƒ½æ²¡è§£å†³ï¼Œçªç„¶çœ‹åˆ°æ—¶é—´æ…¢äº†ä¸€å¤©ï¼Œå½“æ—¶çœŸæƒ³å“­åˆæƒ³ç¬‘</p><p><strong>è¿˜æœ‰ä¸ªåŸå› ï¼š</strong><br>ClashXå†…ç½®dnsä¸é€šå¼•èµ·çš„é—®é¢˜ï¼š<br>è¿™åŠŸèƒ½æ˜¯è®©ç½‘ç»œæ›´å¹²å‡€ï¼Œä½†ç‰¹æ®Šæ—¶æœŸdnsä¸é€šäº†å€’ç›´æ¥å¡ä½äº†ï¼Œæ­¤æ—¶è¯·å…³é—­è¯¥åŠŸèƒ½ã€‚<br><strong>æ–¹æ³•å¦‚ä¸‹ï¼š</strong><br>ç‚¹å‡»<strong>å°çŒ«å’ªã€‰é…ç½®ã€‰æ‰“å¼€æœ¬åœ°é…ç½®æ–‡ä»¶å¤¹</strong><br>ç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€ç¼–è¾‘ yamlé…ç½®æ–‡ä»¶<br>å°† dnsä¸‹çš„ <strong>enable</strong> å€¼æ”¹ä¸º <strong>false</strong><br>ä¿®æ”¹ä¿å­˜åé»˜è®¤ç³»ç»Ÿä¼šå¼¹å‡ºé‡è½½é…ç½®æç¤ºï¼Œç‚¹å‡»é‡è½½</p><h2 id="ç»ˆç«¯èµ°ä»£ç†">ç»ˆç«¯èµ°ä»£ç†</h2><p>æˆ‘æ˜¯çœ‹äº†è¿™ä½å¤§ä½¬çš„å¸–å­<a href="https://blog.csdn.net/DSZhappy/article/details/108393159?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=clashxmac%E7%BB%88%E7%AB%AF%E4%BB%A3%E7%90%86&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-0-108393159.pc_search_result_before_js">Clashxèµ°ç»ˆç«¯</a><br>ä½†ä»–åªè¯´äº†ç»“æœï¼Œå…·ä½“æ–¹æ³•å¾—è‡ªå·±æ‘¸ç´¢<br>å…¶å®ç°åœ¨å¼„å¤šäº†ä¹‹åï¼Œä¹Ÿå¾ˆå¿«æ‰¾åˆ°äº†å…·ä½“çš„è§£å†³æ–¹æ³•ã€‚</p><p><strong>1.ç¬¬ä¸€æ­¥</strong></p><p><code>vim .bash_profile</code></p><p><strong>2. ç¬¬äºŒæ­¥ï¼š</strong></p><p><code>è¾“å…¥i-&gt;è¿›å…¥insert-&gt; å¤åˆ¶ä¸‹é¢å†…å®¹ -&gt;ï¼šwq!(å¼ºåˆ¶å†™å…¥é€€å‡º)</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">function proxy_on() &#123;</span><br><span class="line">    export no_proxy=&quot;localhost,127.0.0.1,localaddress,.localdomain.com&quot;</span><br><span class="line">    export http_proxy=&quot;http://127.0.0.1:7890&quot;</span><br><span class="line">    export https_proxy=$http_proxy</span><br><span class="line">    #export all_proxy=socks5://127.0.0.1:7890 # or this line</span><br><span class="line">    echo -e &quot;å·²å¼€å¯ä»£ç†&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function proxy_off()&#123;</span><br><span class="line">    unset http_proxy</span><br><span class="line">    unset https_proxy</span><br><span class="line">    echo -e &quot;å·²å…³é—­ä»£ç†&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><img src="/img/mics/20210309212421139.webp" alt="æ•ˆæœå›¾" style="zoom:80%;" /><p><strong>4. ç¬¬å››æ­¥ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">source</span> ~/.bash_profile</span><br></pre></td></tr></table></figure><p><strong>5.ç¬¬äº”æ­¥ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ open -e .zshrc</span><br></pre></td></tr></table></figure><img src="/img/mics/20210309213339480.webp" alt="æ•ˆæœå›¾" style="zoom:80%;" /><p><strong>6.ç¬¬å…­æ­¥</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">source</span> .zshrc</span><br></pre></td></tr></table></figure><p>æ­å–œä½ ï¼åˆ°è¿™æ­¥å°±å¯ä»¥å•¦ï¼</p><p>é‡æ–°æ‰“å¼€ç»ˆç«¯ <code>proxy_on</code>å°±æ‰“å¼€äº† ä¸ç®¡æ˜¯Gitå•¥çš„éƒ½å¿«å¾ˆå¤šã€‚</p>]]></content>
      
      
      <categories>
          
          <category> åˆ†äº« </category>
          
      </categories>
      
      
    </entry>
    
    
  
  
</search>
